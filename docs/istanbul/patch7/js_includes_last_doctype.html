<!DOCTYPE html>

<html>
<head>
  <title>js_includes_last_doctype.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="AJAXCompleter.html">
                  AJAXCompleter.js
                </a>
              
                
                <a class="source" href="AJAXEmailClientCompleter.html">
                  AJAXEmailClientCompleter.js
                </a>
              
                
                <a class="source" href="AJAXOtherCompleter.html">
                  AJAXOtherCompleter.js
                </a>
              
                
                <a class="source" href="AJAXReferenceChoice.html">
                  AJAXReferenceChoice.js
                </a>
              
                
                <a class="source" href="AJAXReferenceCompleter.html">
                  AJAXReferenceCompleter.js
                </a>
              
                
                <a class="source" href="AJAXReferenceCompleterMulti.html">
                  AJAXReferenceCompleterMulti.js
                </a>
              
                
                <a class="source" href="AJAXReferenceControls.html">
                  AJAXReferenceControls.js
                </a>
              
                
                <a class="source" href="AJAXTableCompleter.html">
                  AJAXTableCompleter.js
                </a>
              
                
                <a class="source" href="AttachmentUploader.html">
                  AttachmentUploader.js
                </a>
              
                
                <a class="source" href="AutoComplete.html">
                  AutoComplete.js
                </a>
              
                
                <a class="source" href="BoundsUtil2.html">
                  BoundsUtil2.js
                </a>
              
                
                <a class="source" href="CookieJar.html">
                  CookieJar.js
                </a>
              
                
                <a class="source" href="CustomEventManager.html">
                  CustomEventManager.js
                </a>
              
                
                <a class="source" href="DaysOfWeekElement.html">
                  DaysOfWeekElement.js
                </a>
              
                
                <a class="source" href="DerivedFields.html">
                  DerivedFields.js
                </a>
              
                
                <a class="source" href="Draggable2.html">
                  Draggable2.js
                </a>
              
                
                <a class="source" href="DropTarget2.html">
                  DropTarget2.js
                </a>
              
                
                <a class="source" href="FieldListElement.html">
                  FieldListElement.js
                </a>
              
                
                <a class="source" href="GlideAPI1.html">
                  GlideAPI1.js
                </a>
              
                
                <a class="source" href="GlideAjax.html">
                  GlideAjax.js
                </a>
              
                
                <a class="source" href="GlideAjaxForm.html">
                  GlideAjaxForm.js
                </a>
              
                
                <a class="source" href="GlideBox.html">
                  GlideBox.js
                </a>
              
                
                <a class="source" href="GlideClientCache.html">
                  GlideClientCache.js
                </a>
              
                
                <a class="source" href="GlideDecoration.html">
                  GlideDecoration.js
                </a>
              
                
                <a class="source" href="GlideDialogForm.html">
                  GlideDialogForm.js
                </a>
              
                
                <a class="source" href="GlideDialogWindow.html">
                  GlideDialogWindow.js
                </a>
              
                
                <a class="source" href="GlideDraggable.html">
                  GlideDraggable.js
                </a>
              
                
                <a class="source" href="GlideDuration.html">
                  GlideDuration.js
                </a>
              
                
                <a class="source" href="GlideEvent.html">
                  GlideEvent.js
                </a>
              
                
                <a class="source" href="GlideEventHandler.html">
                  GlideEventHandler.js
                </a>
              
                
                <a class="source" href="GlideFilter14.html">
                  GlideFilter14.js
                </a>
              
                
                <a class="source" href="GlideFilterDate.html">
                  GlideFilterDate.js
                </a>
              
                
                <a class="source" href="GlideFilterDescription.html">
                  GlideFilterDescription.js
                </a>
              
                
                <a class="source" href="GlideFilterHandlers.html">
                  GlideFilterHandlers.js
                </a>
              
                
                <a class="source" href="GlideFilterItemVariables.html">
                  GlideFilterItemVariables.js
                </a>
              
                
                <a class="source" href="GlideFilterLabels.html">
                  GlideFilterLabels.js
                </a>
              
                
                <a class="source" href="GlideFilterQuestions.html">
                  GlideFilterQuestions.js
                </a>
              
                
                <a class="source" href="GlideFilterReference.html">
                  GlideFilterReference.js
                </a>
              
                
                <a class="source" href="GlideFilterReferenceMulti.html">
                  GlideFilterReferenceMulti.js
                </a>
              
                
                <a class="source" href="GlideFilterVariableMap.html">
                  GlideFilterVariableMap.js
                </a>
              
                
                <a class="source" href="GlideFilterVariables.html">
                  GlideFilterVariables.js
                </a>
              
                
                <a class="source" href="GlideForm14.html">
                  GlideForm14.js
                </a>
              
                
                <a class="source" href="GlideHeaderSearch.html">
                  GlideHeaderSearch.js
                </a>
              
                
                <a class="source" href="GlideList2.html">
                  GlideList2.js
                </a>
              
                
                <a class="source" href="GlideList2FilterUtil.html">
                  GlideList2FilterUtil.js
                </a>
              
                
                <a class="source" href="GlideList2Handlers.html">
                  GlideList2Handlers.js
                </a>
              
                
                <a class="source" href="GlideList2InitEvents.html">
                  GlideList2InitEvents.js
                </a>
              
                
                <a class="source" href="GlideList2Statics.html">
                  GlideList2Statics.js
                </a>
              
                
                <a class="source" href="GlideListAggregates.html">
                  GlideListAggregates.js
                </a>
              
                
                <a class="source" href="GlideListEditor.html">
                  GlideListEditor.js
                </a>
              
                
                <a class="source" href="GlideListEditorMessaging.html">
                  GlideListEditorMessaging.js
                </a>
              
                
                <a class="source" href="GlideListElement.html">
                  GlideListElement.js
                </a>
              
                
                <a class="source" href="GlideListWidget.html">
                  GlideListWidget.js
                </a>
              
                
                <a class="source" href="GlideListv3Compatibility.html">
                  GlideListv3Compatibility.js
                </a>
              
                
                <a class="source" href="GlideModal.html">
                  GlideModal.js
                </a>
              
                
                <a class="source" href="GlideModalForm.html">
                  GlideModalForm.js
                </a>
              
                
                <a class="source" href="GlideNavigation.html">
                  GlideNavigation.js
                </a>
              
                
                <a class="source" href="GlideOverlay.html">
                  GlideOverlay.js
                </a>
              
                
                <a class="source" href="GlidePane.html">
                  GlidePane.js
                </a>
              
                
                <a class="source" href="GlidePaneForm.html">
                  GlidePaneForm.js
                </a>
              
                
                <a class="source" href="GlideRecord.html">
                  GlideRecord.js
                </a>
              
                
                <a class="source" href="GlideTabs2.html">
                  GlideTabs2.js
                </a>
              
                
                <a class="source" href="GlideTabs2State.html">
                  GlideTabs2State.js
                </a>
              
                
                <a class="source" href="GlideTabs2Tab.html">
                  GlideTabs2Tab.js
                </a>
              
                
                <a class="source" href="GlideTimeElement.html">
                  GlideTimeElement.js
                </a>
              
                
                <a class="source" href="GlideTimerElement.html">
                  GlideTimerElement.js
                </a>
              
                
                <a class="source" href="GlideTransactionScope.html">
                  GlideTransactionScope.js
                </a>
              
                
                <a class="source" href="GlideUI.html">
                  GlideUI.js
                </a>
              
                
                <a class="source" href="GlideUIDefault.html">
                  GlideUIDefault.js
                </a>
              
                
                <a class="source" href="GlideUIElement.html">
                  GlideUIElement.js
                </a>
              
                
                <a class="source" href="GlideUINotification.html">
                  GlideUINotification.js
                </a>
              
                
                <a class="source" href="GlideURL.html">
                  GlideURL.js
                </a>
              
                
                <a class="source" href="GlideURLElement.html">
                  GlideURLElement.js
                </a>
              
                
                <a class="source" href="GlideUser.html">
                  GlideUser.js
                </a>
              
                
                <a class="source" href="GlideUserImageElement.html">
                  GlideUserImageElement.js
                </a>
              
                
                <a class="source" href="GlideWidgetActions.html">
                  GlideWidgetActions.js
                </a>
              
                
                <a class="source" href="GlideWidgetFilter.html">
                  GlideWidgetFilter.js
                </a>
              
                
                <a class="source" href="GlideWidgetHideOnEmpty.html">
                  GlideWidgetHideOnEmpty.js
                </a>
              
                
                <a class="source" href="GlideWidgetSearch.html">
                  GlideWidgetSearch.js
                </a>
              
                
                <a class="source" href="GlideWidgetVCR.html">
                  GlideWidgetVCR.js
                </a>
              
                
                <a class="source" href="GlideWindow.html">
                  GlideWindow.js
                </a>
              
                
                <a class="source" href="GuidedTourElementTranslator.html">
                  GuidedTourElementTranslator.js
                </a>
              
                
                <a class="source" href="GwtCellEditor.html">
                  GwtCellEditor.js
                </a>
              
                
                <a class="source" href="GwtCellSelector.html">
                  GwtCellSelector.js
                </a>
              
                
                <a class="source" href="GwtContextMenu.html">
                  GwtContextMenu.js
                </a>
              
                
                <a class="source" href="GwtCursor.html">
                  GwtCursor.js
                </a>
              
                
                <a class="source" href="GwtDate.html">
                  GwtDate.js
                </a>
              
                
                <a class="source" href="GwtDraggable.html">
                  GwtDraggable.js
                </a>
              
                
                <a class="source" href="GwtDraggableSnap.html">
                  GwtDraggableSnap.js
                </a>
              
                
                <a class="source" href="GwtExportScheduleDialog.html">
                  GwtExportScheduleDialog.js
                </a>
              
                
                <a class="source" href="GwtGridEdit.html">
                  GwtGridEdit.js
                </a>
              
                
                <a class="source" href="GwtListEditAjaxChangeSaver.html">
                  GwtListEditAjaxChangeSaver.js
                </a>
              
                
                <a class="source" href="GwtListEditAjaxValueLoader.html">
                  GwtListEditAjaxValueLoader.js
                </a>
              
                
                <a class="source" href="GwtListEditBoolean.html">
                  GwtListEditBoolean.js
                </a>
              
                
                <a class="source" href="GwtListEditCalendar.html">
                  GwtListEditCalendar.js
                </a>
              
                
                <a class="source" href="GwtListEditDependent.html">
                  GwtListEditDependent.js
                </a>
              
                
                <a class="source" href="GwtListEditDuration.html">
                  GwtListEditDuration.js
                </a>
              
                
                <a class="source" href="GwtListEditEncryptedText.html">
                  GwtListEditEncryptedText.js
                </a>
              
                
                <a class="source" href="GwtListEditError.html">
                  GwtListEditError.js
                </a>
              
                
                <a class="source" href="GwtListEditGList.html">
                  GwtListEditGList.js
                </a>
              
                
                <a class="source" href="GwtListEditGlideRecord.html">
                  GwtListEditGlideRecord.js
                </a>
              
                
                <a class="source" href="GwtListEditGridSelector.html">
                  GwtListEditGridSelector.js
                </a>
              
                
                <a class="source" href="GwtListEditInternalType.html">
                  GwtListEditInternalType.js
                </a>
              
                
                <a class="source" href="GwtListEditJournal.html">
                  GwtListEditJournal.js
                </a>
              
                
                <a class="source" href="GwtListEditMultiText.html">
                  GwtListEditMultiText.js
                </a>
              
                
                <a class="source" href="GwtListEditPassword.html">
                  GwtListEditPassword.js
                </a>
              
                
                <a class="source" href="GwtListEditRecord.html">
                  GwtListEditRecord.js
                </a>
              
                
                <a class="source" href="GwtListEditRecordDecorations.html">
                  GwtListEditRecordDecorations.js
                </a>
              
                
                <a class="source" href="GwtListEditReference.html">
                  GwtListEditReference.js
                </a>
              
                
                <a class="source" href="GwtListEditRelatedTags.html">
                  GwtListEditRelatedTags.js
                </a>
              
                
                <a class="source" href="GwtListEditSavePolicy.html">
                  GwtListEditSavePolicy.js
                </a>
              
                
                <a class="source" href="GwtListEditSelect.html">
                  GwtListEditSelect.js
                </a>
              
                
                <a class="source" href="GwtListEditTableController.html">
                  GwtListEditTableController.js
                </a>
              
                
                <a class="source" href="GwtListEditTablename.html">
                  GwtListEditTablename.js
                </a>
              
                
                <a class="source" href="GwtListEditText.html">
                  GwtListEditText.js
                </a>
              
                
                <a class="source" href="GwtListEditTranslatedField.html">
                  GwtListEditTranslatedField.js
                </a>
              
                
                <a class="source" href="GwtListEditUpdateTablename.html">
                  GwtListEditUpdateTablename.js
                </a>
              
                
                <a class="source" href="GwtListEditValueRenderer.html">
                  GwtListEditValueRenderer.js
                </a>
              
                
                <a class="source" href="GwtListEditWindow.html">
                  GwtListEditWindow.js
                </a>
              
                
                <a class="source" href="GwtListEditor.html">
                  GwtListEditor.js
                </a>
              
                
                <a class="source" href="GwtListEditorPendingChanges.html">
                  GwtListEditorPendingChanges.js
                </a>
              
                
                <a class="source" href="GwtMessage14.html">
                  GwtMessage14.js
                </a>
              
                
                <a class="source" href="GwtObservable.html">
                  GwtObservable.js
                </a>
              
                
                <a class="source" href="GwtPollDialog.html">
                  GwtPollDialog.js
                </a>
              
                
                <a class="source" href="ISO9075.html">
                  ISO9075.js
                </a>
              
                
                <a class="source" href="InPlaceEdit.html">
                  InPlaceEdit.js
                </a>
              
                
                <a class="source" href="LAB.min.html">
                  LAB.min.js
                </a>
              
                
                <a class="source" href="ListDraggableRow2.html">
                  ListDraggableRow2.js
                </a>
              
                
                <a class="source" href="ListSelectManager2.html">
                  ListSelectManager2.js
                </a>
              
                
                <a class="source" href="ListSortDual2.html">
                  ListSortDual2.js
                </a>
              
                
                <a class="source" href="ListSortWindow2.html">
                  ListSortWindow2.js
                </a>
              
                
                <a class="source" href="NOW.messaging.html">
                  NOW.messaging.js
                </a>
              
                
                <a class="source" href="NOW.messaging.record.html">
                  NOW.messaging.record.js
                </a>
              
                
                <a class="source" href="NameMapEntry.html">
                  NameMapEntry.js
                </a>
              
                
                <a class="source" href="NotificationMessage.html">
                  NotificationMessage.js
                </a>
              
                
                <a class="source" href="PageTiming14.html">
                  PageTiming14.js
                </a>
              
                
                <a class="source" href="PersonalizeForm.html">
                  PersonalizeForm.js
                </a>
              
                
                <a class="source" href="Point.html">
                  Point.js
                </a>
              
                
                <a class="source" href="SLARepairClient.html">
                  SLARepairClient.js
                </a>
              
                
                <a class="source" href="ScriptLoader.html">
                  ScriptLoader.js
                </a>
              
                
                <a class="source" href="Select.html">
                  Select.js
                </a>
              
                
                <a class="source" href="SlushBucket.html">
                  SlushBucket.js
                </a>
              
                
                <a class="source" href="SortDraggable2.html">
                  SortDraggable2.js
                </a>
              
                
                <a class="source" href="SortDropTarget2.html">
                  SortDropTarget2.js
                </a>
              
                
                <a class="source" href="SortListManager2.html">
                  SortListManager2.js
                </a>
              
                
                <a class="source" href="SortUtil2.html">
                  SortUtil2.js
                </a>
              
                
                <a class="source" href="StopWatch.html">
                  StopWatch.js
                </a>
              
                
                <a class="source" href="Table.html">
                  Table.js
                </a>
              
                
                <a class="source" href="TableElement.html">
                  TableElement.js
                </a>
              
                
                <a class="source" href="TableExtension.html">
                  TableExtension.js
                </a>
              
                
                <a class="source" href="TemplateRecord.html">
                  TemplateRecord.js
                </a>
              
                
                <a class="source" href="TextAreaElement.html">
                  TextAreaElement.js
                </a>
              
                
                <a class="source" href="UserRolesElement.html">
                  UserRolesElement.js
                </a>
              
                
                <a class="source" href="UtilityAndOverrides2.html">
                  UtilityAndOverrides2.js
                </a>
              
                
                <a class="source" href="_module.heisenberg.html">
                  _module.heisenberg.js
                </a>
              
                
                <a class="source" href="_module.html">
                  _module.js
                </a>
              
                
                <a class="source" href="ac.html">
                  ac.js
                </a>
              
                
                <a class="source" href="ac_derived_field_support.html">
                  ac_derived_field_support.js
                </a>
              
                
                <a class="source" href="accessibility.html">
                  accessibility.js
                </a>
              
                
                <a class="source" href="accessibility_tabindex.html">
                  accessibility_tabindex.js
                </a>
              
                
                <a class="source" href="affix.html">
                  affix.js
                </a>
              
                
                <a class="source" href="alert.html">
                  alert.js
                </a>
              
                
                <a class="source" href="amb.Channel.html">
                  amb.Channel.js
                </a>
              
                
                <a class="source" href="amb.ChannelListener.html">
                  amb.ChannelListener.js
                </a>
              
                
                <a class="source" href="amb.ChannelRedirect.html">
                  amb.ChannelRedirect.js
                </a>
              
                
                <a class="source" href="amb.EventManager.html">
                  amb.EventManager.js
                </a>
              
                
                <a class="source" href="amb.Logger.html">
                  amb.Logger.js
                </a>
              
                
                <a class="source" href="amb.MessageClient.html">
                  amb.MessageClient.js
                </a>
              
                
                <a class="source" href="amb.MessageClientBuilder.html">
                  amb.MessageClientBuilder.js
                </a>
              
                
                <a class="source" href="amb.ServerConnection.html">
                  amb.ServerConnection.js
                </a>
              
                
                <a class="source" href="amb_properties.html">
                  amb_properties.js
                </a>
              
                
                <a class="source" href="angular-animate.min.html">
                  angular-animate.min.js
                </a>
              
                
                <a class="source" href="angular-aria.min.html">
                  angular-aria.min.js
                </a>
              
                
                <a class="source" href="angular-cookies.min.html">
                  angular-cookies.min.js
                </a>
              
                
                <a class="source" href="angular-resource.min.html">
                  angular-resource.min.js
                </a>
              
                
                <a class="source" href="angular-route.min.html">
                  angular-route.min.js
                </a>
              
                
                <a class="source" href="angular-sanitize.min.html">
                  angular-sanitize.min.js
                </a>
              
                
                <a class="source" href="angular-touch.min.html">
                  angular-touch.min.js
                </a>
              
                
                <a class="source" href="angular.min.html">
                  angular.min.js
                </a>
              
                
                <a class="source" href="angular_includes_1.4.html">
                  angular_includes_1.4.js
                </a>
              
                
                <a class="source" href="annotations_toggle.html">
                  annotations_toggle.js
                </a>
              
                
                <a class="source" href="app.form_presence.html">
                  app.form_presence.js
                </a>
              
                
                <a class="source" href="app.ng.amb.html">
                  app.ng.amb.js
                </a>
              
                
                <a class="source" href="app_guided_tours.html">
                  app_guided_tours.js
                </a>
              
                
                <a class="source" href="button.html">
                  button.js
                </a>
              
                
                <a class="source" href="calendar.html">
                  calendar.js
                </a>
              
                
                <a class="source" href="carousel.html">
                  carousel.js
                </a>
              
                
                <a class="source" href="collapse.html">
                  collapse.js
                </a>
              
                
                <a class="source" href="cometd.html">
                  cometd.js
                </a>
              
                
                <a class="source" href="condition14_new.html">
                  condition14_new.js
                </a>
              
                
                <a class="source" href="condition14_reporting.html">
                  condition14_reporting.js
                </a>
              
                
                <a class="source" href="condition14_templates.html">
                  condition14_templates.js
                </a>
              
                
                <a class="source" href="condition_global_variables14.html">
                  condition_global_variables14.js
                </a>
              
                
                <a class="source" href="constants_embedded_help.html">
                  constants_embedded_help.js
                </a>
              
                
                <a class="source" href="context_actions.html">
                  context_actions.js
                </a>
              
                
                <a class="source" href="controller.AMBRecordWatcher.html">
                  controller.AMBRecordWatcher.js
                </a>
              
                
                <a class="source" href="controller.Stream.html">
                  controller.Stream.js
                </a>
              
                
                <a class="source" href="controller.formStream.html">
                  controller.formStream.js
                </a>
              
                
                <a class="source" href="controller.guidedTours.html">
                  controller.guidedTours.js
                </a>
              
                
                <a class="source" href="deferred_related_lists.html">
                  deferred_related_lists.js
                </a>
              
                
                <a class="source" href="depends.html">
                  depends.js
                </a>
              
                
                <a class="source" href="directive.contenteditable.html">
                  directive.contenteditable.js
                </a>
              
                
                <a class="source" href="directive.formStreamEntry.html">
                  directive.formStreamEntry.js
                </a>
              
                
                <a class="source" href="directive.message.html">
                  directive.message.js
                </a>
              
                
                <a class="source" href="directive.scroll_form.html">
                  directive.scroll_form.js
                </a>
              
                
                <a class="source" href="directive.snAttachmentPreview.html">
                  directive.snAttachmentPreview.js
                </a>
              
                
                <a class="source" href="directive.snAvatar.html">
                  directive.snAvatar.js
                </a>
              
                
                <a class="source" href="directive.snAvatarPopover.html">
                  directive.snAvatarPopover.js
                </a>
              
                
                <a class="source" href="directive.snBindI18n.html">
                  directive.snBindI18n.js
                </a>
              
                
                <a class="source" href="directive.snBindOnce.html">
                  directive.snBindOnce.js
                </a>
              
                
                <a class="source" href="directive.snBindPopoverSelection.html">
                  directive.snBindPopoverSelection.js
                </a>
              
                
                <a class="source" href="directive.snBlurOnEnter.html">
                  directive.snBlurOnEnter.js
                </a>
              
                
                <a class="source" href="directive.snBootstrapPopover.html">
                  directive.snBootstrapPopover.js
                </a>
              
                
                <a class="source" href="directive.snChoiceList.html">
                  directive.snChoiceList.js
                </a>
              
                
                <a class="source" href="directive.snCloak.html">
                  directive.snCloak.js
                </a>
              
                
                <a class="source" href="directive.snComplexPopover.html">
                  directive.snComplexPopover.js
                </a>
              
                
                <a class="source" href="directive.snConfirmModal.html">
                  directive.snConfirmModal.js
                </a>
              
                
                <a class="source" href="directive.snContextMenu.html">
                  directive.snContextMenu.js
                </a>
              
                
                <a class="source" href="directive.snDayAgo.html">
                  directive.snDayAgo.js
                </a>
              
                
                <a class="source" href="directive.snDialog.html">
                  directive.snDialog.js
                </a>
              
                
                <a class="source" href="directive.snExpandedEmail.html">
                  directive.snExpandedEmail.js
                </a>
              
                
                <a class="source" href="directive.snFieldReference.html">
                  directive.snFieldReference.js
                </a>
              
                
                <a class="source" href="directive.snFlyout.html">
                  directive.snFlyout.js
                </a>
              
                
                <a class="source" href="directive.snFocus.html">
                  directive.snFocus.js
                </a>
              
                
                <a class="source" href="directive.snGlyph.html">
                  directive.snGlyph.js
                </a>
              
                
                <a class="source" href="directive.snImageUploader.html">
                  directive.snImageUploader.js
                </a>
              
                
                <a class="source" href="directive.snLinkContent.html">
                  directive.snLinkContent.js
                </a>
              
                
                <a class="source" href="directive.snLinkContentArticle.html">
                  directive.snLinkContentArticle.js
                </a>
              
                
                <a class="source" href="directive.snLinkContentAttachment.html">
                  directive.snLinkContentAttachment.js
                </a>
              
                
                <a class="source" href="directive.snLinkContentError.html">
                  directive.snLinkContentError.js
                </a>
              
                
                <a class="source" href="directive.snLinkContentImage.html">
                  directive.snLinkContentImage.js
                </a>
              
                
                <a class="source" href="directive.snLinkContentRecord.html">
                  directive.snLinkContentRecord.js
                </a>
              
                
                <a class="source" href="directive.snLinkContentSoundcloud.html">
                  directive.snLinkContentSoundcloud.js
                </a>
              
                
                <a class="source" href="directive.snLinkContentYoutube.html">
                  directive.snLinkContentYoutube.js
                </a>
              
                
                <a class="source" href="directive.snMentionPopover.html">
                  directive.snMentionPopover.js
                </a>
              
                
                <a class="source" href="directive.snModal.html">
                  directive.snModal.js
                </a>
              
                
                <a class="source" href="directive.snModalShow.html">
                  directive.snModalShow.js
                </a>
              
                
                <a class="source" href="directive.snNotification.html">
                  directive.snNotification.js
                </a>
              
                
                <a class="source" href="directive.snPopoverBasic.html">
                  directive.snPopoverBasic.js
                </a>
              
                
                <a class="source" href="directive.snPresence.html">
                  directive.snPresence.js
                </a>
              
                
                <a class="source" href="directive.snRecordPicker.html">
                  directive.snRecordPicker.js
                </a>
              
                
                <a class="source" href="directive.snReferencePicker.html">
                  directive.snReferencePicker.js
                </a>
              
                
                <a class="source" href="directive.snResizeHeight.html">
                  directive.snResizeHeight.js
                </a>
              
                
                <a class="source" href="directive.snSelectBasic.html">
                  directive.snSelectBasic.js
                </a>
              
                
                <a class="source" href="directive.snStickyHeaders.html">
                  directive.snStickyHeaders.js
                </a>
              
                
                <a class="source" href="directive.snStream.html">
                  directive.snStream.js
                </a>
              
                
                <a class="source" href="directive.snSyncWith.html">
                  directive.snSyncWith.js
                </a>
              
                
                <a class="source" href="directive.snTableReference.html">
                  directive.snTableReference.js
                </a>
              
                
                <a class="source" href="directive.snTabs.html">
                  directive.snTabs.js
                </a>
              
                
                <a class="source" href="directive.snTabsBasic.html">
                  directive.snTabsBasic.js
                </a>
              
                
                <a class="source" href="directive.snTextExpander.html">
                  directive.snTextExpander.js
                </a>
              
                
                <a class="source" href="directive.snTimeAgo.html">
                  directive.snTimeAgo.js
                </a>
              
                
                <a class="source" href="directive.snTooltipBasic.html">
                  directive.snTooltipBasic.js
                </a>
              
                
                <a class="source" href="directive.snUserAvatar.html">
                  directive.snUserAvatar.js
                </a>
              
                
                <a class="source" href="directive.snUserProfile.html">
                  directive.snUserProfile.js
                </a>
              
                
                <a class="source" href="dropdown.html">
                  dropdown.js
                </a>
              
                
                <a class="source" href="dropdowns.html">
                  dropdowns.js
                </a>
              
                
                <a class="source" href="email_activity.html">
                  email_activity.js
                </a>
              
                
                <a class="source" href="event_initialize.html">
                  event_initialize.js
                </a>
              
                
                <a class="source" href="factory.AMBOverlay.html">
                  factory.AMBOverlay.js
                </a>
              
                
                <a class="source" href="factory.ArraySynchronizer.html">
                  factory.ArraySynchronizer.js
                </a>
              
                
                <a class="source" href="factory.glideUrlBuilder.html">
                  factory.glideUrlBuilder.js
                </a>
              
                
                <a class="source" href="factory.notificationWrapper.html">
                  factory.notificationWrapper.js
                </a>
              
                
                <a class="source" href="factory.paneManager.html">
                  factory.paneManager.js
                </a>
              
                
                <a class="source" href="factory.snPresence.html">
                  factory.snPresence.js
                </a>
              
                
                <a class="source" href="factory.snRecordPresence.html">
                  factory.snRecordPresence.js
                </a>
              
                
                <a class="source" href="factory.snRecordWatcher.html">
                  factory.snRecordWatcher.js
                </a>
              
                
                <a class="source" href="factory.unwrappedHTTPPromise.html">
                  factory.unwrappedHTTPPromise.js
                </a>
              
                
                <a class="source" href="fixedHeaders.html">
                  fixedHeaders.js
                </a>
              
                
                <a class="source" href="floating_scrollbar.min.html">
                  floating_scrollbar.min.js
                </a>
              
                
                <a class="source" href="focus-trap.html">
                  focus-trap.js
                </a>
              
                
                <a class="source" href="form_submitted_mask.html">
                  form_submitted_mask.js
                </a>
              
                
                <a class="source" href="form_tags.html">
                  form_tags.js
                </a>
              
                
                <a class="source" href="formatting.html">
                  formatting.js
                </a>
              
                
                <a class="source" href="functions.html">
                  functions.js
                </a>
              
                
                <a class="source" href="functions_attachments.html">
                  functions_attachments.js
                </a>
              
                
                <a class="source" href="functions_bootstrap14.html">
                  functions_bootstrap14.js
                </a>
              
                
                <a class="source" href="functions_calendar.html">
                  functions_calendar.js
                </a>
              
                
                <a class="source" href="functions_clipboard.html">
                  functions_clipboard.js
                </a>
              
                
                <a class="source" href="functions_email.html">
                  functions_email.js
                </a>
              
                
                <a class="source" href="functions_fontsizer.html">
                  functions_fontsizer.js
                </a>
              
                
                <a class="source" href="functions_onchange.html">
                  functions_onchange.js
                </a>
              
                
                <a class="source" href="functions_reference.html">
                  functions_reference.js
                </a>
              
                
                <a class="source" href="functions_showloading.html">
                  functions_showloading.js
                </a>
              
                
                <a class="source" href="functions_user_image.html">
                  functions_user_image.js
                </a>
              
                
                <a class="source" href="guided_tours_template.html">
                  guided_tours_template.js
                </a>
              
                
                <a class="source" href="heisenberg_all.html">
                  heisenberg_all.js
                </a>
              
                
                <a class="source" href="html_class_setter.html">
                  html_class_setter.js
                </a>
              
                
                <a class="source" href="jquery-2.2.3.min.html">
                  jquery-2.2.3.min.js
                </a>
              
                
                <a class="source" href="jquery-ui-1.9.2.custom.html">
                  jquery-ui-1.9.2.custom.js
                </a>
              
                
                <a class="source" href="jquery.cometd.html">
                  jquery.cometd.js
                </a>
              
                
                <a class="source" href="jquery2_includes.html">
                  jquery2_includes.js
                </a>
              
                
                <a class="source" href="jquery_clean.html">
                  jquery_clean.js
                </a>
              
                
                <a class="source" href="jquery_no_conflict.html">
                  jquery_no_conflict.js
                </a>
              
                
                <a class="source" href="js_guided_tours_includes.html">
                  js_guided_tours_includes.js
                </a>
              
                
                <a class="source" href="js_includes_amb.html">
                  js_includes_amb.js
                </a>
              
                
                <a class="source" href="js_includes_angular.html">
                  js_includes_angular.js
                </a>
              
                
                <a class="source" href="js_includes_controls.html">
                  js_includes_controls.js
                </a>
              
                
                <a class="source" href="js_includes_customer.html">
                  js_includes_customer.js
                </a>
              
                
                <a class="source" href="js_includes_datetime.html">
                  js_includes_datetime.js
                </a>
              
                
                <a class="source" href="js_includes_doctype.html">
                  js_includes_doctype.js
                </a>
              
                
                <a class="source" href="js_includes_form_presence.html">
                  js_includes_form_presence.js
                </a>
              
                
                <a class="source" href="js_includes_glide.html">
                  js_includes_glide.js
                </a>
              
                
                <a class="source" href="js_includes_i18n.html">
                  js_includes_i18n.js
                </a>
              
                
                <a class="source" href="js_includes_last_doctype.html">
                  js_includes_last_doctype.js
                </a>
              
                
                <a class="source" href="js_includes_link.html">
                  js_includes_link.js
                </a>
              
                
                <a class="source" href="js_includes_list_edit_doctype.html">
                  js_includes_list_edit_doctype.js
                </a>
              
                
                <a class="source" href="js_includes_listv2_doctype.html">
                  js_includes_listv2_doctype.js
                </a>
              
                
                <a class="source" href="js_includes_mention.html">
                  js_includes_mention.js
                </a>
              
                
                <a class="source" href="js_includes_notification.html">
                  js_includes_notification.js
                </a>
              
                
                <a class="source" href="js_includes_sorting_new.html">
                  js_includes_sorting_new.js
                </a>
              
                
                <a class="source" href="js_includes_stream.html">
                  js_includes_stream.js
                </a>
              
                
                <a class="source" href="js_includes_ui.html">
                  js_includes_ui.js
                </a>
              
                
                <a class="source" href="js_includes_ui16_form.html">
                  js_includes_ui16_form.js
                </a>
              
                
                <a class="source" href="js_includes_ui_popover.html">
                  js_includes_ui_popover.js
                </a>
              
                
                <a class="source" href="js_includes_user_profile.html">
                  js_includes_user_profile.js
                </a>
              
                
                <a class="source" href="js_includes_util.html">
                  js_includes_util.js
                </a>
              
                
                <a class="source" href="list_filter.html">
                  list_filter.js
                </a>
              
                
                <a class="source" href="magellan.CreateFavoriteModal.html">
                  magellan.CreateFavoriteModal.js
                </a>
              
                
                <a class="source" href="mentio.html">
                  mentio.js
                </a>
              
                
                <a class="source" href="modal.html">
                  modal.js
                </a>
              
                
                <a class="source" href="modals.html">
                  modals.js
                </a>
              
                
                <a class="source" href="newtag-it.html">
                  newtag-it.js
                </a>
              
                
                <a class="source" href="page_title.html">
                  page_title.js
                </a>
              
                
                <a class="source" href="popover.html">
                  popover.js
                </a>
              
                
                <a class="source" href="popovers.html">
                  popovers.js
                </a>
              
                
                <a class="source" href="popupdivs14.html">
                  popupdivs14.js
                </a>
              
                
                <a class="source" href="popups.html">
                  popups.js
                </a>
              
                
                <a class="source" href="prototype.effects.html">
                  prototype.effects.js
                </a>
              
                
                <a class="source" href="prototype.hidefix.html">
                  prototype.hidefix.js
                </a>
              
                
                <a class="source" href="prototype.html">
                  prototype.js
                </a>
              
                
                <a class="source" href="prototype.min.html">
                  prototype.min.js
                </a>
              
                
                <a class="source" href="prototype.plugin.html">
                  prototype.plugin.js
                </a>
              
                
                <a class="source" href="prototype.template.html">
                  prototype.template.js
                </a>
              
                
                <a class="source" href="provider.linkContentTypes.html">
                  provider.linkContentTypes.js
                </a>
              
                
                <a class="source" href="scoped_object_generators.html">
                  scoped_object_generators.js
                </a>
              
                
                <a class="source" href="scrollable.html">
                  scrollable.js
                </a>
              
                
                <a class="source" href="scrollspy.html">
                  scrollspy.js
                </a>
              
                
                <a class="source" href="section.html">
                  section.js
                </a>
              
                
                <a class="source" href="select2.min.html">
                  select2.min.js
                </a>
              
                
                <a class="source" href="selects.html">
                  selects.js
                </a>
              
                
                <a class="source" href="service.AMB.html">
                  service.AMB.js
                </a>
              
                
                <a class="source" href="service.authInterceptor.html">
                  service.authInterceptor.js
                </a>
              
                
                <a class="source" href="service.avatarProfilePersister.html">
                  service.avatarProfilePersister.js
                </a>
              
                
                <a class="source" href="service.dateUtils.html">
                  service.dateUtils.js
                </a>
              
                
                <a class="source" href="service.debounceFn.html">
                  service.debounceFn.js
                </a>
              
                
                <a class="source" href="service.filterExpressionParser.html">
                  service.filterExpressionParser.js
                </a>
              
                
                <a class="source" href="service.getTemplateUrl.html">
                  service.getTemplateUrl.js
                </a>
              
                
                <a class="source" href="service.guidedToursService.html">
                  service.guidedToursService.js
                </a>
              
                
                <a class="source" href="service.i18n.html">
                  service.i18n.js
                </a>
              
                
                <a class="source" href="service.md5.html">
                  service.md5.js
                </a>
              
                
                <a class="source" href="service.nowServer.html">
                  service.nowServer.js
                </a>
              
                
                <a class="source" href="service.nowStream.html">
                  service.nowStream.js
                </a>
              
                
                <a class="source" href="service.priorityQueue.html">
                  service.priorityQueue.js
                </a>
              
                
                <a class="source" href="service.progressDialog.html">
                  service.progressDialog.js
                </a>
              
                
                <a class="source" href="service.queryFilter.html">
                  service.queryFilter.js
                </a>
              
                
                <a class="source" href="service.snComplexPopoverService.html">
                  service.snComplexPopoverService.js
                </a>
              
                
                <a class="source" href="service.snConnect.html">
                  service.snConnect.js
                </a>
              
                
                <a class="source" href="service.snCustomEvent.html">
                  service.snCustomEvent.js
                </a>
              
                
                <a class="source" href="service.snMention.html">
                  service.snMention.js
                </a>
              
                
                <a class="source" href="service.snNotification.html">
                  service.snNotification.js
                </a>
              
                
                <a class="source" href="service.snNotifier.html">
                  service.snNotifier.js
                </a>
              
                
                <a class="source" href="service.snResource.html">
                  service.snResource.js
                </a>
              
                
                <a class="source" href="service.snTabActivity.html">
                  service.snTabActivity.js
                </a>
              
                
                <a class="source" href="service.urlTools.html">
                  service.urlTools.js
                </a>
              
                
                <a class="source" href="service.userData.html">
                  service.userData.js
                </a>
              
                
                <a class="source" href="service.userPreferences.html">
                  service.userPreferences.js
                </a>
              
                
                <a class="source" href="simpleStorage.html">
                  simpleStorage.js
                </a>
              
                
                <a class="source" href="snPolyfill.html">
                  snPolyfill.js
                </a>
              
                
                <a class="source" href="snPopover.html">
                  snPopover.js
                </a>
              
                
                <a class="source" href="snTimeAgoSettings.html">
                  snTimeAgoSettings.js
                </a>
              
                
                <a class="source" href="streamButton.html">
                  streamButton.js
                </a>
              
                
                <a class="source" href="tabbable.html">
                  tabbable.js
                </a>
              
                
                <a class="source" href="tables.html">
                  tables.js
                </a>
              
                
                <a class="source" href="tabs.html">
                  tabs.js
                </a>
              
                
                <a class="source" href="tabs2_14.html">
                  tabs2_14.js
                </a>
              
                
                <a class="source" href="templates.html">
                  templates.js
                </a>
              
                
                <a class="source" href="textutil.html">
                  textutil.js
                </a>
              
                
                <a class="source" href="timeAgo.html">
                  timeAgo.js
                </a>
              
                
                <a class="source" href="tooltip.html">
                  tooltip.js
                </a>
              
                
                <a class="source" href="tooltips.html">
                  tooltips.js
                </a>
              
                
                <a class="source" href="transaction_scope_includes.html">
                  transaction_scope_includes.js
                </a>
              
                
                <a class="source" href="transition.html">
                  transition.js
                </a>
              
                
                <a class="source" href="ui_policy.html">
                  ui_policy.js
                </a>
              
                
                <a class="source" href="utils14.html">
                  utils14.js
                </a>
              
                
                <a class="source" href="velocity.min.html">
                  velocity.min.js
                </a>
              
                
                <a class="source" href="velocity.ui.html">
                  velocity.ui.js
                </a>
              
                
                <a class="source" href="xmlhttp.html">
                  xmlhttp.js
                </a>
              
                
                <a class="source" href="z_last_include.html">
                  z_last_include.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>js_includes_last_doctype.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/*! RESOURCE: /scripts/doctype/js_includes_last_doctype.js */</span>
<span class="hljs-comment">/*! RESOURCE: /scripts/functions_showloading.js */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showLoadingDialog</span>(<span class="hljs-params">callbackFn</span>) </span>{
    <span class="hljs-keyword">var</span> dialogClass = <span class="hljs-built_in">window</span>.GlideModal ? GlideModal : GlideDialogWindow;
    <span class="hljs-built_in">window</span>.loadingDialog = <span class="hljs-keyword">new</span> dialogClass(<span class="hljs-string">"dialog_loading"</span>, <span class="hljs-literal">true</span>, <span class="hljs-number">300</span>);
    <span class="hljs-built_in">window</span>.loadingDialog.setPreference(<span class="hljs-string">'table'</span>, <span class="hljs-string">'loading'</span>);
    <span class="hljs-built_in">window</span>.loadingDialog._isLoadingDialogRendered = <span class="hljs-literal">false</span>;
    <span class="hljs-built_in">window</span>.loadingDialog.on(<span class="hljs-string">'bodyrendered'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-built_in">window</span>.loadingDialog._isLoadingDialogRendered = <span class="hljs-literal">true</span>;
    });
    <span class="hljs-keyword">if</span> (callbackFn)
        <span class="hljs-built_in">window</span>.loadingDialog.on(<span class="hljs-string">'bodyrendered'</span>, callbackFn);
    <span class="hljs-built_in">window</span>.loadingDialog.render();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hideLoadingDialog</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">window</span>.loadingDialog) {
        jslog(<span class="hljs-string">'hideLoadingDialog called with no loading dialog on the page'</span>)
        <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">window</span>.loadingDialog._isLoadingDialogRendered) {
        <span class="hljs-built_in">window</span>.loadingDialog.on(<span class="hljs-string">'bodyrendered'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-built_in">window</span>.loadingDialog.destroy();
        });
        <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-built_in">window</span>.loadingDialog.destroy();
};
<span class="hljs-comment">/*! RESOURCE: /scripts/doctype/event_initialize.js */</span>
$(<span class="hljs-built_in">document</span>.body);
addAfterPageLoadedEvent(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">document</span>.on(<span class="hljs-string">'keypress'</span>, <span class="hljs-string">'input[data-type="ac_reference_input"]'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
        acPopulate(element);
        acReferenceKeyPress(element, evt);
    });
    <span class="hljs-built_in">document</span>.on(<span class="hljs-string">'keydown'</span>, <span class="hljs-string">'input[data-type="ac_reference_input"]'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
        acPopulate(element);
        acReferenceKeyDown(element, evt);
    });
    <span class="hljs-built_in">document</span>.on(<span class="hljs-string">'keyup'</span>, <span class="hljs-string">'input[data-type="ac_reference_input"]'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
        acPopulate(element);
        acReferenceKeyUp(element, evt);
    });
    <span class="hljs-built_in">document</span>.on(<span class="hljs-string">'paste'</span>, <span class="hljs-string">'input[data-type="ac_reference_input"]'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
        setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            acPopulate(element);
            acReferenceKeyPress(element, evt);
        }, <span class="hljs-number">0</span>);
    });

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">acPopulate</span>(<span class="hljs-params">element</span>) </span>{
        <span class="hljs-keyword">if</span> (!element) {
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">var</span> answer = element.ac;
        <span class="hljs-keyword">if</span> (answer)
            <span class="hljs-keyword">return</span> answer;
        <span class="hljs-keyword">var</span> c = element.getAttribute(<span class="hljs-string">'data-completer'</span>);
        <span class="hljs-keyword">var</span> ref = element.getAttribute(<span class="hljs-string">'data-ref'</span>);
        <span class="hljs-keyword">var</span> d = element.getAttribute(<span class="hljs-string">'data-dependent'</span>);
        <span class="hljs-keyword">var</span> rq = element.getAttribute(<span class="hljs-string">'data-ref-qual'</span>);
        <span class="hljs-keyword">new</span> <span class="hljs-built_in">window</span>[c](element, ref, d, rq);
    }
    <span class="hljs-built_in">document</span>.body.on(<span class="hljs-string">'click'</span>, <span class="hljs-string">'a[data-type="ac_reference_input"]'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
        <span class="hljs-keyword">var</span> name = element.getAttribute(<span class="hljs-string">'data-for'</span>);
        <span class="hljs-keyword">var</span> target = $(name);
        <span class="hljs-keyword">if</span> (!target) {
            <span class="hljs-keyword">return</span>;
        }
        acPopulate(target);
        mousePositionSave(evt);
        <span class="hljs-keyword">var</span> ref = target.getAttribute(<span class="hljs-string">'data-ref'</span>);
        <span class="hljs-keyword">var</span> d = target.getAttribute(<span class="hljs-string">'data-dependent'</span>);
        <span class="hljs-keyword">var</span> rq = target.getAttribute(<span class="hljs-string">'data-ref-qual'</span>);
        <span class="hljs-keyword">var</span> n = target.getAttribute(<span class="hljs-string">'data-name'</span>);
        <span class="hljs-keyword">var</span> table = target.getAttribute(<span class="hljs-string">'data-table'</span>);
        reflistOpen(ref, n, table, d, <span class="hljs-string">'false'</span>, rq);
    });
    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">'focus'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.popupClose)
            popupClose();
    });
    <span class="hljs-built_in">document</span>.body.on(<span class="hljs-string">'click'</span>, <span class="hljs-string">'a[data-type="reference_popup"]'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
        <span class="hljs-keyword">var</span> table = element.getAttribute(<span class="hljs-string">'data-table'</span>);
        <span class="hljs-keyword">var</span> form = element.getAttribute(<span class="hljs-string">'data-form'</span>);
        <span class="hljs-keyword">var</span> ref = element.getAttribute(<span class="hljs-string">'data-ref'</span>);
        <span class="hljs-keyword">var</span> refKey = element.getAttribute(<span class="hljs-string">'data-ref-key'</span>);
        checkSave(table, form, ref, refKey);
    });
    <span class="hljs-built_in">document</span>.on(<span class="hljs-string">'mouseover'</span>, <span class="hljs-string">'a[data-type="reference_popup"], a[data-type="reference_hover"]'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
        <span class="hljs-keyword">var</span> ref = element.getAttribute(<span class="hljs-string">'data-ref'</span>);
        <span class="hljs-keyword">var</span> view = element.getAttribute(<span class="hljs-string">'data-view'</span>);
        <span class="hljs-keyword">var</span> refKey = element.getAttribute(<span class="hljs-string">'data-ref-key'</span>);
        popReferenceDiv(evt, ref, view, <span class="hljs-literal">null</span>, refKey);
    });
    <span class="hljs-built_in">document</span>.on(<span class="hljs-string">'mouseout'</span>, <span class="hljs-string">'a[data-type="reference_popup"], a[data-type="reference_hover"]'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
        lockPopup(evt);
    });
    <span class="hljs-built_in">document</span>.body.on(<span class="hljs-string">'click'</span>, <span class="hljs-string">'a[data-type="reference_hover"]'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
        alert(getMessage(<span class="hljs-string">"Reference field click-through not available when updating multiple records"</span>));
    });
    <span class="hljs-built_in">document</span>.body.on(<span class="hljs-string">'click'</span>, <span class="hljs-string">'img[data-type="section_toggle"], span[data-type="section_toggle"]'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
        <span class="hljs-keyword">var</span> id = element.getAttribute(<span class="hljs-string">"data-id"</span>);
        <span class="hljs-keyword">var</span> prefix = element.getAttribute(<span class="hljs-string">"data-image-prefix"</span>);
        <span class="hljs-keyword">var</span> first = element.getAttribute(<span class="hljs-string">"data-first"</span>);
        toggleSectionDisplay(id, prefix, first);
    });
    <span class="hljs-built_in">document</span>.body.on(<span class="hljs-string">'click'</span>, <span class="hljs-string">'[data-type="glide_list_unlock"]'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
        <span class="hljs-keyword">var</span> ref = element.getAttribute(<span class="hljs-string">"data-ref"</span>);
        unlock(element, ref, ref + <span class="hljs-string">"_edit"</span>, ref + <span class="hljs-string">"_nonedit"</span>);
        toggleGlideListIcons(ref, <span class="hljs-literal">false</span>);
        <span class="hljs-keyword">var</span> spaceElement = $(<span class="hljs-string">'make_spacing_ok_'</span> + ref);
        <span class="hljs-keyword">if</span> (spaceElement)
            spaceElement.style.display = <span class="hljs-string">'none'</span>;
        toggleAddMe(ref);
        evt.stop();
    });
    <span class="hljs-built_in">document</span>.body.on(<span class="hljs-string">'click'</span>, <span class="hljs-string">'[data-type="user_roles_unlock"]'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
        <span class="hljs-keyword">var</span> ref = element.getAttribute(<span class="hljs-string">"data-ref"</span>);
        <span class="hljs-keyword">var</span> title = element.getAttribute(<span class="hljs-string">"data-title"</span>);
        <span class="hljs-keyword">var</span> modal = <span class="hljs-keyword">new</span> GlideModal(ref + <span class="hljs-string">"_edit_modal"</span>, <span class="hljs-literal">false</span>);
        modal.setTitle(title);
        modal.on(<span class="hljs-string">'bodyrendered'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            gel(ref + <span class="hljs-string">'select_0'</span>).focus();
        });
        <span class="hljs-keyword">var</span> $content = $j(gel(ref + <span class="hljs-string">"_edit"</span>)).show();
        modal.renderWithContent($content);
        modal.on(<span class="hljs-string">'beforeclose'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            lock(element, ref, ref + <span class="hljs-string">'_edit'</span>, ref + <span class="hljs-string">'_nonedit'</span>, ref + <span class="hljs-string">'select_1'</span>, ref + <span class="hljs-string">'_nonedit'</span>);
            $j(element).append($content);
        });
        evt.stop();
    });
    <span class="hljs-built_in">document</span>.body.on(<span class="hljs-string">'click'</span>, <span class="hljs-string">'[data-type="user_roles_lock"]'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
        <span class="hljs-keyword">var</span> ref = element.getAttribute(<span class="hljs-string">"data-ref"</span>);
        $j(gel(ref + <span class="hljs-string">"_edit_modal"</span>)).data(<span class="hljs-string">'gWindow'</span>).destroy();
        evt.stop();
    });
    <span class="hljs-built_in">document</span>.body.on(<span class="hljs-string">'click'</span>, <span class="hljs-string">'[data-type="glide_list_remove"]'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
        <span class="hljs-keyword">var</span> ref = element.getAttribute(<span class="hljs-string">"data-ref"</span>);
        simpleRemoveOption($(<span class="hljs-string">'select_0'</span> + ref));
        toggleGlideListIcons(ref);
        evt.stop();
    });
    <span class="hljs-built_in">document</span>.body.on(<span class="hljs-string">'click'</span>, <span class="hljs-string">'[data-type="glide_list_lock"]'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
        <span class="hljs-keyword">var</span> ref = element.getAttribute(<span class="hljs-string">"data-ref"</span>);
        lock(element, ref, ref + <span class="hljs-string">"_edit"</span>, ref + <span class="hljs-string">"_nonedit"</span>, <span class="hljs-string">"select_0"</span> + ref, ref + <span class="hljs-string">"_nonedit"</span>);
        <span class="hljs-keyword">var</span> spaceElement = $(<span class="hljs-string">'make_spacing_ok_'</span> + ref);
        <span class="hljs-keyword">if</span> (spaceElement)
            spaceElement.style.display = <span class="hljs-string">'inline'</span>;
        toggleAddMe(ref);
        evt.stop();
    });
    <span class="hljs-built_in">document</span>.body.on(<span class="hljs-string">'click'</span>, <span class="hljs-string">'[data-type="glide_list_add_me"]'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
        <span class="hljs-keyword">var</span> ref = element.getAttribute(<span class="hljs-string">"data-ref"</span>);
        <span class="hljs-keyword">var</span> u = element.getAttribute(<span class="hljs-string">"data-user-id"</span>);
        <span class="hljs-keyword">var</span> name = element.getAttribute(<span class="hljs-string">"data-user"</span>).replace(<span class="hljs-regexp">/\\'/</span>, <span class="hljs-string">"'"</span>);;
        addGlideListChoice(<span class="hljs-string">'select_0'</span> + ref, u, name);
        evt.stop();
    });
    <span class="hljs-built_in">document</span>.body.on(<span class="hljs-string">'click'</span>, <span class="hljs-string">'[data-type="glide_list_add_me_locked"]'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
        <span class="hljs-keyword">var</span> ref = element.getAttribute(<span class="hljs-string">"data-ref"</span>);
        <span class="hljs-keyword">var</span> u = element.getAttribute(<span class="hljs-string">"data-user-id"</span>);
        <span class="hljs-keyword">var</span> name = element.getAttribute(<span class="hljs-string">"data-user"</span>).replace(<span class="hljs-regexp">/\\'/</span>, <span class="hljs-string">"'"</span>);;
        addGlideListChoice(<span class="hljs-string">'select_0'</span> + ref, u, name);
        lock($(ref + <span class="hljs-string">"_lock"</span>), ref, ref + <span class="hljs-string">"_edit"</span>, ref + <span class="hljs-string">"_nonedit"</span>, <span class="hljs-string">"select_0"</span> + ref, ref + <span class="hljs-string">"_nonedit"</span>);
        element.hide();
        evt.stop();
    });
    <span class="hljs-built_in">document</span>.on(<span class="hljs-string">'contextmenu'</span>, <span class="hljs-string">'div[data-type="label"]'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
        <span class="hljs-keyword">if</span> (!elementAction(element, evt))
            evt.stop();
    });
    <span class="hljs-built_in">document</span>.on(<span class="hljs-string">'contextmenu'</span>, <span class="hljs-string">'nav[data-type="section_head"]'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
        <span class="hljs-keyword">var</span> id = element.getAttribute(<span class="hljs-string">"data-id"</span>);
        <span class="hljs-keyword">if</span> (!contextShow(evt, <span class="hljs-string">"1"</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>))
            evt.stop();
    });
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/ui/GlideBox.js */</span>
<span class="hljs-keyword">var</span> g_glideBoxes = {};
<span class="hljs-keyword">var</span> GlideBox = Class.create({
    <span class="hljs-attr">QUIRKS_MODE</span>: <span class="hljs-built_in">document</span>.compatMode != <span class="hljs-string">'CSS1Compat'</span>,
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
        <span class="hljs-keyword">if</span> (isMSIE9)
            <span class="hljs-keyword">this</span>.QUIRKS_MODE = <span class="hljs-keyword">this</span>._isQuirksMode();
        <span class="hljs-keyword">this</span>.options = <span class="hljs-built_in">Object</span>.extend({
            <span class="hljs-attr">id</span>: <span class="hljs-keyword">typeof</span> options == <span class="hljs-string">'string'</span> ? options : guid(),
            <span class="hljs-attr">title</span>: <span class="hljs-string">'Default Title'</span>,
            <span class="hljs-attr">boxClass</span>: <span class="hljs-string">''</span>,
            <span class="hljs-attr">body</span>: <span class="hljs-string">''</span>,
            <span class="hljs-attr">form</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">iframe</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">iframeId</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">bodyPadding</span>: <span class="hljs-number">4</span>,
            <span class="hljs-attr">fadeOutTime</span>: <span class="hljs-number">200</span>,
            <span class="hljs-attr">draggable</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">showClose</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">parent</span>: <span class="hljs-built_in">document</span>.body,
            <span class="hljs-attr">boundingContainer</span>: options.parent || <span class="hljs-built_in">document</span>.body,
            <span class="hljs-attr">position</span>: Prototype.Browser.IE || options.parent ? <span class="hljs-string">'absolute'</span> : <span class="hljs-string">'fixed'</span>,
            <span class="hljs-attr">allowOverflowY</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">allowOverflowX</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">height</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">maxHeight</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">minHeight</span>: <span class="hljs-number">50</span>,
            <span class="hljs-attr">width</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">minWidth</span>: <span class="hljs-number">70</span>,
            <span class="hljs-attr">maxWidth</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">top</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">bottom</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">maxTop</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">minBottom</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">left</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">right</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">preferences</span>: {},
            <span class="hljs-attr">onBeforeLoad</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
            <span class="hljs-attr">onAfterLoad</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
            <span class="hljs-attr">onBeforeHide</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
            <span class="hljs-attr">onAfterHide</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
            <span class="hljs-attr">onBeforeShow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
            <span class="hljs-attr">onAfterShow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
            <span class="hljs-attr">onBeforeClose</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
            <span class="hljs-attr">onAfterClose</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
            <span class="hljs-attr">onBeforeDrag</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
            <span class="hljs-attr">onAfterDrag</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
            <span class="hljs-attr">onBeforeResize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
            <span class="hljs-attr">onAfterResize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
            <span class="hljs-attr">onHeightAdjust</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
            <span class="hljs-attr">onWidthAdjust</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
            <span class="hljs-attr">autoDimensionOnPreLoad</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">autoDimensionOnLoad</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">autoPositionOnLoad</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">fadeInTime</span>: <span class="hljs-number">250</span>
        }, options || {});
        <span class="hljs-keyword">this</span>.options.padding = <span class="hljs-built_in">Object</span>.extend({
            <span class="hljs-attr">top</span>: <span class="hljs-number">15</span>,
            <span class="hljs-attr">right</span>: <span class="hljs-number">15</span>,
            <span class="hljs-attr">bottom</span>: <span class="hljs-number">15</span>,
            <span class="hljs-attr">left</span>: <span class="hljs-number">15</span>
        }, <span class="hljs-keyword">this</span>.options.padding || {});
        <span class="hljs-keyword">this</span>._iframeShim = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>._dataCache = {};
        <span class="hljs-keyword">this</span>._box = $(<span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'div'</span>));
        <span class="hljs-keyword">this</span>._box.id = <span class="hljs-keyword">this</span>.options.id;
        <span class="hljs-keyword">this</span>._box.className = (<span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-string">'glide_box'</span>, <span class="hljs-string">'gb_mw'</span>, trim(<span class="hljs-keyword">this</span>.options.boxClass), <span class="hljs-keyword">this</span>.options.iframe &amp;&amp; <span class="hljs-keyword">this</span>.options.iframe != <span class="hljs-string">''</span> ? <span class="hljs-string">'iframe'</span> : <span class="hljs-string">''</span>).join(<span class="hljs-string">' '</span>));
        <span class="hljs-keyword">this</span>._box.setAttribute(<span class="hljs-string">'role'</span>, <span class="hljs-string">'dialog'</span>);
        <span class="hljs-keyword">this</span>._box.innerHTML = gb_BoxTemplateInner;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._box.hasClassName(<span class="hljs-string">'frame'</span>))
            <span class="hljs-keyword">this</span>.getBodyWrapperElement().update(gb_BodyFrameTemplate);
        <span class="hljs-keyword">this</span>.options.parent.appendChild(<span class="hljs-keyword">this</span>._box);
        <span class="hljs-keyword">this</span>.setBody(<span class="hljs-keyword">this</span>.options.body);
        <span class="hljs-keyword">this</span>.setBodyPadding(<span class="hljs-keyword">this</span>.options.bodyPadding);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.titleHtml)
            <span class="hljs-keyword">this</span>.setTitleHtml(<span class="hljs-keyword">this</span>.options.titleHtml)
        <span class="hljs-keyword">else</span>
            <span class="hljs-keyword">this</span>.setTitle(<span class="hljs-keyword">this</span>.options.title);
        <span class="hljs-keyword">this</span>.setDraggable(<span class="hljs-keyword">this</span>.options.draggable);
        <span class="hljs-keyword">this</span>.setStyle({
            <span class="hljs-attr">position</span>: <span class="hljs-keyword">this</span>.options.position
        });
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.maxWidth)
            <span class="hljs-keyword">this</span>.setMaxWidth(<span class="hljs-keyword">this</span>.options.maxWidth);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.showClose)
            <span class="hljs-keyword">this</span>.addToolbarCloseButton();
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.allowOverflowY === <span class="hljs-literal">false</span>)
            <span class="hljs-keyword">this</span>.getBodyElement().setStyle({
                <span class="hljs-attr">overflowY</span>: <span class="hljs-string">'hidden'</span>
            });
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.allowOverflowX === <span class="hljs-literal">false</span>)
            <span class="hljs-keyword">this</span>.getBodyElement().setStyle({
                <span class="hljs-attr">overflowX</span>: <span class="hljs-string">'hidden'</span>
            });
        g_glideBoxes[<span class="hljs-keyword">this</span>.options.id] = <span class="hljs-keyword">this</span>;
    },
    <span class="hljs-attr">getId</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.options.id;
    },
    <span class="hljs-attr">getBoxElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._box;
    },
    <span class="hljs-attr">getBoxWrapperElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._box.select(<span class="hljs-string">'.gb_wrapper'</span>)[<span class="hljs-number">0</span>];
    },
    <span class="hljs-attr">getIFrameElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._box.select(<span class="hljs-string">'iframe'</span>)[<span class="hljs-number">0</span>];
    },
    <span class="hljs-attr">isVisible</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._box.visible();
    },
    <span class="hljs-attr">isLoading</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._isLoading;
    },
    <span class="hljs-attr">setOnClick</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{
        <span class="hljs-keyword">this</span>._box.observe(<span class="hljs-string">'click'</span>, f.bind(<span class="hljs-keyword">this</span>));
    },
    <span class="hljs-attr">setOnBeforeLoad</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{
        <span class="hljs-keyword">this</span>.options.onBeforeLoad = f;
    },
    <span class="hljs-attr">setOnAfterLoad</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{
        <span class="hljs-keyword">this</span>.options.onAfterLoad = f;
    },
    <span class="hljs-attr">setOnBeforeClose</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{
        <span class="hljs-keyword">this</span>.options.onBeforeClose = f;
    },
    <span class="hljs-attr">setOnAfterClose</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{
        <span class="hljs-keyword">this</span>.options.onAfterClose = f;
    },
    <span class="hljs-attr">setOnBeforeDrag</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{
        <span class="hljs-keyword">this</span>.options.onBeforeDrag = f;
    },
    <span class="hljs-attr">setOnAfterDrag</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{
        <span class="hljs-keyword">this</span>.options.onAfterDrag = f;
    },
    <span class="hljs-attr">setOnBeforeResize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{
        <span class="hljs-keyword">this</span>.options.onBeforeResize = f;
    },
    <span class="hljs-attr">setOnAfterResizes</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{
        <span class="hljs-keyword">this</span>.options.onAfterResize = f;
    },
    <span class="hljs-attr">setOnHeightAdjust</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{
        <span class="hljs-keyword">this</span>.options.onHeightAdjust = f;
    },
    <span class="hljs-attr">setOnWidthAdjust</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{
        <span class="hljs-keyword">this</span>.options.onWidthAdjust = f;
    },
    <span class="hljs-attr">addData</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key, value</span>) </span>{
        <span class="hljs-keyword">this</span>._dataCache[key] = value;
    },
    <span class="hljs-attr">getData</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._dataCache[key];
    },
    <span class="hljs-attr">getToolbar</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._box.select(<span class="hljs-string">'.gb_toolbar'</span>)[<span class="hljs-number">0</span>];
    },
    <span class="hljs-attr">addToolbarRow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">html</span>) </span>{
        <span class="hljs-keyword">var</span> thead = <span class="hljs-keyword">this</span>._box.select(<span class="hljs-string">'.gb_table &gt; thead'</span>)[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">var</span> td = thead.insertRow(thead.rows.length).insertCell(<span class="hljs-number">0</span>);
        td.className = <span class="hljs-string">'gb_table_col_l1'</span>;
        td.innerHTML = html;
        <span class="hljs-keyword">return</span> td;
    },
    <span class="hljs-attr">setTitle</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">html</span>) </span>{
        <span class="hljs-keyword">var</span> titleZone = <span class="hljs-keyword">this</span>._box.select(<span class="hljs-string">'.gb_title_zone'</span>)[<span class="hljs-number">0</span>];
        titleZone.addClassName(<span class="hljs-string">'gb_toolbar_text'</span>);
        <span class="hljs-keyword">if</span> (titleZone.firstChild)
            titleZone.removeChild(titleZone.firstChild);
        <span class="hljs-keyword">var</span> text = <span class="hljs-built_in">document</span>.createTextNode(html);
        titleZone.appendChild(text);
        <span class="hljs-keyword">this</span>._box.setAttribute(<span class="hljs-string">'aria-label'</span>, html);
    },
    <span class="hljs-attr">setTitleHtml</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">html</span>) </span>{
        <span class="hljs-keyword">this</span>._box.select(<span class="hljs-string">'.gb_title_zone'</span>)[<span class="hljs-number">0</span>].removeClassName(<span class="hljs-string">'gb_toolbar_text'</span>).innerHTML = html;
    },
    <span class="hljs-attr">setWindowIcon</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">html</span>) </span>{
        <span class="hljs-keyword">var</span> tr = <span class="hljs-keyword">this</span>._box.select(<span class="hljs-string">'.gb_toolbar_left tr'</span>)[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = tr.childNodes.length; i &lt; l; i++)
            tr.deleteCell(i);
        <span class="hljs-keyword">this</span>.addWindowIcon(html);
    },
    <span class="hljs-attr">addWindowIcon</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">html</span>) </span>{
        <span class="hljs-keyword">this</span>.addToolbarLeftDecoration(<span class="hljs-string">'&lt;div style="margin-left:5px;"&gt;'</span> + html + <span class="hljs-string">'&lt;/div&gt;'</span>);
    },
    <span class="hljs-attr">removeToolbarDecoration</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">objSelector</span>) </span>{
        <span class="hljs-keyword">var</span> e = <span class="hljs-keyword">this</span>.getToolbar().select(objSelector);
        <span class="hljs-keyword">if</span> (!e || e.length == <span class="hljs-number">0</span>)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">if</span> (e[<span class="hljs-number">0</span>].tagName.toLowerCase() == <span class="hljs-string">'td'</span>)
            <span class="hljs-keyword">var</span> td = e;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e[<span class="hljs-number">0</span>].parentNode.tagName.toLowerCase() == <span class="hljs-string">'td'</span>)
            <span class="hljs-keyword">var</span> td = e[<span class="hljs-number">0</span>].parentNode;
        <span class="hljs-keyword">else</span>
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">var</span> tr = td.parentNode;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = tr.childNodes.length; i &lt; l; i++) {
            <span class="hljs-keyword">if</span> (tr.childNodes[i] == td) {
                tr.deleteCell(i);
                <span class="hljs-keyword">break</span>;
            }
        }
    },
    <span class="hljs-attr">addToolbarLeftDecoration</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">html, boolPrepend</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._addToolbarDecoration(html, boolPrepend || <span class="hljs-literal">false</span>, <span class="hljs-string">'.gb_toolbar_left'</span>);
    },
    <span class="hljs-attr">addToolbarRightDecoration</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">html, boolPrepend</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._addToolbarDecoration(html, boolPrepend || <span class="hljs-literal">false</span>, <span class="hljs-string">'.gb_toolbar_right'</span>);
    },
    <span class="hljs-attr">addToolbarCloseButton</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> arr = <span class="hljs-keyword">this</span>._box.getElementsByClassName(<span class="hljs-string">'gb_close'</span>);
        <span class="hljs-keyword">if</span> (arr.length == <span class="hljs-number">1</span>)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">var</span> className = <span class="hljs-keyword">this</span>._box.hasClassName(<span class="hljs-string">'dark'</span>) || <span class="hljs-keyword">this</span>._box.hasClassName(<span class="hljs-string">'iframe'</span>) ?
            <span class="hljs-string">'icon-cross-circle i12 i12_close'</span> :
            <span class="hljs-string">'icon-cross-circle i16 i16_close2'</span>;
        <span class="hljs-keyword">this</span>.addToolbarRightDecoration(<span class="hljs-string">'&lt;span style="float:none;cursor:pointer;" '</span> +
            <span class="hljs-string">'tabindex="0" aria-label="Close" role="button" class="gb_close '</span> + className + <span class="hljs-string">'"&gt;&lt;/span&gt;'</span>);
        <span class="hljs-keyword">this</span>.setToolbarCloseOnClick(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
            <span class="hljs-keyword">this</span>.close();
        }.bind(<span class="hljs-keyword">this</span>));
    },
    <span class="hljs-attr">removeToolbarCloseButton</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.removeToolbarDecoration(<span class="hljs-string">'.gb_close'</span>);
    },
    <span class="hljs-attr">setToolbarCloseOnClick</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{
        <span class="hljs-keyword">var</span> arr = <span class="hljs-keyword">this</span>._box.getElementsByClassName(<span class="hljs-string">'gb_close'</span>);
        <span class="hljs-keyword">if</span> (arr.length == <span class="hljs-number">0</span>)
            <span class="hljs-keyword">return</span>;
        arr[<span class="hljs-number">0</span>].stopObserving(<span class="hljs-string">'mousedown'</span>);
        arr[<span class="hljs-number">0</span>].observe(<span class="hljs-string">'mousedown'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
            f.call(<span class="hljs-keyword">this</span>, event);
            event.stop();
        }.bind(<span class="hljs-keyword">this</span>));
        arr[<span class="hljs-number">0</span>].stopObserving(<span class="hljs-string">'keydown'</span>);
        arr[<span class="hljs-number">0</span>].observe(<span class="hljs-string">'keydown'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
            <span class="hljs-keyword">if</span> (event.keyCode != <span class="hljs-number">13</span>)
                <span class="hljs-keyword">return</span>;
            f.call(<span class="hljs-keyword">this</span>, event);
            event.stop();
        }.bind(<span class="hljs-keyword">this</span>));
    },
    <span class="hljs-attr">_addToolbarDecoration</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">html, boolPrepend, tableClassSelector</span>) </span>{
        <span class="hljs-keyword">var</span> table = <span class="hljs-keyword">this</span>._box.select(tableClassSelector)[<span class="hljs-number">0</span>].show();
        <span class="hljs-keyword">var</span> tr = table.select(<span class="hljs-string">'tr'</span>)[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">var</span> td = tr.insertCell(boolPrepend ? <span class="hljs-number">0</span> : <span class="hljs-number">-1</span>);
        td.innerHTML = html;
        <span class="hljs-keyword">return</span> td;
    },
    <span class="hljs-attr">getFooter</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._box.select(<span class="hljs-string">'.gb_footer'</span>)[<span class="hljs-number">0</span>];
    },
    <span class="hljs-attr">showFooter</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isFooterVisible === <span class="hljs-literal">true</span>)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">this</span>.getFooter().show();
        <span class="hljs-keyword">this</span>._box.select(<span class="hljs-string">'.gb_table &gt; tfoot'</span>)[<span class="hljs-number">0</span>].setStyle({
            <span class="hljs-attr">display</span>: <span class="hljs-string">'table-footer-group'</span>
        });
        <span class="hljs-keyword">this</span>._isFooterVisible = <span class="hljs-literal">true</span>;
    },
    <span class="hljs-attr">hideFooter</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._isFooterVisible !== <span class="hljs-literal">true</span>)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">this</span>.getFooter().hide();
        <span class="hljs-keyword">this</span>._box.select(<span class="hljs-string">'.gb_table &gt; tfoot'</span>)[<span class="hljs-number">0</span>].setStyle({
            <span class="hljs-attr">display</span>: <span class="hljs-string">'none'</span>
        });
        <span class="hljs-keyword">this</span>._isFooterVisible = <span class="hljs-literal">false</span>;
    },
    <span class="hljs-attr">showFooterResizeGrips</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.showFooter();
        <span class="hljs-keyword">var</span> footer = <span class="hljs-keyword">this</span>.getFooter();
        <span class="hljs-keyword">if</span> (!footer.select(<span class="hljs-string">'.i16_resize_grip_left'</span>))
            <span class="hljs-keyword">return</span>;
        footer.select(<span class="hljs-string">'.gb_footer_left_resize'</span>)[<span class="hljs-number">0</span>].innerHTML = <span class="hljs-string">'&lt;span class="i16 i16_resize_grip_left" style="float:none;" /&gt;'</span>;
        footer.select(<span class="hljs-string">'.gb_footer_right_resize'</span>)[<span class="hljs-number">0</span>].innerHTML = <span class="hljs-string">'&lt;span class="i16 i16_resize_grip_right" style="float:none;" /&gt;'</span>;
        <span class="hljs-keyword">this</span>.leftResizeDragger = <span class="hljs-keyword">new</span> GlideDraggable(footer.select(<span class="hljs-string">'.i16_resize_grip_left'</span>)[<span class="hljs-number">0</span>], footer);
        <span class="hljs-keyword">this</span>.leftResizeDragger.setHoverCursor(<span class="hljs-string">'sw-resize'</span>);
        <span class="hljs-keyword">this</span>.leftResizeDragger.setDragCursor(<span class="hljs-string">'sw-resize'</span>);
        <span class="hljs-keyword">this</span>.leftResizeDragger.setStartFunction(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e, dragElem, pageCoords, shift, dragCoords</span>) </span>{
            <span class="hljs-keyword">var</span> dims = <span class="hljs-keyword">this</span>._getViewportDimensions();
            <span class="hljs-keyword">var</span> offsets = <span class="hljs-built_in">document</span>.viewport.getScrollOffsets();
            <span class="hljs-keyword">this</span>._currentOffset = <span class="hljs-keyword">this</span>.getOffset();
            <span class="hljs-keyword">this</span>._currentOffset.right = <span class="hljs-keyword">this</span>._currentOffset.left + <span class="hljs-keyword">this</span>.getWidth();
            <span class="hljs-keyword">this</span>._isLeftPositioned = <span class="hljs-keyword">this</span>.convertToRightPosition();
            <span class="hljs-keyword">this</span>._maxWidth = <span class="hljs-keyword">this</span>._currentOffset.right - <span class="hljs-keyword">this</span>.options.padding.left - offsets.left;
            <span class="hljs-keyword">this</span>._maxHeight = dims.height - <span class="hljs-keyword">this</span>.options.padding.top - <span class="hljs-keyword">this</span>._currentOffset.top + offsets.top;
            <span class="hljs-keyword">this</span>.options.onBeforeResize.call(<span class="hljs-keyword">this</span>);
        }.bind(<span class="hljs-keyword">this</span>));
        <span class="hljs-keyword">this</span>.leftResizeDragger.setDragFunction(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e, dragElem, pageCoords, shift, dragCoords</span>) </span>{
            <span class="hljs-keyword">this</span>.setWidth(<span class="hljs-built_in">Math</span>.min(<span class="hljs-keyword">this</span>._maxWidth, (<span class="hljs-keyword">this</span>._currentOffset.right - pageCoords.x)));
            <span class="hljs-keyword">this</span>.setHeight(<span class="hljs-built_in">Math</span>.min(<span class="hljs-keyword">this</span>._maxHeight, (pageCoords.y - <span class="hljs-keyword">this</span>._currentOffset.top)));
        }.bind(<span class="hljs-keyword">this</span>));
        <span class="hljs-keyword">this</span>.leftResizeDragger.setEndFunction(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isLeftPositioned)
                <span class="hljs-keyword">this</span>.convertToLeftPosition();
            <span class="hljs-keyword">this</span>._isLeftPositioned = <span class="hljs-literal">null</span>;
            <span class="hljs-keyword">this</span>.options.onAfterResize.call(<span class="hljs-keyword">this</span>);
        }.bind(<span class="hljs-keyword">this</span>));
        <span class="hljs-keyword">this</span>.rightResizeDragger = <span class="hljs-keyword">new</span> GlideDraggable(footer.select(<span class="hljs-string">'.i16_resize_grip_right'</span>)[<span class="hljs-number">0</span>], footer);
        <span class="hljs-keyword">this</span>.rightResizeDragger.setHoverCursor(<span class="hljs-string">'se-resize'</span>);
        <span class="hljs-keyword">this</span>.rightResizeDragger.setDragCursor(<span class="hljs-string">'se-resize'</span>);
        <span class="hljs-keyword">this</span>.rightResizeDragger.setStartFunction(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e, dragElem, pageCoords, shift, dragCoords</span>) </span>{
            <span class="hljs-keyword">var</span> dims = <span class="hljs-keyword">this</span>._getViewportDimensions();
            <span class="hljs-keyword">var</span> offsets = <span class="hljs-built_in">document</span>.viewport.getScrollOffsets();
            <span class="hljs-keyword">this</span>._currentOffset = <span class="hljs-keyword">this</span>.getOffset();
            <span class="hljs-keyword">this</span>._isRightPositioned = <span class="hljs-keyword">this</span>.convertToLeftPosition();
            <span class="hljs-keyword">this</span>._maxWidth = dims.width - <span class="hljs-keyword">this</span>.options.padding.left - <span class="hljs-keyword">this</span>._currentOffset.left + offsets.left;
            <span class="hljs-keyword">this</span>._maxHeight = dims.height - <span class="hljs-keyword">this</span>.options.padding.top - <span class="hljs-keyword">this</span>._currentOffset.top + offsets.top;
            <span class="hljs-keyword">this</span>.options.onBeforeResize.call(<span class="hljs-keyword">this</span>);
        }.bind(<span class="hljs-keyword">this</span>));
        <span class="hljs-keyword">this</span>.rightResizeDragger.setDragFunction(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e, dragElem, pageCoords, shift, dragCoords</span>) </span>{
            <span class="hljs-keyword">this</span>.setWidth(<span class="hljs-built_in">Math</span>.min(<span class="hljs-keyword">this</span>._maxWidth, (pageCoords.x - <span class="hljs-keyword">this</span>._currentOffset.left)));
            <span class="hljs-keyword">this</span>.setHeight(<span class="hljs-built_in">Math</span>.min(<span class="hljs-keyword">this</span>._maxHeight, (pageCoords.y - <span class="hljs-keyword">this</span>._currentOffset.top)));
        }.bind(<span class="hljs-keyword">this</span>));
        <span class="hljs-keyword">this</span>.rightResizeDragger.setEndFunction(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isRightPositioned)
                <span class="hljs-keyword">this</span>.convertToRightPosition();
            <span class="hljs-keyword">this</span>._isRightPositioned = <span class="hljs-literal">null</span>;
            <span class="hljs-keyword">this</span>.options.onAfterResize.call(<span class="hljs-keyword">this</span>);
        }.bind(<span class="hljs-keyword">this</span>));
    },
    <span class="hljs-attr">hideFooterResizeGrips</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.leftResizeDragger.destroy();
        <span class="hljs-keyword">this</span>.rightResizeDragger.destroy();
        <span class="hljs-keyword">this</span>.leftResizeDragger = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.rightResizeDragger = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>._box.select(<span class="hljs-string">'.gb_footer_left_resize'</span>)[<span class="hljs-number">0</span>].innerHTML = <span class="hljs-string">''</span>;
        <span class="hljs-keyword">this</span>._box.select(<span class="hljs-string">'.gb_footer_right_resize'</span>)[<span class="hljs-number">0</span>].innerHTML = <span class="hljs-string">''</span>;
    },
    <span class="hljs-attr">getFooterContainer</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._box.select(<span class="hljs-string">'.gb_footer_body &gt; div'</span>)[<span class="hljs-number">0</span>];
    },
    <span class="hljs-attr">setFooter</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">html</span>) </span>{
        <span class="hljs-keyword">this</span>.showFooter();
        <span class="hljs-keyword">this</span>._box.select(<span class="hljs-string">'.gb_footer_body &gt; div'</span>)[<span class="hljs-number">0</span>].innerHTML = html;
    },
    <span class="hljs-attr">prependFooterRow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">html</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._addFooterRow(<span class="hljs-number">0</span>, html);
    },
    <span class="hljs-attr">appendFooterRow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">html</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._addFooterRow(<span class="hljs-number">-1</span>, html);
    },
    <span class="hljs-attr">_addFooterRow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">pos, html</span>) </span>{
        <span class="hljs-keyword">var</span> foot = <span class="hljs-keyword">this</span>._box.select(<span class="hljs-string">'.gb_table &gt; tfoot'</span>)[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">var</span> td = foot.insertRow(pos == <span class="hljs-number">-1</span> ? foot.rows.length : pos).insertCell(<span class="hljs-number">0</span>);
        td.className = <span class="hljs-string">'gb_table_col_l1'</span>;
        td.innerHTML = html;
        <span class="hljs-keyword">return</span> td;
    },
    <span class="hljs-attr">getMaxDimensions</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> vp = <span class="hljs-keyword">this</span>._getViewportDimensions();
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.parent == <span class="hljs-built_in">document</span>.body || <span class="hljs-keyword">this</span>.options.parent != <span class="hljs-keyword">this</span>.options.boundingContainer)
            <span class="hljs-keyword">var</span> res = {
                <span class="hljs-attr">width</span>: vp.width,
                <span class="hljs-attr">height</span>: vp.height
            };
        <span class="hljs-keyword">else</span>
            <span class="hljs-keyword">var</span> res = <span class="hljs-keyword">this</span>.options.parent.getDimensions();
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.boundingContainer == <span class="hljs-keyword">this</span>.options.parent) {
            res.height -= <span class="hljs-keyword">this</span>.options.top !== <span class="hljs-literal">null</span> ? <span class="hljs-keyword">this</span>.options.top : <span class="hljs-keyword">this</span>.options.padding.top;
            res.height -= <span class="hljs-keyword">this</span>.options.bottom !== <span class="hljs-literal">null</span> ? <span class="hljs-keyword">this</span>.options.bottom : <span class="hljs-keyword">this</span>.options.padding.bottom;
            res.width -= <span class="hljs-keyword">this</span>.options.left !== <span class="hljs-literal">null</span> ? <span class="hljs-keyword">this</span>.options.left : <span class="hljs-keyword">this</span>.options.padding.left;
            res.width -= <span class="hljs-keyword">this</span>.options.right !== <span class="hljs-literal">null</span> ? <span class="hljs-keyword">this</span>.options.right : <span class="hljs-keyword">this</span>.options.padding.right;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.boundingContainer == <span class="hljs-built_in">document</span>.body &amp;&amp; <span class="hljs-built_in">document</span>.loaded == <span class="hljs-literal">true</span>) {
            <span class="hljs-keyword">var</span> o = <span class="hljs-keyword">this</span>.options.parent.cumulativeOffset();
            <span class="hljs-keyword">var</span> dims = <span class="hljs-keyword">this</span>.options.parent.getDimensions();
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.bottom !== <span class="hljs-literal">null</span>)
                res.height -= vp.height - (o.top + dims.height) + <span class="hljs-keyword">this</span>.options.padding.top;
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.top !== <span class="hljs-literal">null</span>)
                res.height -= o.top + <span class="hljs-keyword">this</span>.options.padding.bottom;
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.right !== <span class="hljs-literal">null</span>)
                res.width -= vp.width - (o.left + dims.width) + <span class="hljs-keyword">this</span>.options.padding.left;
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.left !== <span class="hljs-literal">null</span>)
                res.width -= o.left + <span class="hljs-keyword">this</span>.options.padding.right;
        } <span class="hljs-keyword">else</span> {}
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.maxWidth)
            res.width = <span class="hljs-built_in">Math</span>.min(res.width, <span class="hljs-keyword">this</span>.options.maxWidth);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.maxHeight)
            res.height = <span class="hljs-built_in">Math</span>.min(res.height, <span class="hljs-keyword">this</span>.options.maxHeight);
        <span class="hljs-keyword">return</span> res;
    },
    <span class="hljs-attr">getDocumentHeight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">doc</span>) </span>{
        <span class="hljs-keyword">var</span> D = doc || <span class="hljs-built_in">window</span>.document;
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.max(
            <span class="hljs-built_in">Math</span>.max(D.body.scrollHeight, D.documentElement.scrollHeight),
            <span class="hljs-built_in">Math</span>.max(D.body.offsetHeight, D.documentElement.offsetHeight),
            <span class="hljs-built_in">Math</span>.max(D.body.clientHeight, D.documentElement.clientHeight)
        );
    },
    <span class="hljs-attr">getDocumentWidth</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">doc</span>) </span>{
        <span class="hljs-keyword">var</span> D = doc || <span class="hljs-built_in">window</span>.document;
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.max(
            <span class="hljs-built_in">Math</span>.max(D.body.scrollWidth, D.documentElement.scrollWidth),
            <span class="hljs-built_in">Math</span>.max(D.body.offsetWidth, D.documentElement.offsetWidth),
            <span class="hljs-built_in">Math</span>.max(D.body.clientWidth, D.documentElement.clientWidth)
        );
    },
    <span class="hljs-attr">autoDimension</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>._scrollBarWidth = <span class="hljs-keyword">this</span>._scrollBarWidth || getScrollBarWidthPx();
        <span class="hljs-keyword">var</span> box = <span class="hljs-keyword">this</span>._box;
        <span class="hljs-keyword">var</span> body = <span class="hljs-keyword">this</span>.getBodyElement();
        <span class="hljs-keyword">var</span> bodyWrapper = <span class="hljs-keyword">this</span>.getBodyWrapperElement();
        <span class="hljs-keyword">var</span> extraWidth = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">var</span> innerHeight = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">var</span> innerWidth = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">var</span> maxDim = <span class="hljs-keyword">this</span>.getMaxDimensions();
        <span class="hljs-keyword">var</span> clone = <span class="hljs-literal">null</span>;
        box.setStyle({
            <span class="hljs-attr">width</span>: <span class="hljs-string">''</span>,
            <span class="hljs-attr">height</span>: <span class="hljs-string">''</span>
        });
        bodyWrapper.setStyle({
            <span class="hljs-attr">width</span>: <span class="hljs-string">''</span>,
            <span class="hljs-attr">height</span>: <span class="hljs-string">''</span>,
            <span class="hljs-attr">overflowY</span>: <span class="hljs-string">'hidden'</span>
        });
        body.setStyle({
            <span class="hljs-attr">width</span>: <span class="hljs-string">''</span>,
            <span class="hljs-attr">height</span>: <span class="hljs-string">''</span>
        });
        <span class="hljs-keyword">var</span> iframe = <span class="hljs-keyword">this</span>.getIFrameElement();
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.iframe &amp;&amp; iframe &amp;&amp; !<span class="hljs-keyword">this</span>.isLoading()) {
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.options.width &amp;&amp; !<span class="hljs-keyword">this</span>.options.height) {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">var</span> D = iframe.contentDocument || iframe.contentWindow.document;
                    innerWidth = (<span class="hljs-keyword">this</span>.getDocumentWidth(D) + <span class="hljs-number">4</span>);
                    innerHeight = (<span class="hljs-keyword">this</span>.getDocumentHeight(D) + <span class="hljs-number">4</span>);
                    <span class="hljs-keyword">if</span> (isMacintosh &amp;&amp; Prototype.Browser.Gecko)
                        innerHeight++;
                } <span class="hljs-keyword">catch</span> (e) {
                    innerWidth = <span class="hljs-number">500</span>;
                    innerHeight = <span class="hljs-number">500</span>;
                }
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.height) {
                    <span class="hljs-keyword">var</span> p = (<span class="hljs-keyword">this</span>.options.height + <span class="hljs-string">''</span>).match(<span class="hljs-regexp">/([0-9]*)%/</span>);
                    <span class="hljs-keyword">var</span> diff = box.measure(<span class="hljs-string">'border-box-height'</span>) - body.measure(<span class="hljs-string">'border-box-height'</span>);
                    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.QUIRKS_MODE)
                        diff = diff - box.measure(<span class="hljs-string">'border-top'</span>) - box.measure(<span class="hljs-string">'border-bottom'</span>);
                    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.options.height == <span class="hljs-string">'number'</span>)
                        innerHeight = <span class="hljs-keyword">this</span>.options.height - diff;
                    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.options.height == <span class="hljs-string">'string'</span> &amp;&amp; p)
                        innerHeight = (maxDim.height * (<span class="hljs-built_in">parseInt</span>(p[<span class="hljs-number">1</span>], <span class="hljs-number">10</span>) / <span class="hljs-number">100</span>)) - diff;
                }
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.width) {
                    <span class="hljs-keyword">var</span> p = (<span class="hljs-keyword">this</span>.options.width + <span class="hljs-string">''</span>).match(<span class="hljs-regexp">/([0-9]*)%/</span>);
                    <span class="hljs-keyword">var</span> diff = box.measure(<span class="hljs-string">'border-box-width'</span>) - body.measure(<span class="hljs-string">'border-box-width'</span>);
                    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.QUIRKS_MODE)
                        diff = diff - box.measure(<span class="hljs-string">'border-left'</span>) - box.measure(<span class="hljs-string">'border-right'</span>);
                    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.options.width == <span class="hljs-string">'number'</span>)
                        innerWidth = <span class="hljs-keyword">this</span>.options.width - diff;
                    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.options.width == <span class="hljs-string">'string'</span> &amp;&amp; p)
                        innerWidth = (maxDim.width * (<span class="hljs-built_in">parseInt</span>(p[<span class="hljs-number">1</span>], <span class="hljs-number">10</span>) / <span class="hljs-number">100</span>)) - diff;
                }
            }
            iframe.writeAttribute(<span class="hljs-string">'height'</span>, <span class="hljs-number">0</span>);
            iframe.writeAttribute(<span class="hljs-string">'width'</span>, <span class="hljs-number">0</span>);
        } <span class="hljs-keyword">else</span> {
            clone = Element.clone(box, <span class="hljs-literal">true</span>);
            clone.id = <span class="hljs-string">''</span>;
            clone.setStyle({
                <span class="hljs-attr">position</span>: <span class="hljs-string">'absolute'</span>,
                <span class="hljs-attr">top</span>: <span class="hljs-string">'-1999px'</span>,
                <span class="hljs-attr">left</span>: <span class="hljs-string">'-1999px'</span>,
                <span class="hljs-attr">right</span>: <span class="hljs-string">''</span>,
                <span class="hljs-attr">bottom</span>: <span class="hljs-string">''</span>,
                <span class="hljs-attr">width</span>: <span class="hljs-string">''</span>,
                <span class="hljs-attr">height</span>: <span class="hljs-string">''</span>,
                <span class="hljs-attr">display</span>: <span class="hljs-string">'block'</span>,
                <span class="hljs-attr">visibility</span>: <span class="hljs-string">'hidden'</span>
            });
            clone.innerHTML = clone.innerHTML;
            <span class="hljs-built_in">document</span>.body.appendChild(clone);
            <span class="hljs-keyword">var</span> cloneBody = clone.select(<span class="hljs-string">'.gb_body:first'</span>)[<span class="hljs-number">0</span>];
            <span class="hljs-keyword">var</span> diff = clone.measure(<span class="hljs-string">'border-box-width'</span>) - cloneBody.measure(<span class="hljs-string">'border-box-width'</span>);
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.QUIRKS_MODE)
                diff = diff - clone.measure(<span class="hljs-string">'border-left'</span>) - clone.measure(<span class="hljs-string">'border-right'</span>);
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.options.width)
                innerWidth = <span class="hljs-built_in">Math</span>.min(maxDim.width - diff, cloneBody.getWidth() + <span class="hljs-number">1</span>);
            <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">var</span> p = (<span class="hljs-keyword">this</span>.options.width + <span class="hljs-string">''</span>).match(<span class="hljs-regexp">/([0-9]*)%/</span>);
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.options.width == <span class="hljs-string">'number'</span>)
                    innerWidth = <span class="hljs-built_in">Math</span>.min(maxDim.width, <span class="hljs-keyword">this</span>.options.width) - diff;
                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.options.width == <span class="hljs-string">'string'</span> &amp;&amp; p)
                    innerWidth = (maxDim.width * (<span class="hljs-built_in">parseInt</span>(p[<span class="hljs-number">1</span>], <span class="hljs-number">10</span>) / <span class="hljs-number">100</span>)) - diff;
            }
            cloneBody.setStyle({
                <span class="hljs-attr">width</span>: innerWidth + <span class="hljs-string">'px'</span>
            });
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.options.height) {
                innerHeight = cloneBody.getHeight();
                cloneBody.setStyle({
                    <span class="hljs-attr">width</span>: innerWidth + <span class="hljs-string">'px'</span>
                });
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">var</span> p = (<span class="hljs-keyword">this</span>.options.height + <span class="hljs-string">''</span>).match(<span class="hljs-regexp">/([0-9]*)%/</span>);
                <span class="hljs-keyword">var</span> diff = clone.measure(<span class="hljs-string">'border-box-height'</span>) - cloneBody.measure(<span class="hljs-string">'border-box-height'</span>);
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.QUIRKS_MODE)
                    diff = diff - box.measure(<span class="hljs-string">'border-top'</span>) - box.measure(<span class="hljs-string">'border-bottom'</span>);
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.options.height == <span class="hljs-string">'number'</span>)
                    innerHeight = <span class="hljs-keyword">this</span>.options.height - diff;
                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.options.height == <span class="hljs-string">'string'</span> &amp;&amp; p)
                    innerHeight = (maxDim.height * (<span class="hljs-built_in">parseInt</span>(p[<span class="hljs-number">1</span>], <span class="hljs-number">10</span>) / <span class="hljs-number">100</span>)) - diff;
                cloneBody.setStyle({
                    <span class="hljs-attr">height</span>: innerHeight + <span class="hljs-string">'px'</span>
                });
            }
        }
        <span class="hljs-keyword">if</span> (clone &amp;&amp; <span class="hljs-keyword">this</span>.options.width &amp;&amp; <span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.options.width == <span class="hljs-string">'string'</span>) {
            <span class="hljs-keyword">var</span> per = (<span class="hljs-keyword">this</span>.options.width + <span class="hljs-string">''</span>).match(<span class="hljs-regexp">/([0-9]*)%/</span>);
            clone.setStyle({
                <span class="hljs-attr">width</span>: (maxDim.width * (<span class="hljs-built_in">parseInt</span>(per[<span class="hljs-number">1</span>], <span class="hljs-number">10</span>) / <span class="hljs-number">100</span>)) + <span class="hljs-string">'px'</span>
            });
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (clone &amp;&amp; <span class="hljs-keyword">this</span>.options.width &amp;&amp; <span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.options.width == <span class="hljs-string">'number'</span>)
            clone.setStyle({
                <span class="hljs-attr">width</span>: <span class="hljs-keyword">this</span>.options.width + <span class="hljs-string">'px'</span>
            });
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.allowOverflowY === <span class="hljs-literal">true</span>)
            bodyWrapper.setStyle({
                <span class="hljs-attr">overflowY</span>: <span class="hljs-string">''</span>
            });
        body.style.width = innerWidth + <span class="hljs-string">'px'</span>;
        body.style.height = innerHeight + <span class="hljs-string">'px'</span>;
        <span class="hljs-keyword">var</span> dims = clone ? clone.getDimensions() : box.getDimensions();
        <span class="hljs-keyword">var</span> diffHeight = dims.height - maxDim.height;
        <span class="hljs-keyword">if</span> (dims.height &gt; maxDim.height) {
            extraWidth = <span class="hljs-keyword">this</span>.options.allowOverflowY === <span class="hljs-literal">true</span> ? <span class="hljs-keyword">this</span>._scrollBarWidth : <span class="hljs-number">0</span>;
            body.style.height = <span class="hljs-built_in">Math</span>.max(<span class="hljs-number">0</span>, innerHeight - diffHeight) + <span class="hljs-string">'px'</span>;
            <span class="hljs-keyword">this</span>.setHeight(maxDim.height, clone);
        } <span class="hljs-keyword">else</span>
            <span class="hljs-keyword">this</span>.setHeight(dims.height, clone);
        <span class="hljs-keyword">if</span> (dims.width &gt; maxDim.width) {
            <span class="hljs-keyword">this</span>.setWidth(maxDim.width);
            <span class="hljs-keyword">this</span>.setHeight(<span class="hljs-built_in">Math</span>.min(maxDim.height, dims.height + <span class="hljs-keyword">this</span>._scrollBarWidth), clone);
        } <span class="hljs-keyword">else</span>
            <span class="hljs-keyword">this</span>.setWidth(<span class="hljs-built_in">Math</span>.min(dims.width, <span class="hljs-keyword">this</span>.options.width &amp;&amp; <span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.options.width == <span class="hljs-string">'number'</span> ? <span class="hljs-keyword">this</span>.options.width : dims.width) + extraWidth);
        <span class="hljs-keyword">if</span> (clone)
            clone.remove();
        <span class="hljs-keyword">this</span>._resizeIframeShim();
    },
    <span class="hljs-attr">size</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">w, h</span>) </span>{
        <span class="hljs-keyword">if</span> (w) <span class="hljs-keyword">this</span>.setWidth(w);
        <span class="hljs-keyword">if</span> (h) <span class="hljs-keyword">this</span>.setHeight(h);
    },
    <span class="hljs-attr">setMaxWidth</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">mw</span>) </span>{
        <span class="hljs-keyword">this</span>.options.maxWidth = <span class="hljs-built_in">parseInt</span>(mw, <span class="hljs-number">10</span>);
        <span class="hljs-keyword">this</span>._box.setStyle({
            <span class="hljs-attr">maxWidth</span>: <span class="hljs-keyword">this</span>.options.maxWidth + <span class="hljs-string">'px'</span>
        });
    },
    <span class="hljs-attr">setWidth</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">w</span>) </span>{
        w = <span class="hljs-keyword">typeof</span> w == <span class="hljs-string">'string'</span> ? <span class="hljs-built_in">parseInt</span>(w, <span class="hljs-number">10</span>) : w;
        <span class="hljs-keyword">var</span> box = <span class="hljs-keyword">this</span>._box;
        <span class="hljs-keyword">var</span> boxBorder = box.measure(<span class="hljs-string">'border-left'</span>) + box.measure(<span class="hljs-string">'border-right'</span>);
        <span class="hljs-keyword">var</span> gbWrapper = box.select(<span class="hljs-string">'.gb_wrapper'</span>)[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">var</span> wrapperBorder = gbWrapper.measure(<span class="hljs-string">'border-left'</span>) + gbWrapper.measure(<span class="hljs-string">'border-right'</span>);
        <span class="hljs-keyword">var</span> wrapper = <span class="hljs-keyword">this</span>.getBodyWrapperElement();
        <span class="hljs-keyword">var</span> body = <span class="hljs-keyword">this</span>.getBodyElement();
        <span class="hljs-keyword">var</span> iframe = <span class="hljs-keyword">this</span>.options.iframe ? <span class="hljs-keyword">this</span>.getIFrameElement() : <span class="hljs-literal">null</span>;
        w = <span class="hljs-built_in">Math</span>.max(w, <span class="hljs-keyword">this</span>.options.minWidth);
        <span class="hljs-keyword">var</span> wrapperWidth = w;
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.QUIRKS_MODE || (<span class="hljs-keyword">this</span>.QUIRKS_MODE &amp;&amp; !Prototype.Browser.IE))
            wrapperWidth -= (boxBorder + wrapperBorder);
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.QUIRKS_MODE || (<span class="hljs-keyword">this</span>.QUIRKS_MODE &amp;&amp; !Prototype.Browser.IE))
            wrapperWidth -= wrapper.measure(<span class="hljs-string">'padding-left'</span>) + wrapper.measure(<span class="hljs-string">'padding-right'</span>);
        <span class="hljs-keyword">var</span> ww = wrapperWidth;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.QUIRKS_MODE &amp;&amp; Prototype.Browser.IE)
            ww += wrapperBorder + wrapper.measure(<span class="hljs-string">'padding-left'</span>) + wrapper.measure(<span class="hljs-string">'padding-right'</span>);
        <span class="hljs-keyword">var</span> boxSizing = wrapper.getStyle(<span class="hljs-string">'box-sizing'</span>);
        <span class="hljs-keyword">var</span> bsw = ww;
        <span class="hljs-keyword">if</span> (boxSizing == <span class="hljs-string">'border-box'</span>) {
            bsw += wrapperBorder + wrapper.measure(<span class="hljs-string">'padding-left'</span>) + wrapper.measure(<span class="hljs-string">'padding-right'</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (boxSizing == <span class="hljs-string">'padding-box'</span>) {
            bsw += wrapper.measure(<span class="hljs-string">'padding-left'</span>) + wrapper.measure(<span class="hljs-string">'padding-right'</span>);
        }
        wrapper.setStyle({
            <span class="hljs-attr">width</span>: bsw + <span class="hljs-string">'px'</span>
        });
        body.setStyle({
            <span class="hljs-attr">width</span>: ww + <span class="hljs-string">'px'</span>
        });
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.QUIRKS_MODE || (<span class="hljs-keyword">this</span>.QUIRKS_MODE &amp;&amp; !Prototype.Browser.IE))
            w = w - boxBorder;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.QUIRKS_MODE &amp;&amp; Prototype.Browser.IE) {
            w = ww - (wrapperBorder + wrapper.measure(<span class="hljs-string">'padding-left'</span>) + wrapper.measure(<span class="hljs-string">'padding-right'</span>));
            body.setStyle({
                <span class="hljs-attr">width</span>: w + <span class="hljs-string">'px'</span>
            });
        }
        box.setStyle({
            <span class="hljs-attr">width</span>: w + <span class="hljs-string">'px'</span>
        });
        <span class="hljs-keyword">if</span> (iframe) {
            <span class="hljs-keyword">var</span> iframeWrap2 = iframe.up();
            <span class="hljs-keyword">var</span> iframeContainer = iframeWrap2.up();
            <span class="hljs-keyword">var</span> iframeWidth = (wrapperWidth -
                iframeWrap2.measure(<span class="hljs-string">'border-left'</span>) - iframeWrap2.measure(<span class="hljs-string">'border-right'</span>) -
                iframeContainer.measure(<span class="hljs-string">'border-left'</span>) - iframeContainer.measure(<span class="hljs-string">'border-right'</span>));
            iframe.writeAttribute(<span class="hljs-string">'width'</span>, iframeWidth);
        }
        <span class="hljs-keyword">var</span> table = box.select(<span class="hljs-string">'.gb_table'</span>)[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">var</span> tw = table.getWidth();
        <span class="hljs-keyword">var</span> realWrapperWidth = wrapper.getWidth();
        <span class="hljs-keyword">if</span> (realWrapperWidth &lt; tw) {
            <span class="hljs-keyword">var</span> bodyPadding = wrapper.measure(<span class="hljs-string">'padding-left'</span>) + wrapper.measure(<span class="hljs-string">'padding-right'</span>);
            <span class="hljs-keyword">var</span> nw = tw - bodyPadding;
            wrapper.setStyle({
                <span class="hljs-attr">width</span>: nw + <span class="hljs-string">'px'</span>
            });
            box.setStyle({
                <span class="hljs-attr">width</span>: (w + (tw - realWrapperWidth)) + <span class="hljs-string">'px'</span>
            });
            <span class="hljs-keyword">if</span> (iframe)
                iframe.writeAttribute(<span class="hljs-string">'width'</span>, nw);
        }
        <span class="hljs-keyword">this</span>.options.onWidthAdjust.call(<span class="hljs-keyword">this</span>);
    },
    <span class="hljs-attr">setMinWidth</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">mw</span>) </span>{
        <span class="hljs-keyword">this</span>.options.minWidth = <span class="hljs-keyword">typeof</span> mw == <span class="hljs-string">'string'</span> ? <span class="hljs-built_in">parseInt</span>(mw, <span class="hljs-number">10</span>) : mw;
    },
    <span class="hljs-attr">setHeight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">h, clone</span>) </span>{
        h = <span class="hljs-keyword">typeof</span> h == <span class="hljs-string">'string'</span> ? <span class="hljs-built_in">parseInt</span>(h, <span class="hljs-number">10</span>) : h;
        <span class="hljs-keyword">var</span> box = clone || <span class="hljs-keyword">this</span>._box;
        <span class="hljs-keyword">var</span> gbWrapper = box.select(<span class="hljs-string">'.gb_wrapper'</span>)[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">var</span> boxBorder = box.measure(<span class="hljs-string">'border-top'</span>) + box.measure(<span class="hljs-string">'border-bottom'</span>);
        <span class="hljs-keyword">var</span> wrapperBorder = gbWrapper.measure(<span class="hljs-string">'border-top'</span>) + gbWrapper.measure(<span class="hljs-string">'border-bottom'</span>);
        <span class="hljs-keyword">var</span> bodyWrapper = box.select(<span class="hljs-string">'.gb_body_wrapper'</span>)[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">var</span> body = box.select(<span class="hljs-string">'.gb_body'</span>)[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">var</span> iframe = <span class="hljs-keyword">this</span>.options.iframe ? <span class="hljs-keyword">this</span>.getIFrameElement() : <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">var</span> table = box.select(<span class="hljs-string">'.gb_table'</span>)[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.minHeight)
            h = <span class="hljs-built_in">Math</span>.max(h, <span class="hljs-keyword">this</span>.options.minHeight);
        <span class="hljs-keyword">if</span> (iframe)
            <span class="hljs-keyword">var</span> wrapperHeight = h - (box.getHeight() - <span class="hljs-built_in">Math</span>.max(body.getHeight(), <span class="hljs-built_in">parseInt</span>(body.getStyle(<span class="hljs-string">'height'</span>), <span class="hljs-number">10</span>)));
        <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">var</span> wrapperHeight = h - wrapperBorder - boxBorder - table.select(<span class="hljs-string">'thead'</span>)[<span class="hljs-number">0</span>].getHeight() - table.select(<span class="hljs-string">'tfoot &gt; tr'</span>)[<span class="hljs-number">0</span>].getHeight();
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.QUIRKS_MODE || (<span class="hljs-keyword">this</span>.QUIRKS_MODE &amp;&amp; !Prototype.Browser.IE))
                wrapperHeight -= bodyWrapper.measure(<span class="hljs-string">'padding-top'</span>) + bodyWrapper.measure(<span class="hljs-string">'padding-bottom'</span>);
        }
        wrapperHeight = <span class="hljs-built_in">Math</span>.max(wrapperHeight, <span class="hljs-number">0</span>);
        wh = wrapperHeight;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.QUIRKS_MODE &amp;&amp; Prototype.Browser.IE)
            wh += wrapperBorder + bodyWrapper.measure(<span class="hljs-string">'padding-top'</span>) + bodyWrapper.measure(<span class="hljs-string">'padding-bottom'</span>);
        <span class="hljs-keyword">var</span> boxSizing = bodyWrapper.getStyle(<span class="hljs-string">'box-sizing'</span>);
        <span class="hljs-keyword">if</span> (boxSizing == <span class="hljs-string">'border-box'</span>) {
            wh += wrapperBorder + bodyWrapper.measure(<span class="hljs-string">'padding-top'</span>) + bodyWrapper.measure(<span class="hljs-string">'padding-bottom'</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (boxSizing == <span class="hljs-string">'padding-box'</span>) {
            wh += bodyWrapper.measure(<span class="hljs-string">'padding-top'</span>) + bodyWrapper.measure(<span class="hljs-string">'padding-bottom'</span>);
        }
        <span class="hljs-keyword">this</span>.getBodyWrapperElement().setStyle({
            <span class="hljs-attr">height</span>: wh + <span class="hljs-string">'px'</span>
        });
        <span class="hljs-keyword">if</span> (iframe) {
            <span class="hljs-keyword">var</span> iframeWrap2 = iframe.up();
            <span class="hljs-keyword">var</span> iframeContainer = iframeWrap2.up();
            <span class="hljs-keyword">var</span> iframeHeight = (wrapperHeight -
                iframeWrap2.measure(<span class="hljs-string">'border-top'</span>) - iframeWrap2.measure(<span class="hljs-string">'border-bottom'</span>) -
                iframeContainer.measure(<span class="hljs-string">'border-top'</span>) - iframeContainer.measure(<span class="hljs-string">'border-bottom'</span>));
            iframe.writeAttribute(<span class="hljs-string">'height'</span>, iframeHeight);
        }
        h = h - boxBorder;
        <span class="hljs-keyword">this</span>._box.setStyle({
            <span class="hljs-attr">height</span>: h + <span class="hljs-string">'px'</span>
        });
        <span class="hljs-keyword">this</span>.options.onHeightAdjust.call(<span class="hljs-keyword">this</span>);
    },
    <span class="hljs-attr">setMinHeight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">mh</span>) </span>{
        <span class="hljs-keyword">this</span>.options.minHeight = <span class="hljs-keyword">typeof</span> mh == <span class="hljs-string">'string'</span> ? <span class="hljs-built_in">parseInt</span>(mh, <span class="hljs-number">10</span>) : mh;
        <span class="hljs-keyword">this</span>._box.setStyle({
            <span class="hljs-attr">minHeight</span>: <span class="hljs-keyword">this</span>.options.minHeight + <span class="hljs-string">'px'</span>
        });
    },
    <span class="hljs-attr">getMaxPositions</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.parent == <span class="hljs-built_in">document</span>.body) {
            <span class="hljs-keyword">var</span> winDimensions = <span class="hljs-keyword">this</span>._getViewportDimensions();
            <span class="hljs-keyword">var</span> parent = {
                <span class="hljs-attr">width</span>: winDimensions.width,
                <span class="hljs-attr">height</span>: winDimensions.height
            };
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">var</span> parent = {
                <span class="hljs-attr">width</span>: <span class="hljs-keyword">this</span>.options.parent.getWidth(),
                <span class="hljs-attr">height</span>: <span class="hljs-keyword">this</span>.options.parent.getHeight()
            };
        }
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">minTop</span>: <span class="hljs-keyword">this</span>.options.padding.top,
            <span class="hljs-attr">minLeft</span>: <span class="hljs-keyword">this</span>.options.padding.left,
            <span class="hljs-attr">maxTop</span>: parent.height - <span class="hljs-keyword">this</span>.getHeight() - <span class="hljs-keyword">this</span>.options.padding.bottom,
            <span class="hljs-attr">maxLeft</span>: parent.width - <span class="hljs-keyword">this</span>.getWidth() - <span class="hljs-keyword">this</span>.options.padding.right
        };
    },
    <span class="hljs-attr">autoPosition</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">this</span>.options.left !== <span class="hljs-literal">null</span> || <span class="hljs-keyword">this</span>.options.right !== <span class="hljs-literal">null</span>) &amp;&amp;
            (<span class="hljs-keyword">this</span>.options.top !== <span class="hljs-literal">null</span> || <span class="hljs-keyword">this</span>.options.bottom !== <span class="hljs-literal">null</span>)) {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.left !== <span class="hljs-literal">null</span>)
                <span class="hljs-keyword">this</span>.positionLeft(<span class="hljs-keyword">this</span>.options.left);
            <span class="hljs-keyword">else</span>
                <span class="hljs-keyword">this</span>.positionRight(<span class="hljs-keyword">this</span>.options.right);
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.top !== <span class="hljs-literal">null</span>)
                <span class="hljs-keyword">this</span>.positionTop(<span class="hljs-keyword">this</span>.options.top);
            <span class="hljs-keyword">else</span>
                <span class="hljs-keyword">this</span>.positionBottom(<span class="hljs-keyword">this</span>.options.bottom);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.parent == <span class="hljs-built_in">document</span>.body) {
                <span class="hljs-keyword">var</span> winScrollOffsets = <span class="hljs-built_in">document</span>.viewport.getScrollOffsets();
                <span class="hljs-keyword">var</span> winDimensions = <span class="hljs-keyword">this</span>._getViewportDimensions();
                <span class="hljs-keyword">var</span> height = winDimensions.height;
                <span class="hljs-keyword">var</span> width = winDimensions.width;
                <span class="hljs-keyword">var</span> offset = <span class="hljs-keyword">this</span>.getStyle(<span class="hljs-string">'position'</span>) == <span class="hljs-string">'absolute'</span> ? {
                    <span class="hljs-attr">left</span>: winScrollOffsets.left,
                    <span class="hljs-attr">top</span>: winScrollOffsets.top
                } : {
                    <span class="hljs-attr">left</span>: <span class="hljs-number">0</span>,
                    <span class="hljs-attr">top</span>: <span class="hljs-number">0</span>
                };
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">var</span> height = <span class="hljs-keyword">this</span>.options.parent.getHeight();
                <span class="hljs-keyword">var</span> width = <span class="hljs-keyword">this</span>.options.parent.getWidth();
                <span class="hljs-keyword">var</span> offset = {
                    <span class="hljs-attr">left</span>: <span class="hljs-number">0</span>,
                    <span class="hljs-attr">top</span>: <span class="hljs-number">0</span>
                };
            }
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.left !== <span class="hljs-literal">null</span>)
                <span class="hljs-keyword">this</span>.positionLeft(<span class="hljs-keyword">this</span>.options.left);
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.right !== <span class="hljs-literal">null</span>)
                <span class="hljs-keyword">this</span>.positionRight(<span class="hljs-keyword">this</span>.options.right);
            <span class="hljs-keyword">else</span>
                <span class="hljs-keyword">this</span>.positionLeft(width / <span class="hljs-number">2</span> - <span class="hljs-keyword">this</span>.getWidth() / <span class="hljs-number">2</span> + offset.left)
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.top !== <span class="hljs-literal">null</span>)
                <span class="hljs-keyword">this</span>.positionTop(<span class="hljs-keyword">this</span>.options.top);
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.bottom !== <span class="hljs-literal">null</span>)
                <span class="hljs-keyword">this</span>.positionBottom(<span class="hljs-keyword">this</span>.options.bottom);
            <span class="hljs-keyword">else</span>
                <span class="hljs-keyword">this</span>.positionTop(height / <span class="hljs-number">2</span> - <span class="hljs-keyword">this</span>.getHeight() / <span class="hljs-number">2</span> + offset.top);
        }
    },
    <span class="hljs-attr">center</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.parent == <span class="hljs-built_in">document</span>.body) {
            <span class="hljs-keyword">var</span> offsets = <span class="hljs-built_in">document</span>.viewport.getScrollOffsets();
            <span class="hljs-keyword">var</span> winDimensions = <span class="hljs-keyword">this</span>._getViewportDimensions();
            <span class="hljs-keyword">var</span> height = winDimensions.height;
            <span class="hljs-keyword">var</span> width = winDimensions.width;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">var</span> height = <span class="hljs-keyword">this</span>.options.parent.getHeight();
            <span class="hljs-keyword">var</span> width = <span class="hljs-keyword">this</span>.options.parent.getWidth();
            <span class="hljs-keyword">var</span> offsets = {
                <span class="hljs-attr">left</span>: <span class="hljs-number">0</span>,
                <span class="hljs-attr">top</span>: <span class="hljs-number">0</span>
            };
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.getStyle(<span class="hljs-string">'position'</span>) == <span class="hljs-string">'absolute'</span>) {
            <span class="hljs-keyword">this</span>.positionLeft(width / <span class="hljs-number">2</span> - <span class="hljs-keyword">this</span>.getWidth() / <span class="hljs-number">2</span> + offsets.left);
            <span class="hljs-keyword">this</span>.positionTop(height / <span class="hljs-number">2</span> - <span class="hljs-keyword">this</span>.getHeight() / <span class="hljs-number">2</span> + offsets.top);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">this</span>.positionLeft(width / <span class="hljs-number">2</span> - <span class="hljs-keyword">this</span>.getWidth() / <span class="hljs-number">2</span>);
            <span class="hljs-keyword">this</span>.positionTop(height / <span class="hljs-number">2</span> - <span class="hljs-keyword">this</span>.getHeight() / <span class="hljs-number">2</span>);
        }
    },
    <span class="hljs-attr">setMaxTop</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">p</span>) </span>{
        <span class="hljs-keyword">this</span>.options.maxTop = p;
    },
    <span class="hljs-attr">setMinBottom</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">p</span>) </span>{
        <span class="hljs-keyword">this</span>.options.minBottom = p;
    },
    <span class="hljs-attr">positionTop</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">top</span>) </span>{
        <span class="hljs-keyword">if</span> (top === <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">return</span>;
        top = <span class="hljs-built_in">parseInt</span>(top, <span class="hljs-number">10</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.maxTop)
            top = <span class="hljs-built_in">Math</span>.min(top, <span class="hljs-keyword">this</span>.options.maxTop);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.minBottom) {
            <span class="hljs-keyword">var</span> h = <span class="hljs-keyword">this</span>.getHeight();
            <span class="hljs-keyword">if</span> (top + h &lt; <span class="hljs-keyword">this</span>.options.minBottom)
                top = <span class="hljs-keyword">this</span>.options.minBottom - h;
        }
        <span class="hljs-keyword">this</span>.setStyle({
            <span class="hljs-attr">top</span>: top + <span class="hljs-string">'px'</span>
        });
    },
    <span class="hljs-attr">positionLeft</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">left</span>) </span>{
        <span class="hljs-keyword">if</span> (!left)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">this</span>.setStyle({
            <span class="hljs-attr">left</span>: left + <span class="hljs-string">'px'</span>,
            <span class="hljs-attr">right</span>: <span class="hljs-string">''</span>
        });
    },
    <span class="hljs-attr">positionRight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">right</span>) </span>{
        <span class="hljs-keyword">if</span> (right === <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">this</span>.setStyle({
            <span class="hljs-attr">right</span>: right + <span class="hljs-string">'px'</span>,
            <span class="hljs-attr">left</span>: <span class="hljs-string">''</span>
        });
    },
    <span class="hljs-attr">positionBottom</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bottom</span>) </span>{
        <span class="hljs-keyword">if</span> (bottom === <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">return</span>;
        bottom = <span class="hljs-built_in">parseInt</span>(bottom, <span class="hljs-number">10</span>);
        <span class="hljs-keyword">this</span>.setStyle({
            <span class="hljs-attr">bottom</span>: bottom + <span class="hljs-string">'px'</span>,
            <span class="hljs-attr">top</span>: <span class="hljs-string">''</span>
        });
    },
    <span class="hljs-attr">convertToLeftPosition</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._box.style.right)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">this</span>.setStyle({
            <span class="hljs-attr">right</span>: <span class="hljs-string">''</span>,
            <span class="hljs-attr">left</span>: (<span class="hljs-keyword">this</span>.getOffset().left - (<span class="hljs-keyword">this</span>.getStyle(<span class="hljs-string">'position'</span>) == <span class="hljs-string">'fixed'</span> ? <span class="hljs-built_in">document</span>.viewport.getScrollOffsets().left : <span class="hljs-number">0</span>)) + <span class="hljs-string">'px'</span>
        });
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    },
    <span class="hljs-attr">convertToRightPosition</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> l = <span class="hljs-keyword">this</span>._box.style.left;
        <span class="hljs-keyword">if</span> (!l)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">this</span>.setStyle({
            <span class="hljs-attr">left</span>: <span class="hljs-string">''</span>,
            <span class="hljs-attr">right</span>: (<span class="hljs-keyword">this</span>._getViewportDimensions().width - <span class="hljs-built_in">parseInt</span>(l, <span class="hljs-number">10</span>) - <span class="hljs-keyword">this</span>.getWidth()) + <span class="hljs-string">'px'</span>
        });
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    },
    <span class="hljs-attr">setStyle</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">o, value</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> o == <span class="hljs-string">'string'</span>)
            o = {
                <span class="hljs-attr">o</span>: value
            };
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> o != <span class="hljs-string">'object'</span>)
            o = {};
        <span class="hljs-keyword">this</span>._box.setStyle(o);
    },
    <span class="hljs-attr">getWidth</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._box.getWidth();
    },
    <span class="hljs-attr">getHeight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._box.getHeight();
    },
    <span class="hljs-attr">getStyle</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._box.getStyle(s);
    },
    <span class="hljs-attr">getOffset</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._box.cumulativeOffset();
    },
    <span class="hljs-attr">getBodyElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._box.select(<span class="hljs-string">'.gb_body'</span>)[<span class="hljs-number">0</span>];
    },
    <span class="hljs-attr">getBodyWrapperElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._box.select(<span class="hljs-string">'.gb_body_wrapper'</span>)[<span class="hljs-number">0</span>];
    },
    <span class="hljs-attr">setBody</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">html</span>) </span>{
        <span class="hljs-keyword">this</span>.getBodyElement().innerHTML = html;
    },
    <span class="hljs-attr">setBodyFromForm</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">template</span>) </span>{
        <span class="hljs-keyword">this</span>.options.form = template;
    },
    <span class="hljs-attr">setBodyPadding</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">pad</span>) </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.options.iframe)
            <span class="hljs-keyword">this</span>.getBodyWrapperElement().setStyle({
                <span class="hljs-attr">padding</span>: pad + (<span class="hljs-built_in">isNaN</span>(pad) ? <span class="hljs-string">''</span> : <span class="hljs-string">'px'</span>)
            });
    },
    <span class="hljs-attr">_getViewportDimensions</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.QUIRKS_MODE || !Prototype.Browser.IE)
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.viewport.getDimensions();
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">height</span>: getBrowserWindowHeight(),
            <span class="hljs-attr">width</span>: getBrowserWindowWidth()
        };
    },
    <span class="hljs-attr">setDraggable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
        <span class="hljs-keyword">if</span> (b) {
            <span class="hljs-keyword">this</span>.toolbarDragger = <span class="hljs-keyword">new</span> GlideDraggable(<span class="hljs-keyword">this</span>.getToolbar(), <span class="hljs-keyword">this</span>._box);
            <span class="hljs-keyword">this</span>.toolbarDragger.setHoverCursor(<span class="hljs-string">'move'</span>);
            <span class="hljs-keyword">this</span>.toolbarDragger.setStartFunction(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e, dragElem, pageCoords, shift, dragCoords</span>) </span>{
                <span class="hljs-keyword">this</span>._tmpDim = <span class="hljs-keyword">this</span>.getMaxPositions();
                <span class="hljs-keyword">this</span>.options.onBeforeDrag.call(<span class="hljs-keyword">this</span>, e, dragElem, pageCoords, shift, dragCoords);
            }.bind(<span class="hljs-keyword">this</span>));
            <span class="hljs-keyword">this</span>.toolbarDragger.setDragFunction(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e, dragElem, pageCoords, shift, dragCoords</span>) </span>{
                dragElem.style.left = <span class="hljs-built_in">Math</span>.min(<span class="hljs-built_in">Math</span>.max(<span class="hljs-keyword">this</span>._tmpDim.minLeft, dragCoords.x), <span class="hljs-keyword">this</span>._tmpDim.maxLeft) + <span class="hljs-string">'px'</span>;
                dragElem.style.top = <span class="hljs-built_in">Math</span>.min(<span class="hljs-built_in">Math</span>.max(<span class="hljs-keyword">this</span>._tmpDim.minTop, dragCoords.y), <span class="hljs-keyword">this</span>._tmpDim.maxTop) + <span class="hljs-string">'px'</span>;
            }.bind(<span class="hljs-keyword">this</span>));
            <span class="hljs-keyword">this</span>.toolbarDragger.setEndFunction(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e, dragElem, pageCoords, shift, dragCoords</span>) </span>{
                <span class="hljs-keyword">this</span>.options.onAfterDrag.call(<span class="hljs-keyword">this</span>, e, dragElem, pageCoords, shift, dragCoords);
            }.bind(<span class="hljs-keyword">this</span>));
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.toolbarDragger) {
            <span class="hljs-keyword">this</span>.toolbarDragger.destroy();
            <span class="hljs-keyword">this</span>.toolbarDragger = <span class="hljs-literal">null</span>;
        }
    },
    <span class="hljs-attr">isDraggable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.toolbarDragger ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>;
    },
    <span class="hljs-attr">setPreferences</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">preferences</span>) </span>{
        <span class="hljs-keyword">this</span>.options.preferences = preferences;
    },
    <span class="hljs-attr">setPreference</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, value</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(value) == <span class="hljs-string">'string'</span>)
            value = value.replace(<span class="hljs-regexp">/&lt;/g</span>, <span class="hljs-string">"&amp;lt;"</span>).replace(<span class="hljs-regexp">/&gt;/g</span>, <span class="hljs-string">"&amp;gt;"</span>);
        <span class="hljs-keyword">this</span>.options.preferences[name] = value;
    },
    <span class="hljs-attr">getPreferences</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.options.preferences;
    },
    <span class="hljs-attr">removePreference</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, value</span>) </span>{
        <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.options.preferences[name];
    },
    <span class="hljs-attr">getDescribingXML</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> section = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'section'</span>);
        section.setAttribute(<span class="hljs-string">'name'</span>, <span class="hljs-keyword">this</span>.getId());
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> name <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>.options.preferences) {
            <span class="hljs-keyword">var</span> p = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'preference'</span>);
            <span class="hljs-keyword">var</span> v = <span class="hljs-keyword">this</span>.options.preferences[name];
            p.setAttribute(<span class="hljs-string">'name'</span>, name);
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> v == <span class="hljs-string">'object'</span>) {
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> v.join == <span class="hljs-string">'function'</span>) {
                    v = v.join(<span class="hljs-string">','</span>);
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> v.toString == <span class="hljs-string">'function'</span>) {
                    v = v.toString();
                }
            }
            <span class="hljs-keyword">if</span> (v)
                p.setAttribute(<span class="hljs-string">'value'</span>, v);
            section.appendChild(p);
        }
        <span class="hljs-keyword">return</span> section;
    },
    <span class="hljs-attr">getDescribingText</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> gxml = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"gxml"</span>);
        <span class="hljs-keyword">var</span> x = <span class="hljs-keyword">this</span>.getDescribingXML();
        gxml.appendChild(x);
        <span class="hljs-keyword">return</span> gxml.innerHTML;
    },
    <span class="hljs-attr">hide</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fadeOutTime</span>) </span>{
        <span class="hljs-keyword">this</span>.options.onBeforeHide.call(<span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">this</span>._removeIFrameShim();
        fadeOutTime = fadeOutTime || fadeOutTime === <span class="hljs-number">0</span> ? fadeOutTime : <span class="hljs-keyword">this</span>.options.fadeOutTime
        <span class="hljs-keyword">if</span> (fadeOutTime !== <span class="hljs-number">0</span>)
            <span class="hljs-keyword">this</span>.getBoxElement().fadeOut(fadeOutTime, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">this</span>.options.onAfterHide.call(<span class="hljs-keyword">this</span>);
            }.bind(<span class="hljs-keyword">this</span>));
        <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">this</span>.getBoxElement().hide();
            <span class="hljs-keyword">this</span>.options.onAfterHide.call(<span class="hljs-keyword">this</span>);
        }
    },
    <span class="hljs-attr">show</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fadeInTime</span>) </span>{
        <span class="hljs-keyword">this</span>.options.onBeforeShow.call(<span class="hljs-keyword">this</span>);
        fadeInTime = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._iframeNeedsAutoDimension === <span class="hljs-literal">true</span>) {
            <span class="hljs-keyword">this</span>._box.setStyle({
                <span class="hljs-attr">opacity</span>: <span class="hljs-string">'0'</span>,
                <span class="hljs-attr">filter</span>: <span class="hljs-string">'alpha(opacity=0)'</span>,
                <span class="hljs-attr">visibility</span>: <span class="hljs-string">'hidden'</span>,
                <span class="hljs-attr">display</span>: <span class="hljs-string">'block'</span>
            });
            <span class="hljs-keyword">this</span>.autoDimension();
            <span class="hljs-keyword">this</span>.autoPosition();
            <span class="hljs-keyword">this</span>._box.setStyle({
                <span class="hljs-attr">opacity</span>: <span class="hljs-string">''</span>,
                <span class="hljs-attr">filter</span>: <span class="hljs-string">''</span>,
                <span class="hljs-attr">visibility</span>: <span class="hljs-string">''</span>,
                <span class="hljs-attr">display</span>: <span class="hljs-string">'none'</span>
            });
        }
        <span class="hljs-keyword">if</span> (fadeInTime !== <span class="hljs-number">0</span>)
            <span class="hljs-keyword">this</span>.getBoxElement().fadeIn(fadeInTime, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">this</span>.options.onAfterShow.call(<span class="hljs-keyword">this</span>);
            }.bind(<span class="hljs-keyword">this</span>));
        <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">this</span>.getBoxElement().show();
            <span class="hljs-keyword">this</span>.options.onAfterShow.call(<span class="hljs-keyword">this</span>);
        }
        <span class="hljs-keyword">this</span>._iframeNeedsAutoDimension = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">this</span>._createIframeShim();
    },
    <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
        options = <span class="hljs-built_in">Object</span>.extend({
            <span class="hljs-attr">autoDimensionOnPreLoad</span>: <span class="hljs-keyword">this</span>.options.autoDimensionOnPreLoad,
            <span class="hljs-attr">autoDimensionOnLoad</span>: <span class="hljs-keyword">this</span>.options.autoDimensionOnLoad,
            <span class="hljs-attr">autoPositionOnLoad</span>: <span class="hljs-keyword">this</span>.options.autoPositionOnLoad,
            <span class="hljs-attr">fadeInTime</span>: <span class="hljs-number">0</span>
        }, options || {});
        <span class="hljs-keyword">this</span>._isClosing = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">var</span> bw = <span class="hljs-keyword">this</span>.getBodyWrapperElement();
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.getToolbar().visible())
            bw.addClassName(<span class="hljs-string">'no_toolbar'</span>);
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.getFooter().visible())
            bw.addClassName(<span class="hljs-string">'no_footer'</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.form)
            <span class="hljs-keyword">this</span>._renderForm(options);
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.iframe)
            <span class="hljs-keyword">this</span>._renderIFrame(options);
        <span class="hljs-keyword">else</span>
            <span class="hljs-keyword">this</span>._renderStatic(options);
    },
    <span class="hljs-attr">_renderStatic</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">opts</span>) </span>{
        <span class="hljs-keyword">this</span>.options.onBeforeLoad.call(<span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">if</span> (opts.autoDimensionOnLoad)
            <span class="hljs-keyword">this</span>.autoDimension();
        <span class="hljs-keyword">if</span> (opts.autoPositionOnLoad)
            <span class="hljs-keyword">this</span>.autoPosition();
        <span class="hljs-keyword">if</span> (opts.fadeInTime !== <span class="hljs-number">0</span>)
            <span class="hljs-keyword">this</span>._box.fadeIn(opts.fadeInTime);
        <span class="hljs-keyword">else</span>
            <span class="hljs-keyword">this</span>._box.style.display = <span class="hljs-string">'block'</span>;
        <span class="hljs-keyword">this</span>.options.onAfterShow.call(<span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">this</span>.options.onAfterLoad.call(<span class="hljs-keyword">this</span>);
    },
    <span class="hljs-attr">_renderForm</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">opts</span>) </span>{
        <span class="hljs-keyword">this</span>._isLoading = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">this</span>.options.onBeforeLoad.call(<span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">this</span>.setBody(gb_LoadingBody);
        <span class="hljs-keyword">this</span>._box.addClassName(<span class="hljs-string">'form'</span>);
        <span class="hljs-keyword">this</span>._box.setStyle({
            <span class="hljs-attr">display</span>: <span class="hljs-string">'block'</span>
        });
        <span class="hljs-keyword">if</span> (opts.autoDimensionOnPreLoad) {
            <span class="hljs-keyword">this</span>.autoDimension();
            <span class="hljs-keyword">this</span>.center();
        }
        <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'renderer'</span>, <span class="hljs-string">'RenderForm'</span>);
        <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'type'</span>, <span class="hljs-string">'direct'</span>);
        <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'table'</span>, <span class="hljs-keyword">this</span>.options.form);
        <span class="hljs-keyword">var</span> ga = <span class="hljs-keyword">new</span> GlideAjaxForm(<span class="hljs-keyword">this</span>.options.form);
        ga.addParam(<span class="hljs-string">'sysparm_value'</span>, <span class="hljs-keyword">this</span>.getDescribingText());
        ga.addParam(<span class="hljs-string">'sysparm_name'</span>, <span class="hljs-keyword">this</span>.options.form);
        ga.getRenderedBodyText(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">this</span>.setBody(s);
            s.evalScripts(<span class="hljs-literal">true</span>);
            <span class="hljs-keyword">this</span>._isLoading = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">this</span>.options.onAfterShow.call(<span class="hljs-keyword">this</span>);
            <span class="hljs-keyword">this</span>.options.onAfterLoad.call(<span class="hljs-keyword">this</span>);
            <span class="hljs-keyword">if</span> (opts.autoDimensionOnLoad)
                <span class="hljs-keyword">this</span>.autoDimension();
            <span class="hljs-keyword">if</span> (opts.autoPositionOnLoad)
                <span class="hljs-keyword">this</span>.autoPosition();
        }.bind(<span class="hljs-keyword">this</span>));
    },
    <span class="hljs-attr">_renderIFrame</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">opts</span>) </span>{
        <span class="hljs-keyword">this</span>._isLoading = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">this</span>.setBody(gb_BoxIFrameBody);
        <span class="hljs-keyword">this</span>._box.setStyle({
            <span class="hljs-attr">display</span>: <span class="hljs-string">'block'</span>
        });
        <span class="hljs-keyword">if</span> (opts.autoDimensionOnPreLoad)
            <span class="hljs-keyword">this</span>.autoDimension();
        <span class="hljs-keyword">this</span>.autoPosition();
        <span class="hljs-keyword">if</span> (opts.autoDimensionOnLoad !== <span class="hljs-literal">true</span>) {
            <span class="hljs-keyword">var</span> tmpIFrame = <span class="hljs-keyword">this</span>.getIFrameElement();
            <span class="hljs-keyword">if</span> (tmpIFrame) {
                <span class="hljs-keyword">var</span> oldHeight = tmpIFrame.readAttribute(<span class="hljs-string">'height'</span>);
                <span class="hljs-keyword">var</span> oldWidth = tmpIFrame.readAttribute(<span class="hljs-string">'width'</span>);
            }
        }
        <span class="hljs-keyword">var</span> loading = <span class="hljs-keyword">this</span>._box.select(<span class="hljs-string">'.gb_loading'</span>)[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">var</span> wrapper = loading.up(<span class="hljs-string">'.gb_body_wrapper'</span>);
        loading.setStyle({
            <span class="hljs-attr">height</span>: (wrapper.measure(<span class="hljs-string">'height'</span>) - loading.measure(<span class="hljs-string">'padding-top'</span>) - loading.measure(<span class="hljs-string">'padding-bottom'</span>) - <span class="hljs-number">4</span>) + <span class="hljs-string">'px'</span>
        });
        loading.up(<span class="hljs-string">'.loading_wrap_outer'</span>).setStyle({
            <span class="hljs-attr">width</span>: (wrapper.measure(<span class="hljs-string">'width'</span>) - <span class="hljs-number">2</span>) + <span class="hljs-string">'px'</span>
        });
        <span class="hljs-keyword">var</span> f = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> iframe = <span class="hljs-keyword">this</span>.getIFrameElement();
            iframe.stopObserving(<span class="hljs-string">'load'</span>, f);
            iframe.up().up().show().previous().remove();
            <span class="hljs-keyword">this</span>._isLoading = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">if</span> (opts.autoDimensionOnLoad || (!opts.autoDimensionOnLoad &amp;&amp; !oldHeight &amp;&amp; !oldWidth)) {
                <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isVisible())
                    <span class="hljs-keyword">this</span>._iframeNeedsAutoDimension = <span class="hljs-literal">true</span>;
                <span class="hljs-keyword">else</span>
                    <span class="hljs-keyword">this</span>.autoDimension();
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (oldHeight &amp;&amp; oldWidth) {
                iframe.writeAttribute(<span class="hljs-string">'height'</span>, oldHeight);
                iframe.writeAttribute(<span class="hljs-string">'width'</span>, oldWidth);
            }
            <span class="hljs-keyword">this</span>.autoPosition();
            <span class="hljs-keyword">this</span>._createIframeShim();
            <span class="hljs-keyword">this</span>.options.onAfterShow.call(<span class="hljs-keyword">this</span>);
            <span class="hljs-keyword">this</span>.options.onAfterLoad.call(<span class="hljs-keyword">this</span>);
        }.bind(<span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">var</span> iframe = <span class="hljs-keyword">this</span>.getIFrameElement();
        iframe.id = <span class="hljs-keyword">this</span>.options.iframeId || guid();
        iframe.observe(<span class="hljs-string">'load'</span>, f);
        <span class="hljs-keyword">this</span>.options.onBeforeLoad.call(<span class="hljs-keyword">this</span>);
        iframe.src = <span class="hljs-keyword">this</span>.options.iframe;
    },
    <span class="hljs-attr">_createIframeShim</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.options.iframe || !isMSIE6 || <span class="hljs-keyword">this</span>._iframeShim)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">var</span> box = <span class="hljs-keyword">this</span>.getBoxElement();
        <span class="hljs-keyword">this</span>._iframeShim = $(<span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'iframe'</span>));
        <span class="hljs-keyword">this</span>._iframeShim.setStyle({
            <span class="hljs-attr">top</span>: box.getStyle(<span class="hljs-string">'top'</span>),
            <span class="hljs-attr">left</span>: box.getStyle(<span class="hljs-string">'left'</span>),
            <span class="hljs-attr">height</span>: box.getHeight() + <span class="hljs-string">'px'</span>,
            <span class="hljs-attr">width</span>: box.getWidth() + <span class="hljs-string">'px'</span>,
            <span class="hljs-attr">position</span>: <span class="hljs-string">'absolute'</span>,
            <span class="hljs-attr">zIndex</span>: <span class="hljs-string">'10'</span>,
            <span class="hljs-attr">filter</span>: <span class="hljs-string">'alpha(opacity=0)'</span>,
            <span class="hljs-attr">opacity</span>: <span class="hljs-number">0</span>
        });
        <span class="hljs-keyword">this</span>._iframeShim.src = <span class="hljs-string">'javascript:"&lt;html&gt;&lt;/html&gt;"'</span>;
        <span class="hljs-built_in">document</span>.body.appendChild(<span class="hljs-keyword">this</span>._iframeShim);
    },
    <span class="hljs-attr">_resizeIframeShim</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">Object</span>.isElement(<span class="hljs-keyword">this</span>._iframeShim))
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">var</span> box = <span class="hljs-keyword">this</span>.getBoxElement();
        <span class="hljs-keyword">this</span>._iframeShim.setStyle({
            <span class="hljs-attr">width</span>: box.getWidth() + <span class="hljs-string">'px'</span>,
            <span class="hljs-attr">height</span>: box.getHeight() + <span class="hljs-string">'px'</span>,
            <span class="hljs-attr">top</span>: box.getStyle(<span class="hljs-string">'top'</span>),
            <span class="hljs-attr">left</span>: box.getStyle(<span class="hljs-string">'left'</span>)
        });
    },
    <span class="hljs-attr">_removeIFrameShim</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._iframeShim &amp;&amp; <span class="hljs-built_in">Object</span>.isElement(<span class="hljs-keyword">this</span>._iframeShim)) {
            <span class="hljs-keyword">this</span>._iframeShim.remove();
            <span class="hljs-keyword">this</span>._iframeShim = <span class="hljs-literal">null</span>;
        }
    },
    <span class="hljs-attr">close</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">timeout</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isClosing === <span class="hljs-literal">true</span>)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">this</span>._isClosing = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">this</span>.options.onBeforeClose.call(<span class="hljs-keyword">this</span>);
        timeout = !timeout &amp;&amp; timeout !== <span class="hljs-number">0</span> ? <span class="hljs-keyword">this</span>.options.fadeOutTime : <span class="hljs-built_in">parseInt</span>(timeout, <span class="hljs-number">10</span>);
        <span class="hljs-keyword">if</span> (timeout !== <span class="hljs-number">0</span>)
            <span class="hljs-keyword">this</span>._box.fadeOut(timeout, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">this</span>._box.remove();
            }.bind(<span class="hljs-keyword">this</span>));
        <span class="hljs-keyword">else</span>
            <span class="hljs-keyword">this</span>._box.remove();
        <span class="hljs-keyword">this</span>.options.onAfterClose.call(<span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">delete</span> g_glideBoxes[<span class="hljs-keyword">this</span>.getId()];
    },
    <span class="hljs-attr">_isQuirksMode</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">var</span> d = <span class="hljs-built_in">document</span>;
        <span class="hljs-keyword">while</span> (d) {
            <span class="hljs-keyword">if</span> (++i == <span class="hljs-number">10</span>)
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">if</span> (d.compatMode != <span class="hljs-string">'BackCompat'</span>)
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">if</span> (d.parentWindow.parent.document == d)
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            d = d.parentWindow.parent.document;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    },
    <span class="hljs-attr">toString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">'GlideBox'</span>;
    }
});
GlideBox.get = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">objIdOrElem</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> objIdOrElem == <span class="hljs-string">'object'</span> &amp;&amp; objIdOrElem.toString() == <span class="hljs-string">'GlideBox'</span>) {
        <span class="hljs-keyword">var</span> o = g_glideBoxes[objIdOrElem.options.id];
        <span class="hljs-keyword">return</span> o || <span class="hljs-literal">null</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> objIdOrElem == <span class="hljs-string">'string'</span>) {
        <span class="hljs-keyword">var</span> o = g_glideBoxes[objIdOrElem];
        <span class="hljs-keyword">if</span> (o) <span class="hljs-keyword">return</span> o;
    }
    <span class="hljs-keyword">var</span> e = $(objIdOrElem);
    <span class="hljs-keyword">if</span> (!e)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">var</span> box = e.up(<span class="hljs-string">'.glide_box'</span>);
    <span class="hljs-keyword">if</span> (box)
        <span class="hljs-keyword">return</span> g_glideBoxes[box.getAttribute(<span class="hljs-string">'id'</span>)] || <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}
GlideBox.close = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">objIdOrElem, timeout</span>) </span>{
    <span class="hljs-keyword">var</span> o = GlideBox.get(objIdOrElem);
    <span class="hljs-keyword">if</span> (o)
        o.close(timeout);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
<span class="hljs-keyword">var</span> gb_LoadingBody = <span class="hljs-string">'&lt;div style="padding:6px 5px 5px 3px;" class="gb_loading"&gt;&lt;span class="ia_loading"&gt;&lt;/span&gt;&lt;span class="fontsmall" style="padding-left:6px;padding-top:4px;"&gt;Loading ...&lt;/span&gt;&lt;/div&gt;'</span>;
<span class="hljs-keyword">var</span> gb_ToolbarTemplate = <span class="hljs-string">'&lt;table class="gb_toolbar"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gb_toolbar_col_l1"&gt;'</span> +
    <span class="hljs-string">'&lt;table class="gb_toolbar_left gb_toolbar_decoration"&gt;&lt;tr&gt;&lt;/tr&gt;&lt;/table&gt;'</span> +
    <span class="hljs-string">'&lt;/td&gt;&lt;td class="gb_toolbar_col_l1 gb_title_zone"&gt;&lt;/td&gt;&lt;td class="gb_toolbar_col_l1"&gt;'</span> +
    <span class="hljs-string">'&lt;table class="gb_toolbar_right gb_toolbar_decoration"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;'</span> +
    <span class="hljs-string">'&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;div class="gb_toolbar_bottom_border"&gt;&amp;nbsp;&lt;/div&gt;'</span>;
<span class="hljs-keyword">var</span> gb_FooterTemplate = <span class="hljs-string">'&lt;div class="gb_footer_sep"&gt;&lt;/div&gt;&lt;table class="gb_footer"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gb_footer_left_resize"&gt;&lt;/td&gt;&lt;td class="gb_footer_body"&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="gb_footer_right_resize"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;'</span>;
<span class="hljs-keyword">var</span> gb_BodyTemplate = <span class="hljs-string">'&lt;div class="gb_body_wrapper gb_mw"&gt;&lt;div class="gb_body"&gt;&lt;/div&gt;&lt;/div&gt;'</span>;
<span class="hljs-keyword">var</span> gb_BodyFrameTemplate = <span class="hljs-string">'&lt;div class="inner_wrap_outer"&gt;&lt;div class="inner_wrap_inner"&gt;&lt;div class="gb_body"&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;'</span>;
<span class="hljs-keyword">var</span> gb_BoxTemplateInner = <span class="hljs-string">'&lt;div class="gb_wrapper"&gt;&lt;table class="gb_table"&gt;&lt;thead&gt;&lt;tr&gt;&lt;td class="gb_table_col_l1" style="vertical-align:top;"&gt;'</span> + gb_ToolbarTemplate + <span class="hljs-string">'&lt;/td&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gb_table_col_l1"&gt;'</span> + gb_BodyTemplate + <span class="hljs-string">'&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;tfoot class="gb_table_tfoot"&gt;&lt;tr&gt;&lt;td class="gb_table_col_l1"&gt;'</span> + gb_FooterTemplate + <span class="hljs-string">'&lt;/td&gt;&lt;/tr&gt;&lt;/tfoot&gt;&lt;/table&gt;&lt;/div&gt;'</span>;
<span class="hljs-keyword">var</span> gb_BoxIFrameBody = <span class="hljs-string">'&lt;div class="loading_wrap_outer"&gt;&lt;div class="loading_wrap_inner"&gt;'</span> + gb_LoadingBody + <span class="hljs-string">'&lt;/div&gt;&lt;/div&gt;&lt;div class="iframe_container inner_wrap_outer"&gt;&lt;div class="inner_wrap_inner"&gt;&lt;iframe class="gb_iframe" frameborder="0" marginheight="0" marginwidth="0" src="javascript:\'&lt;html&gt;&lt;/html&gt;\'"&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="clear"&gt;&lt;/div&gt;'</span>;;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/ui/GlideOverlay.js */</span>
<span class="hljs-keyword">var</span> GlideOverlay = Class.create(GlideBox, {
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$super, options</span>) </span>{
        <span class="hljs-keyword">var</span> opts = <span class="hljs-built_in">Object</span>.extend({
            <span class="hljs-attr">closeOnEscape</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">isModal</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">id</span>: <span class="hljs-keyword">typeof</span> options == <span class="hljs-string">'string'</span> ? options : guid()
        }, options || {});
        opts.boxClass = [options.boxClass || <span class="hljs-string">''</span>, <span class="hljs-string">'glide_overlay'</span>].join(<span class="hljs-string">' '</span>);
        $<span class="hljs-keyword">super</span>(opts);
        GlideOverlay.showMask();
        <span class="hljs-keyword">this</span>.getBoxElement().observe(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
            event.stopPropagation();
            CustomEvent.fire(GlideEvent.WINDOW_CLICKED, event, <span class="hljs-built_in">window</span>);
        });
        <span class="hljs-keyword">this</span>.closeOnEscape(<span class="hljs-keyword">this</span>.options.closeOnEscape);
    },
    <span class="hljs-attr">isModal</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.options.isModal;
    },
    <span class="hljs-attr">closeOnEscape</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
        <span class="hljs-keyword">if</span> (!b &amp;&amp; <span class="hljs-keyword">this</span>._escapeCloseHandler) {
            $(<span class="hljs-built_in">document</span>).stopObserving(<span class="hljs-string">'keydown'</span>, <span class="hljs-keyword">this</span>._escapeCloseHandler);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (b &amp;&amp; !<span class="hljs-keyword">this</span>._escapeCloseHandler) {
            <span class="hljs-keyword">this</span>._escapeCloseHandler = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
                <span class="hljs-keyword">if</span> (event.keyCode === Event.KEY_ESC)
                    <span class="hljs-keyword">this</span>.close();
            }.bind(<span class="hljs-keyword">this</span>);
            $(<span class="hljs-built_in">document</span>).observe(<span class="hljs-string">'keydown'</span>, <span class="hljs-keyword">this</span>._escapeCloseHandler);
        }
    },
    <span class="hljs-attr">close</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$super, options</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isClosing === <span class="hljs-literal">true</span>)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._escapeCloseHandler) {
            $(<span class="hljs-built_in">document</span>).stopObserving(<span class="hljs-string">'keydown'</span>, <span class="hljs-keyword">this</span>._escapeCloseHandler);
            <span class="hljs-keyword">this</span>._escapeCloseHandler = <span class="hljs-literal">null</span>;
        }
        <span class="hljs-keyword">var</span> opts = {
            <span class="hljs-attr">timeout</span>: <span class="hljs-keyword">this</span>.options.fadeOutTime,
            <span class="hljs-attr">closeMask</span>: <span class="hljs-literal">true</span>
        };
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> options == <span class="hljs-string">'number'</span>)
            opts.timeout = options;
        <span class="hljs-keyword">else</span>
            <span class="hljs-built_in">Object</span>.extend(opts, options || {});
        <span class="hljs-keyword">var</span> mask = $(<span class="hljs-string">'glide_expose_mask'</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isModal() &amp;&amp; mask &amp;&amp; opts.closeMask === <span class="hljs-literal">true</span>) {
            <span class="hljs-keyword">if</span> (opts.timeout !== <span class="hljs-number">0</span>)
                mask.fadeOut(opts.timeout, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                    <span class="hljs-keyword">this</span>.remove();
                });
            <span class="hljs-keyword">else</span>
                mask.remove();
        }
        $<span class="hljs-keyword">super</span>(opts.timeout);
    },
    <span class="hljs-attr">toString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">'GlideOverlay'</span>;
    }
});
GlideOverlay.get = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">objIdOrElem</span>) </span>{
    <span class="hljs-keyword">if</span> (objIdOrElem)
        <span class="hljs-keyword">return</span> GlideBox.get(objIdOrElem);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i <span class="hljs-keyword">in</span> g_glideBoxes) {
        <span class="hljs-keyword">var</span> box = g_glideBoxes[i];
        <span class="hljs-keyword">if</span> (box.toString() == <span class="hljs-string">'GlideOverlay'</span>)
            <span class="hljs-keyword">return</span> box;
    }
}
GlideOverlay.close = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">objIdOrElem, options</span>) </span>{
    <span class="hljs-keyword">if</span> (objIdOrElem)
        <span class="hljs-keyword">return</span> GlideBox.close(objIdOrElem, options);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i <span class="hljs-keyword">in</span> g_glideBoxes) {
        <span class="hljs-keyword">var</span> box = g_glideBoxes[i];
        <span class="hljs-keyword">if</span> (box.toString() == <span class="hljs-string">'GlideOverlay'</span>)
            <span class="hljs-keyword">return</span> box.close(options);
    }
}
GlideOverlay.showMask = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> ($(<span class="hljs-string">'grayBackground'</span>))
        <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> mask = $(<span class="hljs-string">'glide_expose_mask'</span>);
    <span class="hljs-keyword">if</span> (!mask) {
        mask = $(<span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'div'</span>));
        mask.id = <span class="hljs-string">'glide_expose_mask'</span>;
        mask.className = <span class="hljs-string">'glide_mask'</span>;
        <span class="hljs-built_in">document</span>.body.appendChild(mask);
        mask.observe(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
            event.stopPropagation();
            CustomEvent.fire(GlideEvent.WINDOW_CLICKED, event, <span class="hljs-built_in">window</span>);
        });
    }
    mask.show();
    <span class="hljs-keyword">return</span> mask;
}
GlideOverlay.hideMask = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">boolRemove</span>) </span>{
    <span class="hljs-keyword">var</span> mask = $(<span class="hljs-string">'glide_expose_mask'</span>);
    <span class="hljs-keyword">if</span> (mask)
        mask[boolRemove === <span class="hljs-literal">true</span> ? <span class="hljs-string">'remove'</span> : <span class="hljs-string">'hide'</span>]();
};
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/GwtPollDialog.js */</span>
<span class="hljs-keyword">var</span> GwtPollDialog = Class.create(GlideDialogWindow, {
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tableName, query, rows, view, action, fields, excel_type</span>) </span>{
        GlideDialogWindow.prototype.initialize.call(<span class="hljs-keyword">this</span>, <span class="hljs-string">'export_poll_dialog'</span>);
        <span class="hljs-keyword">var</span> keys = [<span class="hljs-string">"Export in Progress"</span>, <span class="hljs-string">"Export Complete"</span>, <span class="hljs-string">"Export Canceled"</span>, <span class="hljs-string">"Export failed"</span>, <span class="hljs-string">"Internal error"</span>, <span class="hljs-string">"Finished Export. Exported {0} of {1} rows"</span>];
        <span class="hljs-keyword">this</span>.msgs = getMessages(keys);
        <span class="hljs-keyword">this</span>.tableName = tableName;
        <span class="hljs-keyword">this</span>.query = query;
        <span class="hljs-keyword">this</span>.rows = rows;
        <span class="hljs-keyword">this</span>.view = view;
        <span class="hljs-keyword">this</span>.action = action;
        <span class="hljs-keyword">this</span>.fields = fields;
        <span class="hljs-keyword">this</span>.excel_type = excel_type;
        <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'table'</span>, <span class="hljs-string">'export_poll'</span>);
        <span class="hljs-keyword">var</span> q = <span class="hljs-keyword">this</span>.query.replace(<span class="hljs-regexp">/&amp;/g</span>, <span class="hljs-string">"@99@"</span>);
        <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'sysparm_query'</span>, q);
        <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'sysparm_target'</span>, <span class="hljs-keyword">this</span>.tableName);
        <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'sysparm_export'</span>, <span class="hljs-keyword">this</span>.action);
        <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'sysparm_view'</span>, <span class="hljs-keyword">this</span>.view);
        <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'sysparm_rows'</span>, <span class="hljs-keyword">this</span>.rows);
        <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'sysparm_fields'</span>, <span class="hljs-keyword">this</span>.fields);
        <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'sysparm_excel_type'</span>, <span class="hljs-keyword">this</span>.excel_type);
        <span class="hljs-keyword">this</span>.pollInterval = <span class="hljs-number">1000</span>;
        <span class="hljs-keyword">this</span>.jobId = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.timerId = <span class="hljs-literal">null</span>;
        g_poll_dialog = <span class="hljs-keyword">this</span>;
    },
    <span class="hljs-attr">execute</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.render();
    },
    <span class="hljs-attr">close</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        g_poll_dialog = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.destroy();
    },
    <span class="hljs-attr">cancelJob</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> postString = <span class="hljs-string">"job_id="</span> + <span class="hljs-keyword">this</span>.jobId + <span class="hljs-string">"&amp;sys_action=cancel"</span>;
        <span class="hljs-keyword">this</span>._makeRequest(postString, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            clearTimeout(<span class="hljs-keyword">this</span>.timerId);
        }.bind(<span class="hljs-keyword">this</span>))
        <span class="hljs-keyword">this</span>.close();
    },
    <span class="hljs-attr">startPolling</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.setTitle(<span class="hljs-keyword">this</span>.msgs[<span class="hljs-string">"Export in Progress"</span>]);
        <span class="hljs-keyword">var</span> poll_form = $(<span class="hljs-string">'sys_poll.do'</span>);
        <span class="hljs-keyword">if</span> (poll_form) {
            poll_form.sys_action.value = <span class="hljs-string">"init"</span>;
            <span class="hljs-keyword">if</span> (poll_form.sysparm_query &amp;&amp; poll_form.sysparm_query.value)
                poll_form.sysparm_query.value = poll_form.sysparm_query.value.replace(<span class="hljs-regexp">/@99@/g</span>, <span class="hljs-string">"&amp;"</span>);
            <span class="hljs-keyword">var</span> serial = Form.serialize(poll_form);
            <span class="hljs-keyword">this</span>._makeRequest(serial, <span class="hljs-keyword">this</span>.ackInit.bind(<span class="hljs-keyword">this</span>));
        }
    },
    <span class="hljs-attr">ackInit</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) </span>{
        <span class="hljs-keyword">this</span>.jobId = response.responseText;
        <span class="hljs-keyword">this</span>._queuePoll();
    },
    <span class="hljs-attr">ack</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._isDestroyed())
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">var</span> answer = response.responseText;
        <span class="hljs-keyword">if</span> (answer.indexOf(<span class="hljs-string">'complete'</span>) == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">var</span> splits = answer.split(<span class="hljs-string">','</span>);
            <span class="hljs-keyword">var</span> id = splits[<span class="hljs-number">1</span>];
            $(<span class="hljs-string">'completed_sys_id'</span>).value = id;
            $(<span class="hljs-string">'poll_text'</span>).innerHTML = <span class="hljs-keyword">this</span>.msgs[<span class="hljs-string">"Export Complete"</span>];
            <span class="hljs-keyword">var</span> download = $(<span class="hljs-string">'download_button'</span>);
            download.setAttribute(<span class="hljs-string">'class'</span>, <span class="hljs-string">'web'</span>);
            download.setAttribute(<span class="hljs-string">'className'</span>, <span class="hljs-string">'web'</span>);
            download.disabled = <span class="hljs-literal">false</span>;
            $(<span class="hljs-string">'poll_img'</span>).hide();
            $(<span class="hljs-string">'export_complete'</span>).show();
            <span class="hljs-keyword">this</span>.setTitle(<span class="hljs-keyword">this</span>.msgs[<span class="hljs-string">"Export Complete"</span>]);
            <span class="hljs-keyword">var</span> isAdmin = $(<span class="hljs-string">'is_admin'</span>).value;
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.action.indexOf(<span class="hljs-string">'unload_'</span>) == <span class="hljs-number">0</span> &amp;&amp; isAdmin == <span class="hljs-string">"true"</span>) {
                <span class="hljs-keyword">var</span> gr = <span class="hljs-keyword">new</span> GlideRecord(<span class="hljs-string">"sys_poll"</span>);
                gr.addQuery(<span class="hljs-string">"job_id"</span>, <span class="hljs-keyword">this</span>.jobId);
                gr.query(<span class="hljs-keyword">this</span>._showExportStatusMsg.bind(<span class="hljs-keyword">this</span>));
            }
            <span class="hljs-keyword">return</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (answer.indexOf(<span class="hljs-string">'error'</span>) == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">this</span>.setTitle(<span class="hljs-keyword">this</span>.msgs[<span class="hljs-string">"Export failed"</span>]);
            <span class="hljs-keyword">var</span> splits = answer.split(<span class="hljs-string">','</span>);
            <span class="hljs-keyword">if</span> (splits.length &gt; <span class="hljs-number">1</span>)
                $(<span class="hljs-string">'err_text'</span>).innerHTML = splits[<span class="hljs-number">1</span>];
            $(<span class="hljs-string">'poll_img'</span>).hide();
            $(<span class="hljs-string">'export_failed'</span>).show();
            $(<span class="hljs-string">'download_button'</span>).hide();
            $(<span class="hljs-string">'cancel_button'</span>).hide();
            $(<span class="hljs-string">'ok_button'</span>).show();
            <span class="hljs-keyword">return</span>;
        } <span class="hljs-keyword">else</span> {
            $(<span class="hljs-string">'poll_img'</span>).show();
        }
        <span class="hljs-keyword">if</span> (answer.indexOf(<span class="hljs-string">'cancelled'</span>) == <span class="hljs-number">0</span>) {
            $(<span class="hljs-string">'poll_img'</span>).hide();
            $(<span class="hljs-string">'export_canceled'</span>).show();
            $(<span class="hljs-string">'download_button'</span>).hide();
            $(<span class="hljs-string">'retry_button'</span>).show();
            <span class="hljs-keyword">var</span> answerParts = answer.split(<span class="hljs-string">','</span>);
            $(<span class="hljs-string">'poll_text'</span>).innerHTML = answerParts[<span class="hljs-number">1</span>];
            <span class="hljs-keyword">this</span>.setTitle(<span class="hljs-keyword">this</span>.msgs[<span class="hljs-string">'Export Canceled'</span>]);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (answer.indexOf(<span class="hljs-string">'initial'</span>) != <span class="hljs-number">0</span>) {
            $(<span class="hljs-string">'poll_text'</span>).innerHTML = answer;
            $(<span class="hljs-string">'retry_button'</span>).hide();
            $(<span class="hljs-string">'download_button'</span>).show();
            $(<span class="hljs-string">'export_canceled'</span>).hide();
            <span class="hljs-keyword">this</span>._queuePoll.call(<span class="hljs-keyword">this</span>);
        }
    },
    <span class="hljs-attr">_showExportStatusMsg</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">gRecord</span>) </span>{
        <span class="hljs-keyword">if</span> (gRecord.next()) {
            maxRows = gRecord.getValue(<span class="hljs-string">'max'</span>);
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.rows &gt; maxRows) {
                $(<span class="hljs-string">'poll_text_export_status'</span>).innerHTML = formatMessage(<span class="hljs-keyword">this</span>.msgs[<span class="hljs-string">'Finished Export. Exported {0} of {1} rows'</span>], maxRows, <span class="hljs-keyword">this</span>.rows);
                $(<span class="hljs-string">'poll_text_wiki'</span>).show();
            }
        }
    },
    <span class="hljs-attr">_queuePoll</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.timerId = setTimeout(<span class="hljs-keyword">this</span>.poll.bind(<span class="hljs-keyword">this</span>), <span class="hljs-keyword">this</span>.pollInterval);
    },
    <span class="hljs-attr">poll</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.jobId) {
            <span class="hljs-keyword">var</span> postString = <span class="hljs-string">"job_id="</span> + <span class="hljs-keyword">this</span>.jobId + <span class="hljs-string">"&amp;sys_action=poll"</span>;
            <span class="hljs-keyword">this</span>._makeRequest(postString, <span class="hljs-keyword">this</span>.ack.bind(<span class="hljs-keyword">this</span>));
        }
    },
    <span class="hljs-attr">_makeRequest</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">postString, callback</span>) </span>{
        <span class="hljs-keyword">var</span> ga = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">'poll_processor'</span>, <span class="hljs-string">'poll_processor.do'</span>);
        ga.setQueryString(postString);
        ga.getXML(callback);
    },
    <span class="hljs-attr">getResult</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> id = $(<span class="hljs-string">'completed_sys_id'</span>).value;
        top.window.location = <span class="hljs-string">"sys_attachment.do?sys_id="</span> + id;
        <span class="hljs-keyword">this</span>.close();
    },
    <span class="hljs-attr">_isDestroyed</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> ($(<span class="hljs-string">'poll_text'</span>) == <span class="hljs-literal">null</span>)
            g_poll_dialog = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">return</span> g_poll_dialog == <span class="hljs-literal">null</span>;
    }
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/GwtExportScheduleDialog.js */</span>
<span class="hljs-keyword">var</span> GwtExportScheduleDialog = Class.create(GlideDialogWindow, {
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tableName, query, rows, view, action, fields, excel_type</span>) </span>{
        GlideDialogWindow.prototype.initialize.call(<span class="hljs-keyword">this</span>, <span class="hljs-string">'export_schedule_dialog'</span>);
        <span class="hljs-keyword">var</span> keys = [<span class="hljs-string">"Please Confirm"</span>, <span class="hljs-string">"Please specify an address"</span>, <span class="hljs-string">"Export will be emailed to"</span>];
        <span class="hljs-keyword">this</span>.msgs = getMessages(keys);
        <span class="hljs-keyword">this</span>.tableName = tableName;
        <span class="hljs-keyword">this</span>.query = query;
        <span class="hljs-keyword">this</span>.rows = rows;
        <span class="hljs-keyword">this</span>.view = view;
        <span class="hljs-keyword">this</span>.action = action;
        <span class="hljs-keyword">this</span>.fields = fields;
        <span class="hljs-keyword">this</span>.excel_type = excel_type;
        <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'table'</span>, <span class="hljs-string">'export_schedule'</span>);
        <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'sysparm_query'</span>, <span class="hljs-keyword">this</span>.query);
        <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'sysparm_target'</span>, <span class="hljs-keyword">this</span>.tableName);
        <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'sysparm_export'</span>, <span class="hljs-keyword">this</span>.action);
        <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'sysparm_view'</span>, <span class="hljs-keyword">this</span>.view);
        <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'sysparm_rows'</span>, <span class="hljs-keyword">this</span>.rows);
        <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'sysparm_fields'</span>, <span class="hljs-keyword">this</span>.fields);
        <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'sysparm_excel_type'</span>, <span class="hljs-keyword">this</span>.excel_type);
        <span class="hljs-keyword">this</span>.setTitle(<span class="hljs-keyword">this</span>.msgs[<span class="hljs-string">"Please Confirm"</span>]);
        g_export_schedule_dialog = <span class="hljs-keyword">this</span>;
    },
    <span class="hljs-attr">execute</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.render();
    },
    <span class="hljs-attr">close</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        g_export_schedule_dialog = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.destroy();
    },
    <span class="hljs-attr">emailMe</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> address = gel(<span class="hljs-string">'display_address'</span>);
        <span class="hljs-keyword">if</span> (!address)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">if</span> (address.value == <span class="hljs-string">''</span>) {
            alert(<span class="hljs-keyword">this</span>.msgs[<span class="hljs-string">"Please specify an address"</span>]);
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">var</span> real_address = gel(<span class="hljs-string">'email_address'</span>);
        real_address.value = address.value;
        <span class="hljs-keyword">var</span> splits = <span class="hljs-keyword">this</span>.action.split(<span class="hljs-string">'\_'</span>);
        <span class="hljs-keyword">var</span> fName = <span class="hljs-string">'sys_confirm_'</span> + splits[<span class="hljs-number">1</span>] + <span class="hljs-string">'.do'</span>;
        <span class="hljs-keyword">var</span> confirm_form = gel(fName);
        confirm_form.sys_action.value = <span class="hljs-string">"email"</span>;
        <span class="hljs-keyword">var</span> remember_me = gel(<span class="hljs-string">'display_remember_me'</span>);
        <span class="hljs-keyword">if</span> (remember_me.checked)
            gel(<span class="hljs-string">'remember_me'</span>).value = <span class="hljs-string">"true"</span>;
        <span class="hljs-keyword">var</span> serial = Form.serialize(confirm_form);
        <span class="hljs-keyword">var</span> args = <span class="hljs-keyword">this</span>.msgs[<span class="hljs-string">"Export will be emailed to"</span>] + <span class="hljs-string">' '</span> + address.value;
        serverRequestPost(fName, serial, <span class="hljs-keyword">this</span>.ack, args);
        <span class="hljs-keyword">this</span>.close();
    },
    <span class="hljs-attr">waitForIt</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> dialog = <span class="hljs-keyword">new</span> GwtPollDialog(<span class="hljs-keyword">this</span>.tableName, <span class="hljs-keyword">this</span>.query, <span class="hljs-keyword">this</span>.rows, <span class="hljs-keyword">this</span>.view, <span class="hljs-keyword">this</span>.action, <span class="hljs-keyword">this</span>.fields, <span class="hljs-keyword">this</span>.excel_type);
        dialog.execute();
        <span class="hljs-keyword">this</span>.close();
    },
    <span class="hljs-attr">ack</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">request, message</span>) </span>{
        alert(message);
    }
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/TemplateRecord.js */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">applyTemplate</span>(<span class="hljs-params">sysID</span>) </span>{
    <span class="hljs-keyword">var</span> t = <span class="hljs-keyword">new</span> TemplateRecord(sysID);
    t.apply();
}
<span class="hljs-keyword">var</span> TemplateRecord = Class.create({
    <span class="hljs-attr">NAME</span>: <span class="hljs-string">"name"</span>,
    <span class="hljs-attr">VALUE</span>: <span class="hljs-string">"value"</span>,
    <span class="hljs-attr">ITEM</span>: <span class="hljs-string">"item"</span>,
    <span class="hljs-attr">DEPENDENT</span>: <span class="hljs-string">"dependent"</span>,
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">sysID</span>) </span>{
        <span class="hljs-keyword">this</span>.sysID = sysID;
    },
    <span class="hljs-attr">apply</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> ga = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">'AjaxClientHelper'</span>);
        ga.addParam(<span class="hljs-string">'sysparm_name'</span>, <span class="hljs-string">'getValues'</span>);
        ga.addParam(<span class="hljs-string">'sysparm_sys_id'</span>, <span class="hljs-keyword">this</span>.sysID);
        ga.getXML(<span class="hljs-keyword">this</span>._applyResponse.bind(<span class="hljs-keyword">this</span>));
    },
    <span class="hljs-attr">_applyResponse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) </span>{
        <span class="hljs-keyword">if</span> (!response || !response.responseXML)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">this</span>.template = response.responseXML;
        <span class="hljs-keyword">this</span>.applyRecord();
    },
    <span class="hljs-attr">applyRecord</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> items = <span class="hljs-keyword">this</span>.template.getElementsByTagName(<span class="hljs-keyword">this</span>.ITEM);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
            <span class="hljs-keyword">var</span> item = items[i];
            <span class="hljs-keyword">var</span> name = item.getAttribute(<span class="hljs-keyword">this</span>.NAME);
            <span class="hljs-keyword">var</span> e = g_form.getGlideUIElement(name);
            <span class="hljs-keyword">if</span> (e &amp;&amp; (e.getType() == <span class="hljs-string">"currency"</span> || e.getType() == <span class="hljs-string">"price"</span>)) {
                <span class="hljs-keyword">if</span> (e.getChildElementById(e.getID() + <span class="hljs-string">".display"</span>)) {
                    name += <span class="hljs-string">".display"</span>;
                }
            }
            <span class="hljs-keyword">var</span> widget = g_form.getControl(name);
            <span class="hljs-keyword">if</span> (!widget) {
                <span class="hljs-keyword">continue</span>;
            }
            <span class="hljs-keyword">if</span> (g_form.isTemplateCompatible(e, widget) &amp;&amp; !g_form.isReadOnly(e, widget))
                <span class="hljs-keyword">this</span>.applyItem(name, item.getAttribute(<span class="hljs-keyword">this</span>.VALUE));
        }
    },
    <span class="hljs-attr">applyItem</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, value</span>) </span>{
        <span class="hljs-keyword">if</span> (value == <span class="hljs-literal">null</span> || value == <span class="hljs-string">'null'</span>)
            <span class="hljs-keyword">return</span>;
        g_form.setTemplateValue(element, value);
    }
});
TemplateRecord.save = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
    <span class="hljs-keyword">var</span> fields = g_form.getEditableFields();
    <span class="hljs-keyword">var</span> f = g_form.getFormElement();
    addHidden(f, <span class="hljs-string">'sysparm_template_editable'</span>, fields.join());
    gsftSubmit(id);
};
<span class="hljs-comment">/*! RESOURCE: /scripts/popups.js */</span>
<span class="hljs-keyword">var</span> popupCurrent = <span class="hljs-literal">null</span>;
<span class="hljs-keyword">var</span> lastMouseX;
<span class="hljs-keyword">var</span> lastMouseY;
<span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.opener &amp;&amp; !<span class="hljs-built_in">window</span>.opener.closed &amp;&amp; <span class="hljs-built_in">window</span>.opener != <span class="hljs-built_in">window</span>.self) {
    Event.observe(<span class="hljs-built_in">window</span>, <span class="hljs-string">'beforeunload'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.opener &amp;&amp; !<span class="hljs-built_in">window</span>.opener.closed &amp;&amp; <span class="hljs-built_in">window</span>.opener.popupCurrent &amp;&amp; <span class="hljs-built_in">window</span>.opener.popupCurrent == <span class="hljs-built_in">window</span>.self)
            <span class="hljs-built_in">window</span>.opener.popupCurrent = <span class="hljs-literal">null</span>;
    });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">popupClose</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (!popupCurrent)
        <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">if</span> (!popupCurrent.closed)
            popupCurrent.close();
    } <span class="hljs-keyword">catch</span> (e) {}
    popupCurrent = <span class="hljs-literal">null</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mousePositionSave</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">if</span> (navigator.appName.indexOf(<span class="hljs-string">"Microsoft"</span>) != <span class="hljs-number">-1</span>)
        e = <span class="hljs-built_in">window</span>.event;
    lastMouseX = e.screenX;
    lastMouseY = e.screenY;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">imageListOpen</span>(<span class="hljs-params">elementName, img_dirs, ignore, name</span>) </span>{
    <span class="hljs-keyword">var</span> url = <span class="hljs-keyword">new</span> GlideURL(<span class="hljs-string">"image_picker.do"</span>);
    url.addParam(<span class="hljs-string">"sysparm_element"</span>, elementName);
    url.addParam(<span class="hljs-string">"sysparm_img_dirs"</span>, img_dirs);
    url.addParam(<span class="hljs-string">"sysparm_ignore"</span>, ignore);
    url.addParam(<span class="hljs-string">"sysparm_name"</span>, name || <span class="hljs-string">""</span>);
    popupOpenStandard(url.getURL(), <span class="hljs-string">"imagepicker"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">imageBrowseOpen</span>(<span class="hljs-params">elementName, directory, name, color, icon</span>) </span>{
    <span class="hljs-keyword">if</span> (!color)
        color = <span class="hljs-string">"color-normal"</span>;
    <span class="hljs-keyword">var</span> url = <span class="hljs-keyword">new</span> GlideURL(<span class="hljs-string">"icon_browse.do"</span>);
    url.addParam(<span class="hljs-string">"sysparm_dir"</span>, directory);
    url.addParam(<span class="hljs-string">"sysparm_name"</span>, name || <span class="hljs-string">""</span>);
    url.addParam(<span class="hljs-string">"sysparm_element"</span>, elementName);
    url.addParam(<span class="hljs-string">"sysparm_color"</span>, color);
    url.addParam(<span class="hljs-string">"sysparm_icon"</span>, icon);
    popupOpenStandard(url.getURL(), <span class="hljs-string">"imagepicker"</span>);
}
<span class="hljs-keyword">var</span> g_IconBrowseHelpers = {
    <span class="hljs-attr">getIconColor</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> spanElem = jQuery(<span class="hljs-string">"span.bookmark_image"</span>);
        <span class="hljs-keyword">if</span> (spanElem.length) {
            <span class="hljs-keyword">var</span> color = jQuery.grep(spanElem.prop(<span class="hljs-string">'class'</span>).split(<span class="hljs-string">" "</span>), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>) </span>{
                <span class="hljs-keyword">return</span> v.indexOf(<span class="hljs-string">'color-'</span>) === <span class="hljs-number">0</span>;
            });
            <span class="hljs-keyword">return</span> color.length ? color[<span class="hljs-number">0</span>] : <span class="hljs-string">''</span>;
        }
    },
    <span class="hljs-attr">getIcon</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> spanElem = jQuery(<span class="hljs-string">"span.bookmark_image"</span>);
        <span class="hljs-keyword">if</span> (spanElem.length) {
            <span class="hljs-keyword">var</span> fontIcon = jQuery.grep(spanElem.prop(<span class="hljs-string">'class'</span>).split(<span class="hljs-string">" "</span>), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>) </span>{
                <span class="hljs-keyword">return</span> v.indexOf(<span class="hljs-string">'icon-'</span>) === <span class="hljs-number">0</span>;
            });
            <span class="hljs-keyword">return</span> fontIcon.length ? fontIcon[<span class="hljs-number">0</span>] : <span class="hljs-string">''</span>;
        }
    }
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">imagePickedCustomEvent</span>(<span class="hljs-params">options</span>) </span>{
    CustomEvent.fire(<span class="hljs-string">'glide:image_picked'</span>, options);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">imageListPick</span>(<span class="hljs-params">elementName, value</span>) </span>{
    <span class="hljs-keyword">var</span> element = <span class="hljs-built_in">document</span>.getElementById(elementName);
    <span class="hljs-keyword">if</span> (element.nodeName == <span class="hljs-string">"IMG"</span> || element.nodeName == <span class="hljs-string">"INPUT"</span>) {
        <span class="hljs-keyword">var</span> imgel = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"img."</span> + elementName);
        element.value = value;
        <span class="hljs-keyword">if</span> (element[<span class="hljs-string">'onchange'</span>])
            element.onchange();
        <span class="hljs-keyword">if</span> (imgel != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">if</span> (value &amp;&amp; value.length &gt; <span class="hljs-number">0</span>)
                imgel.src = value;
            <span class="hljs-keyword">else</span>
                imgel.src = <span class="hljs-string">"images/s.gifx"</span>;
        }
    } <span class="hljs-keyword">else</span> {
        element.className = <span class="hljs-string">""</span>;
        element.className = <span class="hljs-string">"image-browse-icon "</span> + value;
    }
    popupClose();
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reflistOpen</span>(<span class="hljs-params">target, elementName, refTableName, dependent, useQBE, refQualElements, additionalQual, parentID, forceReference</span>) </span>{
    <span class="hljs-keyword">var</span> url = reflistOpenUrl(target, target, elementName, refTableName, dependent, useQBE, refQualElements, additionalQual, parentID, forceReference);
    popupOpenStandard(url, <span class="hljs-string">"lookup"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reflistOpenUrl</span>(<span class="hljs-params">target, targetElementID, elementName, refTableName, dependent, useQBE, refQualElements, additionalQual, parentID, forceReference</span>) </span>{
    <span class="hljs-keyword">var</span> url;
    <span class="hljs-keyword">if</span> (useQBE == <span class="hljs-string">'true'</span>)
        url = <span class="hljs-keyword">new</span> GlideURL(refTableName + <span class="hljs-string">'_search.do'</span>);
    <span class="hljs-keyword">else</span>
        url = <span class="hljs-keyword">new</span> GlideURL(refTableName + <span class="hljs-string">'_list.do'</span>);
    url.addParam(<span class="hljs-string">"sysparm_target"</span>, target);
    <span class="hljs-keyword">var</span> et = gel(targetElementID);
    <span class="hljs-keyword">if</span> (et)
        url.addParam(<span class="hljs-string">"sysparm_target_value"</span>, et.value);
    <span class="hljs-keyword">var</span> dspEl = gel(<span class="hljs-string">"sys_display."</span> + targetElementID);
    <span class="hljs-keyword">if</span> (dspEl &amp;&amp; !et.value)
        url.addParam(<span class="hljs-string">"sysparm_reference_value"</span>, dspEl.value);
    url.addParam(<span class="hljs-string">"sysparm_nameofstack"</span>, <span class="hljs-string">"reflist"</span>);
    url.addParam(<span class="hljs-string">"sysparm_clear_stack"</span>, <span class="hljs-string">"true"</span>);
    url.addParam(<span class="hljs-string">"sysparm_element"</span>, elementName);
    url.addParam(<span class="hljs-string">"sysparm_reference"</span>, refTableName);
    url.addParam(<span class="hljs-string">"sysparm_view"</span>, <span class="hljs-string">"sys_ref_list"</span>);
    url.addParam(<span class="hljs-string">"sysparm_additional_qual"</span>, additionalQual);
    <span class="hljs-keyword">if</span> (parentID != <span class="hljs-literal">null</span> &amp;&amp; parentID != <span class="hljs-string">''</span>)
        url.addParam(<span class="hljs-string">"sysparm_parent_id"</span>, parentID);
    <span class="hljs-keyword">if</span> (forceReference)
        url.addParam(<span class="hljs-string">"sysparm_force_ref"</span>, <span class="hljs-string">"true"</span>);
    <span class="hljs-keyword">var</span> v = getDependentValue(target, dependent);
    <span class="hljs-keyword">if</span> (v != <span class="hljs-literal">null</span>)
        url.addParam(<span class="hljs-string">"sysparm_dependent"</span>, v);
    <span class="hljs-keyword">var</span> refQual = getRefQualURI(target, refQualElements);
    <span class="hljs-keyword">return</span> url.getURL() + refQual;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">emailClientOpen</span>(<span class="hljs-params">e, table, row, rows</span>) </span>{
    <span class="hljs-keyword">var</span> query = e.getAttribute(<span class="hljs-string">"query"</span>);
    <span class="hljs-keyword">var</span> addOn = <span class="hljs-string">'&amp;sysparm_record_row='</span> + row + <span class="hljs-string">'&amp;sysparm_record_rows='</span> + rows + <span class="hljs-string">'&amp;sysparm_record_list='</span> + <span class="hljs-built_in">encodeURIComponent</span>(query);
    emailClientOpenPop(table, <span class="hljs-literal">false</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, addOn);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showPopupLiveFeedList</span>(<span class="hljs-params">sysId, table</span>) </span>{
    <span class="hljs-keyword">var</span> box = GlideBox.get(<span class="hljs-string">'showLiveFeed'</span>);
    <span class="hljs-keyword">if</span> (box)
        box.close(<span class="hljs-number">0</span>);
    <span class="hljs-keyword">var</span> iframe_src = <span class="hljs-string">'show_live_feed.do?sysparm_stack=no&amp;sysparm_sys_id='</span> + sysId + <span class="hljs-string">'&amp;sysparm_table='</span> + table;
    box = <span class="hljs-keyword">new</span> GlideBox({
        <span class="hljs-attr">id</span>: <span class="hljs-string">'showLiveFeed'</span>,
        <span class="hljs-attr">iframe</span>: iframe_src,
        <span class="hljs-attr">width</span>: <span class="hljs-number">600</span>,
        <span class="hljs-attr">height</span>: <span class="hljs-string">"95%"</span>,
        <span class="hljs-attr">title</span>: <span class="hljs-string">"Live Feed"</span>,
        <span class="hljs-attr">noTitle</span>: <span class="hljs-literal">true</span>
    });
    box.render();
    <span class="hljs-keyword">var</span> g_feedResizer;
    Event.observe(<span class="hljs-built_in">window</span>, <span class="hljs-string">'resize'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        g_feedResizer = setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            box.autoPosition();
            box.autoDimension();
        }, <span class="hljs-number">50</span>);
    });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">emailClientOpenPop</span>(<span class="hljs-params">table, immediate, replyType, replyID, addOn</span>) </span>{
    <span class="hljs-keyword">var</span> id = <span class="hljs-built_in">document</span>.getElementsByName(<span class="hljs-string">"sys_uniqueValue"</span>)[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">if</span> (!id)
        <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> url = <span class="hljs-keyword">new</span> GlideURL(<span class="hljs-string">"email_client.do"</span>);
    url.addParam(<span class="hljs-string">"sysparm_table"</span>, table);
    url.addParam(<span class="hljs-string">"sysparm_sys_id"</span>, id.value);
    url.addParam(<span class="hljs-string">"sysparm_target"</span>, table);
    <span class="hljs-keyword">if</span> (replyType != <span class="hljs-literal">null</span>) {
        url.addParam(<span class="hljs-string">"replytype"</span>, replyType);
        url.addParam(<span class="hljs-string">"replyid"</span>, replyID);
    }
    popupOpenEmailClient(url.getURL() + g_form.serializeChangedAll());
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reflistPick</span>(<span class="hljs-params">elementName, value, display</span>) </span>{
<span class="hljs-meta">    "use strict"</span>;
    <span class="hljs-keyword">var</span> listName = <span class="hljs-string">"select_0"</span> + elementName;
    <span class="hljs-keyword">var</span> list = $(listName);
    <span class="hljs-keyword">if</span> (list) {
        addGlideListChoice(listName, value, display, <span class="hljs-literal">true</span>);
        popupClose();
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    <span class="hljs-keyword">if</span> (gel(<span class="hljs-string">"sys_display.LIST_EDIT_"</span> + elementName))
        elementName = <span class="hljs-string">"LIST_EDIT_"</span> + elementName;
    <span class="hljs-keyword">var</span> element = $(<span class="hljs-string">"sys_display."</span> + elementName);
    <span class="hljs-keyword">if</span> (element &amp;&amp; element.onRefPick)
        element.onRefPick(element);
    <span class="hljs-keyword">if</span> (element &amp;&amp; element.ac &amp;&amp; <span class="hljs-keyword">typeof</span>(element.ac.referenceSelect) == <span class="hljs-string">"function"</span>) {
        element.ac.referenceSelectTimeout(value, display);
        popupClose();
        <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">var</span> elementActual = $(elementName);
    elementActual.value = value;
    element = $(<span class="hljs-string">"sys_display."</span> + elementName);
    element.value = display;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(elementActual.onchange) == <span class="hljs-string">"function"</span>)
        elementActual.onchange();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(element.onchange) == <span class="hljs-string">"function"</span>)
        element.onchange();
    <span class="hljs-keyword">var</span> eDep = element;
    <span class="hljs-keyword">var</span> itemName = eDep.getAttribute(<span class="hljs-string">"function"</span>);
    <span class="hljs-keyword">if</span> (itemName != <span class="hljs-literal">null</span>) {
        <span class="hljs-built_in">eval</span>(itemName);
    }
    element = <span class="hljs-built_in">document</span>.getElementsByName(<span class="hljs-string">"sys_select."</span> + elementName)[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">if</span> (element != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">var</span> options = element.options;
        <span class="hljs-keyword">var</span> optionFound = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; options.length; i++) {
            <span class="hljs-keyword">var</span> option = options[i];
            option.selected = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">var</span> o = option.value;
            <span class="hljs-keyword">if</span> (o == value) {
                option.selected = <span class="hljs-literal">true</span>;
                optionFound = <span class="hljs-literal">true</span>;
            }
        }
        <span class="hljs-keyword">if</span> (!optionFound) {
            element.selectedIndex = <span class="hljs-number">-1</span>;
            <span class="hljs-keyword">var</span> opt = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"option"</span>);
            opt.value = value;
            opt.appendChild(<span class="hljs-built_in">document</span>.createTextNode(display));
            opt.selected = <span class="hljs-literal">true</span>;
            element.appendChild(opt);
            <span class="hljs-keyword">var</span> options = element.options;
            element.selectedIndex = options.length - <span class="hljs-number">1</span>;
            element.disabled = <span class="hljs-literal">true</span>;
            element.disabled = <span class="hljs-literal">false</span>;
        }
        element.onchange();
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">var</span> fcs = <span class="hljs-string">"updateRelatedGivenNameAndValue('"</span> + elementName + <span class="hljs-string">"','"</span> + value + <span class="hljs-string">"');"</span>;
        setTimeout(fcs, <span class="hljs-number">0</span>);
    }
    popupClose();
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">picklistOpen</span>(<span class="hljs-params">baseURL, width, modified, searchParam, target, dependent</span>) </span>{
    <span class="hljs-keyword">if</span> (modified == <span class="hljs-string">'1'</span>)
        baseURL = baseURL + searchParam;
    baseURL += getDependent(target, dependent);
    popupOpenStandard(baseURL, <span class="hljs-string">"lookup"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDependent</span>(<span class="hljs-params">target, dependent</span>) </span>{
    <span class="hljs-keyword">var</span> value = getDependentValue(target, dependent);
    <span class="hljs-keyword">if</span> (value == <span class="hljs-literal">null</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-string">"&amp;sysparm_dependent="</span> + <span class="hljs-built_in">encodeURIComponent</span>(value);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDependentValue</span>(<span class="hljs-params">target, dependent</span>) </span>{
    <span class="hljs-keyword">if</span> (dependent == <span class="hljs-literal">null</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">var</span> table = target.split(<span class="hljs-string">'.'</span>)[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">var</span> tfield = dependent.split(<span class="hljs-string">','</span>)[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">var</span> elname = table + <span class="hljs-string">'.'</span> + tfield;
    <span class="hljs-keyword">if</span> (tfield == <span class="hljs-string">'sys_id'</span>) {
        tfield = <span class="hljs-string">'sys_uniquevalue'</span>;
        elname = <span class="hljs-string">'sys_uniquevalue'</span>;
    }
    <span class="hljs-keyword">var</span> el = <span class="hljs-built_in">document</span>.getElementsByName(elname)[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">if</span> (el == <span class="hljs-literal">null</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">var</span> selectValue = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">if</span> (el.tagName == <span class="hljs-string">"INPUT"</span>)
        <span class="hljs-keyword">var</span> selectValue = el.value;
    <span class="hljs-keyword">else</span>
        selectValue = el.options[el.selectedIndex].value;
    <span class="hljs-keyword">return</span> selectValue;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getRefQualURI</span>(<span class="hljs-params">target, refQualElements</span>) </span>{
    <span class="hljs-keyword">if</span> (!refQualElements || <span class="hljs-keyword">typeof</span> g_form == <span class="hljs-string">"undefined"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
    <span class="hljs-keyword">var</span> aj = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">"FormStateAjax"</span>);
    aj.addEncodedString(g_form.serialize());
    aj.getXMLWait();
    <span class="hljs-keyword">return</span> <span class="hljs-string">"&amp;sysparm_client_record=session"</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">picklistPick</span>(<span class="hljs-params">elementName, value</span>) </span>{
    <span class="hljs-keyword">var</span> element = <span class="hljs-built_in">document</span>.getElementsByName(elementName)[<span class="hljs-number">0</span>];
    element.value = value;
    <span class="hljs-keyword">if</span> (element[<span class="hljs-string">"onchange"</span>]) {
        element.onchange();
    }
    element.value = replaceRegEx(element.value, <span class="hljs-built_in">document</span>, elementName);
    popupClose();
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">popupOpenStandard</span>(<span class="hljs-params">url, name</span>) </span>{
    <span class="hljs-keyword">var</span> width = <span class="hljs-built_in">document</span>.documentElement.getAttribute(<span class="hljs-string">'data-doctype'</span>) == <span class="hljs-string">'true'</span> ? <span class="hljs-number">800</span> : <span class="hljs-number">700</span>;
    <span class="hljs-keyword">var</span> height = <span class="hljs-number">480</span>;
    <span class="hljs-keyword">var</span> features = <span class="hljs-string">"width="</span> + width + <span class="hljs-string">",height="</span> + height + <span class="hljs-string">",toolbar=no,status=no,directories=no,menubar=no,resizable=yes,scrollbars=1"</span>;
    popupOpen(url, name, width, height, features, <span class="hljs-literal">true</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">popupOpenEmailClient</span>(<span class="hljs-params">url</span>) </span>{
    <span class="hljs-keyword">var</span> width = <span class="hljs-number">875</span>;
    <span class="hljs-keyword">var</span> height = <span class="hljs-number">575</span>;
    <span class="hljs-keyword">var</span> features = <span class="hljs-string">"width="</span> + width + <span class="hljs-string">",height="</span> + height + <span class="hljs-string">",toolbar=no,status=no,directories=no,menubar=no,resizable=yes,scrollbars=1"</span>;
    popupOpenFocus(url, <span class="hljs-string">"Email_Client"</span>, width, height, features, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">popupOpen</span>(<span class="hljs-params">url, name, pWidth, pHeight, features, snapToLastMousePosition</span>) </span>{
    popupOpenFocus(url, name, pWidth, pHeight, features, snapToLastMousePosition, <span class="hljs-literal">true</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">popupOpenFocus</span>(<span class="hljs-params">url, name, pWidth, pHeight, features, snapToLastMousePosition, closeOnLoseFocus</span>) </span>{
    popupClose();
    <span class="hljs-keyword">if</span> (url.indexOf(<span class="hljs-string">"?"</span>) != <span class="hljs-number">-1</span>)
        url += <span class="hljs-string">"&amp;"</span>;
    <span class="hljs-keyword">else</span>
        url += <span class="hljs-string">"?"</span>;
    url += <span class="hljs-string">"sysparm_domain_restore=false"</span>;
    <span class="hljs-keyword">var</span> domain = gel(<span class="hljs-string">"sysparm_domain"</span>);
    <span class="hljs-keyword">if</span> (domain)
        url += <span class="hljs-string">"&amp;sysparm_domain="</span> + domain.value;
    <span class="hljs-keyword">if</span> (url.indexOf(<span class="hljs-string">"sysparm_nameofstack"</span>) == <span class="hljs-number">-1</span>)
        url += <span class="hljs-string">"&amp;sysparm_stack=no"</span>;
    <span class="hljs-keyword">if</span> (snapToLastMousePosition) {
        <span class="hljs-keyword">if</span> (lastMouseX - pWidth &lt; <span class="hljs-number">0</span>) {
            lastMouseX = pWidth;
        }
        <span class="hljs-keyword">if</span> (lastMouseY + pHeight &gt; screen.height) {
            lastMouseY -= (lastMouseY + pHeight + <span class="hljs-number">50</span>) - screen.height;
        }
        lastMouseX -= pWidth;
        lastMouseY += <span class="hljs-number">10</span>;
        features += <span class="hljs-string">",screenX="</span> + lastMouseX + <span class="hljs-string">",left="</span> + lastMouseX + <span class="hljs-string">",screenY="</span> + lastMouseY + <span class="hljs-string">",top="</span> + lastMouseY;
    }
    <span class="hljs-keyword">if</span> (closeOnLoseFocus) {
        popupCurrent = <span class="hljs-built_in">window</span>.open(url, name, features, <span class="hljs-literal">false</span>);
        <span class="hljs-keyword">if</span> (!popupCurrent) {
            alert(<span class="hljs-string">'Please disable your popup blocker to use this feature'</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        } <span class="hljs-keyword">else</span> {
            popupCurrent.focus();
            popupCurrent.opener = <span class="hljs-built_in">window</span>.self;
            <span class="hljs-keyword">return</span> popupCurrent;
        }
    } <span class="hljs-keyword">else</span> {
        popupCurrent = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">var</span> win = <span class="hljs-built_in">window</span>.open(url, name, features, <span class="hljs-literal">false</span>);
        <span class="hljs-keyword">if</span> (win) {
            win.focus();
            win.opener = <span class="hljs-built_in">window</span>.self;
        }
        <span class="hljs-keyword">return</span> win;
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">xmlView</span>(<span class="hljs-params">ref, id</span>) </span>{
    <span class="hljs-keyword">var</span> mytable = ref.split(<span class="hljs-string">'.'</span>)[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">var</span> myfield = ref.substring(mytable.length + <span class="hljs-number">1</span>);
    <span class="hljs-keyword">var</span> w = <span class="hljs-number">700</span>;
    <span class="hljs-keyword">var</span> h = <span class="hljs-number">500</span>;
    <span class="hljs-keyword">var</span> url = <span class="hljs-keyword">new</span> GlideURL(mytable + <span class="hljs-string">".do"</span>);
    url.addParam(<span class="hljs-string">"sys_id"</span>, id);
    url.addParam(<span class="hljs-string">"sys_target"</span>, myfield);
    url.addParam(<span class="hljs-string">"XML"</span>, <span class="hljs-string">""</span>);
    popupOpen(url.getURL(), <span class="hljs-string">"xmlview"</span>, w, h,
        <span class="hljs-string">"width="</span> + w + <span class="hljs-string">",height="</span> + h + <span class="hljs-string">",toolbar=no,status=no,directories=no,menubar=no,resizable=yes,scrollbars=1"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">htmlView</span>(<span class="hljs-params">ref, id</span>) </span>{
    <span class="hljs-keyword">var</span> mytable = ref.split(<span class="hljs-string">'.'</span>)[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">var</span> myfield = ref.split(<span class="hljs-string">'.'</span>)[<span class="hljs-number">1</span>];
    <span class="hljs-keyword">var</span> w = <span class="hljs-number">1000</span>;
    <span class="hljs-keyword">var</span> h = <span class="hljs-number">500</span>;
    <span class="hljs-keyword">var</span> url = <span class="hljs-keyword">new</span> GlideURL(<span class="hljs-string">"diff_html_page.do"</span>);
    url.addParam(<span class="hljs-string">"sysparm_id"</span>, id);
    url.addParam(<span class="hljs-string">"sysparm_table"</span>, mytable);
    popupOpen(url.getURL(), <span class="hljs-string">"htmlview"</span>, w, h,
        <span class="hljs-string">"width="</span> + w + <span class="hljs-string">",height="</span> + h + <span class="hljs-string">",toolbar=no,status=no,directories=no,menubar=no,resizable=yes,scrollbars=1"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tearOffReference</span>(<span class="hljs-params">table, fieldName, view, navigate, refKey</span>) </span>{
    <span class="hljs-keyword">var</span> widget = gel(fieldName);
    <span class="hljs-keyword">if</span> (widget == <span class="hljs-literal">null</span>) {
        alert(<span class="hljs-string">'Tear off called for a non existent reference field'</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    <span class="hljs-keyword">var</span> sys_id = widget.value;
    <span class="hljs-keyword">if</span> (sys_id == <span class="hljs-literal">null</span> || sys_id == <span class="hljs-string">''</span>) {
        alert(<span class="hljs-string">'Please select a reference before trying to tear it off'</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    tearOff(table, sys_id, view, navigate, refKey);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tearOff</span>(<span class="hljs-params">table, sys_id, view, navigate, refKey</span>) </span>{
    <span class="hljs-keyword">var</span> key = sys_id;
    <span class="hljs-keyword">var</span> url = <span class="hljs-keyword">new</span> GlideURL(table + <span class="hljs-string">'.do'</span>);
    url.addParam(<span class="hljs-string">"sys_id"</span>, key);
    url.addParam(<span class="hljs-string">"sysparm_view"</span>, view);
    url.addParam(<span class="hljs-string">"sysparm_stack"</span>, <span class="hljs-string">"no"</span>);
    url.addParam(<span class="hljs-string">"sysparm_referring_url"</span>, <span class="hljs-string">"tear_off"</span>);
    <span class="hljs-keyword">if</span> (refKey)
        url.addParam(<span class="hljs-string">"sysparm_refkey"</span>, refKey);
    <span class="hljs-built_in">window</span>.open(url.getURL(), <span class="hljs-string">""</span>,
        <span class="hljs-string">"toolbar=no,menubar=no,personalbar=no,width=800,height=600,"</span> +
        <span class="hljs-string">"scrollbars=yes,resizable=yes"</span>);
    <span class="hljs-keyword">if</span> (navigate) {
        gsftSubmit(<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'sysverb_back'</span>));
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tearOffAttachment</span>(<span class="hljs-params">sys_id</span>) </span>{
    <span class="hljs-keyword">var</span> url = <span class="hljs-keyword">new</span> GlideURL(<span class="hljs-string">"sys_attachment.do"</span>);
    url.addParam(<span class="hljs-string">"sysparm_referring_url"</span>, <span class="hljs-string">"tear_off"</span>);
    url.addParam(<span class="hljs-string">"view"</span>, <span class="hljs-string">"true"</span>);
    url.addParam(<span class="hljs-string">"sys_id"</span>, sys_id);
    <span class="hljs-built_in">window</span>.open(url.getURL(), sys_id,
        <span class="hljs-string">"toolbar=no,menubar=no,personalbar=no,width=800,height=600,"</span> +
        <span class="hljs-string">"scrollbars=yes,resizable=yes"</span>);
};
<span class="hljs-comment">/*! RESOURCE: /scripts/doctype/condition14_new.js */</span>
NOW.msg = <span class="hljs-keyword">new</span> GwtMessage();
NOW.c14 = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">    "use strict"</span>;
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">setup</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
            name = name || firstTable;
            <span class="hljs-keyword">if</span> (!name) {
                alert(<span class="hljs-string">"Choose a table before adding filters"</span>);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
            g_current_table = name;
            columns = queueColumns[name];
            <span class="hljs-keyword">if</span> (!columns) {
                <span class="hljs-keyword">var</span> tname = (name.split(<span class="hljs-string">"."</span>))[<span class="hljs-number">0</span>];
                columns = queueColumns[tname];
                <span class="hljs-keyword">if</span> (!columns) {
                    columnsGet(name, setup);
                    columns = queueColumns[tname];
                    <span class="hljs-keyword">if</span> (columns == <span class="hljs-literal">null</span>)
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
                }
            }
            currentTable = name;
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        },
        <span class="hljs-attr">shouldShowDynamicReferenceOperator</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">type, elementDef, tableNameFull</span>) </span>{
            <span class="hljs-keyword">if</span> (type != <span class="hljs-string">"reference"</span> &amp;&amp; type != <span class="hljs-string">"string"</span> &amp;&amp; type != <span class="hljs-string">"journal_input"</span>)
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">window</span>.g_dynamic_filter_options)
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">var</span> table = elementDef.getReference();
            <span class="hljs-keyword">var</span> gotOne = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">var</span> arr = g_dynamic_filter_options.split(<span class="hljs-string">"##"</span>);
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) {
                <span class="hljs-keyword">var</span> aItem = arr[i];
                <span class="hljs-keyword">if</span> (aItem.length == <span class="hljs-number">0</span>)
                    <span class="hljs-keyword">continue</span>;
                <span class="hljs-keyword">var</span> aItemArr = aItem.split(<span class="hljs-string">"::"</span>);
                <span class="hljs-keyword">if</span> (aItemArr.length &lt; <span class="hljs-number">3</span>)
                    <span class="hljs-keyword">continue</span>;
                <span class="hljs-keyword">var</span> contextTableName = tableNameFull.split(<span class="hljs-string">"."</span>)[<span class="hljs-number">1</span>];
                <span class="hljs-keyword">var</span> isExclusive = <span class="hljs-keyword">typeof</span> gtf_exclusive_dynamics != <span class="hljs-string">'undefined'</span> &amp;&amp; gtf_exclusive_dynamics == <span class="hljs-string">'true'</span>;
                <span class="hljs-keyword">if</span> (!isExclusive &amp;&amp; table == aItemArr[<span class="hljs-number">2</span>] || contextTableName == aItemArr[<span class="hljs-number">3</span>]) {
                    gotOne = <span class="hljs-literal">true</span>;
                    <span class="hljs-keyword">break</span>;
                }
            }
            <span class="hljs-keyword">return</span> gotOne;
        },
        <span class="hljs-attr">enterKey</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
            <span class="hljs-keyword">if</span> (event.keyCode == <span class="hljs-number">13</span> || event.keyCode == <span class="hljs-number">3</span>) {
                <span class="hljs-keyword">var</span> timeout;
                <span class="hljs-keyword">if</span> (slushbucketDOMcheck()) {
                    <span class="hljs-keyword">var</span> elem = Event.element(getEvent(event)).up(<span class="hljs-string">".list_name"</span>);
                    <span class="hljs-keyword">if</span> (elem &amp;&amp; elem.getAttribute) {
                        <span class="hljs-keyword">var</span> name = elem.getAttribute(<span class="hljs-string">"name"</span>);
                        <span class="hljs-keyword">if</span> (name)
                            timeout = name + <span class="hljs-string">"acRequest();"</span>;
                    }
                    <span class="hljs-keyword">if</span> (!timeout)
                        timeout = <span class="hljs-string">"acRequest();"</span>;
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-keyword">var</span> name = listDOMcheck(Event.element(getEvent(event)));
                    <span class="hljs-keyword">if</span> (name)
                        timeout = <span class="hljs-string">"runFilter('"</span> + name + <span class="hljs-string">"');"</span>;
                }
                <span class="hljs-keyword">if</span> (timeout)
                    setTimeout(timeout, <span class="hljs-number">0</span>);
                Event.stop(event);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        },
        <span class="hljs-attr">setShowRelated</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName, idx, name, select, filter</span>) </span>{
            <span class="hljs-keyword">if</span> (fieldName == <span class="hljs-string">'...Show Related Fields...'</span>) {
                gotShowRelated = <span class="hljs-literal">true</span>;
                showRelated = <span class="hljs-string">'yes'</span>;
                setPreference(<span class="hljs-string">"filter.show_related"</span>, <span class="hljs-string">"yes"</span>);
            }
            <span class="hljs-keyword">if</span> (fieldName == <span class="hljs-string">'...Remove Related Fields...'</span>) {
                gotShowRelated = <span class="hljs-literal">true</span>;
                showRelated = <span class="hljs-string">'no'</span>;
                setPreference(<span class="hljs-string">"filter.show_related"</span>, <span class="hljs-string">"no"</span>);
            }
            <span class="hljs-keyword">var</span> f = fieldName.substring(<span class="hljs-number">0</span>, idx);
            <span class="hljs-keyword">if</span> (f != name)
                f = name + <span class="hljs-string">"."</span> + f;
            f += <span class="hljs-string">"."</span>;
            <span class="hljs-keyword">var</span> filterMethod;
            <span class="hljs-keyword">if</span> (filter &amp;&amp; !filter.getUseVariables())
                filterMethod = filter.filterFields.bind(filter);
            addFirstLevelFields(select, f, <span class="hljs-string">''</span>, filterMethod, fieldName);
            <span class="hljs-keyword">return</span> f;
        },
        <span class="hljs-attr">conditionColumnResponse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">columns, tableName, mfunc</span>) </span>{
            decodeFilter(tableName);
            queueFilters[tableName] = <span class="hljs-literal">null</span>;
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> mfunc === <span class="hljs-string">"function"</span>)
                mfunc(tableName);
        }
    }
})();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">slushbucketDOMcheck</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> epObject;
    <span class="hljs-keyword">if</span> (epObject = gel(<span class="hljs-string">"ep"</span>)) {
        <span class="hljs-keyword">var</span> tdArr = epObject.getElementsByTagName(<span class="hljs-string">"TD"</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> tdArrIndex = <span class="hljs-number">0</span>; tdArrIndex &lt; tdArr.length; tdArrIndex++) {
            <span class="hljs-keyword">if</span> (tdArr[tdArrIndex].className == <span class="hljs-string">"slushbody"</span>)
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">listDOMcheck</span>(<span class="hljs-params">el</span>) </span>{
    <span class="hljs-keyword">while</span> (el) {
        el = findParentByTag(el, <span class="hljs-string">"div"</span>);
        <span class="hljs-keyword">if</span> (!el)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">if</span> (el.id.endsWith(MAIN_LAYER))
            <span class="hljs-keyword">return</span> el.id.substring(<span class="hljs-number">0</span>, el.id.length - MAIN_LAYER.length);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setup</span>(<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">return</span> NOW.c14.setup(name);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getThing</span>(<span class="hljs-params">table, name</span>) </span>{
    <span class="hljs-keyword">var</span> thing = gel(table + name);
    <span class="hljs-keyword">if</span> (thing)
        <span class="hljs-keyword">return</span> thing;
    thing = gel(name);
    <span class="hljs-keyword">if</span> (thing)
        <span class="hljs-keyword">return</span> thing;
    <span class="hljs-keyword">if</span> (table != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">var</span> fperiod = table.indexOf(<span class="hljs-string">"."</span>);
        <span class="hljs-keyword">if</span> (fperiod &gt; <span class="hljs-number">0</span>) {
            table = table.substring(fperiod + <span class="hljs-number">1</span>);
            thing = gel(table + name);
        }
    }
    <span class="hljs-keyword">return</span> thing;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buildMap</span>(<span class="hljs-params">values, position</span>) </span>{
<span class="hljs-meta">    "use strict"</span>;
    <span class="hljs-keyword">var</span> keys = [];
    values.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">thisOp</span>) </span>{
        <span class="hljs-keyword">var</span> thisMsg = thisOp[position];
        keys.push(thisMsg);
    });
    <span class="hljs-keyword">return</span> keys;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_createFilterSelect</span>(<span class="hljs-params">width, multi</span>) </span>{
    <span class="hljs-keyword">var</span> s = cel(<span class="hljs-string">'select'</span>);
    s.className = <span class="hljs-string">"filerTableSelect"</span>;
    s.title = getMessage(<span class="hljs-string">"Choose Input"</span>);
    <span class="hljs-keyword">if</span> (width)
        s.style.width = width + <span class="hljs-string">"px"</span>;
    <span class="hljs-keyword">if</span> (multi) {
        s.multiple = <span class="hljs-literal">true</span>;
    } <span class="hljs-keyword">else</span> {
        s.className = s.className + <span class="hljs-string">' select2'</span>;
    }
    s.style.verticalAlign = <span class="hljs-string">"top"</span>;
    s.className += <span class="hljs-string">" form-control"</span>;
    <span class="hljs-keyword">return</span> s;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTableReference</span>(<span class="hljs-params">tableName, parentTable, isTemplate</span>) </span>{
    <span class="hljs-keyword">if</span> (firstTable == <span class="hljs-string">''</span>)
        firstTable = tableName;
    <span class="hljs-keyword">return</span> Table.get(tableName, parentTable, isTemplate);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">allowConditionsForJournal</span>(<span class="hljs-params">type, filter</span>) </span>{
    <span class="hljs-keyword">if</span> (type != <span class="hljs-string">"journal"</span> &amp;&amp; type != <span class="hljs-string">"journal_input"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (filter &amp;&amp; filter.type == <span class="hljs-string">"GlideTemplateFilter"</span> &amp;&amp; filter.allowJournal)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (!filter || filter.getUsageContext() != <span class="hljs-string">"element_conditions"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> ie = filter.getIncludeExtended();
    <span class="hljs-keyword">return</span> !!ie[<span class="hljs-string">"VALCHANGES"</span>];
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateFields</span>(<span class="hljs-params">name, select, fOper, fValue, includeExtended, filter</span>) </span>{
    <span class="hljs-keyword">if</span> (!NOW.c14.setup(name))
        <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> tableNameFull = name;
    name = currentTable;
    <span class="hljs-keyword">var</span> o = getSelectedOption(select);
    <span class="hljs-keyword">var</span> fieldName = o.value;
    name = name.split(<span class="hljs-string">"."</span>)[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">var</span> idx = fieldName.indexOf(<span class="hljs-string">"..."</span>);
    <span class="hljs-keyword">if</span> (idx != <span class="hljs-number">-1</span>)
        NOW.c14.setShowRelated(fieldName, idx, name, select, filter);
    name = currentTable = getTableFromOption(o);
    <span class="hljs-keyword">var</span> options = select.options;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; options.length; i++) {
        <span class="hljs-keyword">var</span> option = options[i];
        <span class="hljs-keyword">if</span> (optionWasSelected(option)) {
            option.innerHTML = getNormalLabel(option);
            option.style.color = <span class="hljs-string">'black'</span>;
            option.wasSelected = <span class="hljs-string">'false'</span>;
            <span class="hljs-keyword">break</span>;
        }
    }
    <span class="hljs-keyword">if</span> (!NOW.c14.setup(name))
        <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> tr = select.parentNode.parentNode;
    o.normalLabel = o.innerHTML;
    o.innerHTML = getFullLabel(o);
    o.style.color = <span class="hljs-string">'green'</span>;
    o.wasSelected = <span class="hljs-string">'true'</span>;
    $(select).addClassName(<span class="hljs-string">'filter_type'</span>);
    <span class="hljs-keyword">var</span> $select = $j(select);
    <span class="hljs-keyword">if</span> (!$select.data(<span class="hljs-string">'select2'</span>))
        $select.select2();
    buildFieldsPerType(name, tr, fieldName, fOper, fValue, includeExtended, tableNameFull, filter);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">columnsGet</span>(<span class="hljs-params">mft, nu</span>) </span>{
    loadFilterTableReference(mft);
    NOW.c14.conditionColumnResponse(columns, mft, nu);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">optionWasSelected</span>(<span class="hljs-params">option</span>) </span>{
    <span class="hljs-keyword">return</span> option.wasSelected === <span class="hljs-string">'true'</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFullLabel</span>(<span class="hljs-params">option</span>) </span>{
    <span class="hljs-keyword">return</span> option.fullLabel || <span class="hljs-string">""</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addOperators</span>(<span class="hljs-params">td, type, dValue, isChoice, includeExtended, showDynamicReferenceOperator, filterClass, restrictI18NOpers</span>) </span>{
    <span class="hljs-keyword">var</span> msg = NOW.msg;
    <span class="hljs-keyword">var</span> s = _createFilterSelect(<span class="hljs-string">"150"</span>);
    s.title = <span class="hljs-string">'choose operator'</span>;
    <span class="hljs-keyword">if</span> (td.parentNode.conditionObject)
        <span class="hljs-keyword">if</span> (td.parentNode.conditionObject.isPlaceHolder())
            s.disabled = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">var</span> opers;
    <span class="hljs-keyword">if</span> (isChoice)
        opers = sysopers[type + <span class="hljs-string">"_choice"</span>];
    <span class="hljs-keyword">var</span> translated = type == <span class="hljs-string">'translated_field'</span> || type == <span class="hljs-string">'translated_html'</span> || type == <span class="hljs-string">'translated_text'</span>;
    <span class="hljs-keyword">if</span> (!opers &amp;&amp; translated &amp;&amp; restrictI18NOpers)
        opers = sysopers[<span class="hljs-string">'translated_basic'</span>];
    <span class="hljs-keyword">if</span> (!opers &amp;&amp; sysopers[type])
        opers = sysopers[type];
    <span class="hljs-keyword">if</span> (type &amp;&amp; type.indexOf(<span class="hljs-string">':'</span>) &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">var</span> complexTypeArray = type.split(<span class="hljs-string">':'</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> != complexTypeArray[<span class="hljs-number">0</span>])
            opers = sysopers[complexTypeArray[<span class="hljs-number">0</span>]];
    }
    <span class="hljs-keyword">if</span> (!opers)
        opers = sysopers[<span class="hljs-string">'default'</span>];
    <span class="hljs-keyword">if</span> (noOps)
        dValue = <span class="hljs-string">'='</span>;
    <span class="hljs-keyword">if</span> (filterClass == <span class="hljs-string">"GlideTemplateFilter"</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> gtfOperators != <span class="hljs-string">'undefined'</span> &amp;&amp; gtfOperators.length != <span class="hljs-number">0</span>)
            opers = gtfOperators;
        <span class="hljs-keyword">else</span>
            opers = sysopers_template[<span class="hljs-string">'default'</span>];
    }
    <span class="hljs-keyword">var</span> keys = buildMap(opers, <span class="hljs-number">1</span>);
    map = msg.getMessages(keys);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> ii = <span class="hljs-number">0</span>; ii &lt; opers.length; ii++) {
        <span class="hljs-keyword">var</span> opInfo = opers[ii];
        <span class="hljs-keyword">if</span> (opInfo[<span class="hljs-number">0</span>] == <span class="hljs-string">'SINCE'</span>) {
            <span class="hljs-keyword">var</span> base = <span class="hljs-keyword">new</span> GlideRecord(<span class="hljs-string">'cmdb_baseline'</span>);
            base.query();
            <span class="hljs-keyword">if</span> (!base.hasNext())
                <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">if</span> (extopers[opInfo[<span class="hljs-number">0</span>]] &amp;&amp; !includeExtended[opInfo[<span class="hljs-number">0</span>]])
            <span class="hljs-keyword">continue</span>;
        <span class="hljs-keyword">if</span> (opInfo[<span class="hljs-number">0</span>] == <span class="hljs-string">"DYNAMIC"</span> &amp;&amp; !showDynamicReferenceOperator)
            <span class="hljs-keyword">continue</span>;
        addOption(s, opInfo[<span class="hljs-number">0</span>], map[opInfo[<span class="hljs-number">1</span>]], dValue &amp;&amp; opInfo[<span class="hljs-number">0</span>] == dValue);
    }
    <span class="hljs-keyword">var</span> so = getSelectedOption(s);
    <span class="hljs-keyword">if</span> (dValue &amp;&amp; (!so || so.value != dValue)) {
        addOption(s, dValue, msg.getMessage(dValue));
        s.selectedIndex = s.length - <span class="hljs-number">1</span>;
    }
    td.fieldType = <span class="hljs-string">"select"</span>;
    <span class="hljs-keyword">if</span> (so)
        td.currentOper = getSelectedOption(s).value;
    td.subType = type;
    td.appendChild(s);
    <span class="hljs-keyword">return</span> s;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTableFromOption</span>(<span class="hljs-params">option</span>) </span>{
    <span class="hljs-keyword">return</span> option.tableName || <span class="hljs-string">""</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isFilterExtension</span>(<span class="hljs-params">type</span>) </span>{
    <span class="hljs-keyword">return</span> g_filter_extension_map[type] != <span class="hljs-literal">undefined</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initFilterExtension</span>(<span class="hljs-params">type, tableName, elementDef</span>) </span>{
    <span class="hljs-keyword">var</span> o = g_filter_extension_map[type];
    <span class="hljs-keyword">return</span> o.call(<span class="hljs-keyword">this</span>, tableName, elementDef);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addTextInput</span>(<span class="hljs-params">td, dValue, type</span>) </span>{
    <span class="hljs-keyword">var</span> input = cel(<span class="hljs-string">"input"</span>);
    <span class="hljs-keyword">if</span> (type)
        input.type = type;
    <span class="hljs-keyword">if</span> (td.parentNode.conditionObject)
        <span class="hljs-keyword">if</span> (td.parentNode.conditionObject.isPlaceHolder())
            input.disabled = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (isMSIE) {
        input.onkeypress = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> NOW.c14.enterKey(event)
        }
    } <span class="hljs-keyword">else</span>
        input.onkeypress = NOW.c14.enterKey;
    td.fieldType = <span class="hljs-string">"input"</span>;
    <span class="hljs-keyword">if</span> (dValue)
        input.value = dValue;
    input.className = <span class="hljs-string">"filerTableInput form-control"</span>;
    input.title = <span class="hljs-string">'input value'</span>;
    <span class="hljs-keyword">if</span> (useTextareas) {
        input.style.width = <span class="hljs-string">"80%"</span>;
        input.style.resize = <span class="hljs-string">"vertical"</span>;
        input.maxlength = <span class="hljs-number">80</span>;
    }
    input.style.verticalAlign = <span class="hljs-string">"top"</span>;
    td.appendChild(input);
    <span class="hljs-keyword">return</span> input;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadFilterTableReference</span>(<span class="hljs-params">mft, isTemplate</span>) </span>{
    <span class="hljs-keyword">var</span> tablepart = mft.split(<span class="hljs-string">"."</span>)[<span class="hljs-number">0</span>];
    currentTable = mft;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> g_filter_description != <span class="hljs-string">'undefined'</span>)
        <span class="hljs-keyword">if</span> (g_filter_description.getMainFilterTable() == <span class="hljs-literal">null</span> ||
            g_filter_description.getMainFilterTable() == <span class="hljs-string">""</span>)
            g_filter_description.setMainFilterTable(mft);
    <span class="hljs-keyword">var</span> tableDef = getTableReference(tablepart, <span class="hljs-literal">null</span>, isTemplate);
    <span class="hljs-keyword">var</span> columns = tableDef.getColumns();
    queueColumns[mft] = columns;
    queueColumns[tablepart] = columns;
    <span class="hljs-keyword">return</span> tableDef;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decodeFilter</span>(<span class="hljs-params">tableName</span>) </span>{
    currentTable = tableName;
    <span class="hljs-keyword">var</span> query = queueFilters[tableName];
    queueFilters[tableName] = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">var</span> fDiv = getThing(tableName, <span class="hljs-string">'gcond_filters'</span>);
    <span class="hljs-keyword">if</span> (query == <span class="hljs-literal">null</span>) {
        query = fDiv.initialQuery;
        <span class="hljs-keyword">if</span> (query != <span class="hljs-literal">null</span> &amp;&amp; fDiv.filterObject != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">var</span> fo = fDiv.filterObject;
            <span class="hljs-keyword">if</span> (fo.isQueryProcessed())
                <span class="hljs-keyword">return</span>;
        }
    }
    <span class="hljs-keyword">var</span> runable = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> defaultPH = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">var</span> sync = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> filter = fDiv.filterObject;
    <span class="hljs-keyword">if</span> (filter) {
        <span class="hljs-keyword">if</span> (filter.tableName == tableName &amp;&amp; filter.query == query)
            <span class="hljs-keyword">return</span>;
        runable = filter.isRunable();
        defaultPH = filter.defaultPlaceHolder;
        sync = filter.synchronous;
        filter.destroy();
    }
    <span class="hljs-keyword">new</span> GlideFilter(tableName, query, <span class="hljs-literal">null</span>, runable, sync, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">filter</span>) </span>{
        filter.setDefaultPlaceHolder(defaultPH);
    });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">refreshFilter</span>(<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">var</span> fDiv = getThing(name, <span class="hljs-string">'gcond_filters'</span>);
    <span class="hljs-keyword">var</span> fQueries = fDiv.getElementsByTagName(<span class="hljs-string">"tr"</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; fQueries.length; i++) {
        <span class="hljs-keyword">var</span> queryTR = fQueries[i];
        <span class="hljs-keyword">if</span> (queryTR.queryPart != <span class="hljs-string">'true'</span>)
            <span class="hljs-keyword">continue</span>;
        <span class="hljs-keyword">var</span> queryID = queryTR.queryID;
        <span class="hljs-keyword">var</span> query = getThing(name, queryID);
        refreshQuery(query);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">refreshQuery</span>(<span class="hljs-params">query</span>) </span>{
        <span class="hljs-keyword">var</span> tableTRs = query.getElementsByTagName(<span class="hljs-string">"tr"</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>; i &lt; tableTRs.length; i++) {
            <span class="hljs-keyword">var</span> tr = tableTRs[i];
            <span class="hljs-keyword">if</span> (!tr)
                <span class="hljs-keyword">continue</span>;
            <span class="hljs-keyword">if</span> (tr.basePart != <span class="hljs-string">'true'</span>)
                <span class="hljs-keyword">continue</span>;
            <span class="hljs-keyword">var</span> fieldValue = tr.tdValue;
            refreshSelect(tr, fieldValue);
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">refreshSelect</span>(<span class="hljs-params">tr, td</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> td == <span class="hljs-string">'undefined'</span>)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">var</span> fType = td.fieldType ? td.fieldType : <span class="hljs-string">"select"</span>;
        <span class="hljs-keyword">var</span> tags = td.getElementsByTagName(fType);
        <span class="hljs-keyword">if</span> (tags == <span class="hljs-literal">null</span> || tags.length == <span class="hljs-number">0</span>)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">var</span> field = tags[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">if</span> (fType == <span class="hljs-string">"select"</span>) {
            <span class="hljs-keyword">if</span> (field.multiple == <span class="hljs-literal">true</span>) {
                <span class="hljs-keyword">var</span> choices = field.choices;
                choicesGet(tr.tableField, field, choices);
            }
        }
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNormalLabel</span>(<span class="hljs-params">option</span>) </span>{
    <span class="hljs-keyword">return</span> option.normalLabel || <span class="hljs-string">""</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFilter</span>(<span class="hljs-params">name, doEscape</span>) </span>{
    <span class="hljs-keyword">var</span> fullFilter = <span class="hljs-string">""</span>;
    orderBy = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">var</span> spanName = <span class="hljs-string">".encoded_query"</span>;
    <span class="hljs-keyword">var</span> fSpan = getThing(name, spanName);
    <span class="hljs-keyword">if</span> (fSpan)
        <span class="hljs-keyword">return</span> fSpan.innerHTML;
    <span class="hljs-keyword">var</span> divName = <span class="hljs-string">"gcond_filters"</span>;
    <span class="hljs-keyword">if</span> (fDiv)
        divName = fDiv + divName;
    <span class="hljs-keyword">var</span> fDiv = getThing(name, divName);
    <span class="hljs-keyword">if</span> (!fDiv)
        <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-string">'gcond_filters'</span> == divName)
        addOrderBy();
    <span class="hljs-keyword">var</span> fQueries = fDiv.getElementsByTagName(<span class="hljs-string">"tr"</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; fQueries.length; i++) {
        <span class="hljs-keyword">var</span> queryTR = fQueries[i];
        <span class="hljs-keyword">if</span> (queryTR.queryPart != <span class="hljs-string">'true'</span>)
            <span class="hljs-keyword">continue</span>;
        <span class="hljs-keyword">var</span> queryID = queryTR.queryID;
        <span class="hljs-keyword">var</span> query = getThing(name, queryID);
        filter = <span class="hljs-string">""</span>;
        <span class="hljs-keyword">var</span> queryString = getQueryString(query);
        <span class="hljs-keyword">if</span> (fullFilter.length &gt; <span class="hljs-number">0</span> &amp;&amp; queryString.length &gt; <span class="hljs-number">0</span>)
            fullFilter += <span class="hljs-string">"^NQ"</span>;
        fullFilter = fullFilter + queryString;
    }
    <span class="hljs-keyword">if</span> (fullFilter.length &gt; <span class="hljs-number">0</span>)
        fullFilter += <span class="hljs-string">"^EQ"</span>;
    fullFilter += orderBy;
    filter = fullFilter;
    <span class="hljs-keyword">if</span> (doEscape)
        filter = <span class="hljs-built_in">encodeURIComponent</span>(filter);
    <span class="hljs-keyword">return</span> filter;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addOrderBy</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">        'use strict'</span>;
        <span class="hljs-keyword">var</span> fDiv = $(<span class="hljs-string">'gcond_sort_order'</span>);
        <span class="hljs-keyword">if</span> (!fDiv)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">var</span> fQueries = fDiv.getElementsByTagName(<span class="hljs-string">"tr"</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; fQueries.length; i++) {
            <span class="hljs-keyword">var</span> queryTR = fQueries[i];
            <span class="hljs-keyword">if</span> (queryTR.queryPart != <span class="hljs-string">'true'</span>)
                <span class="hljs-keyword">continue</span>;
            <span class="hljs-keyword">var</span> queryID = queryTR.queryID;
            <span class="hljs-keyword">var</span> query = getThing(name, queryID);
            <span class="hljs-keyword">if</span> (!query)
                <span class="hljs-keyword">continue</span>;
            getQueryString(query);
        }
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getQueryString</span>(<span class="hljs-params">query</span>) </span>{
    <span class="hljs-keyword">var</span> tableTRs = query.getElementsByTagName(<span class="hljs-string">"tr"</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; tableTRs.length; i++) {
        <span class="hljs-keyword">var</span> tr = tableTRs[i];
        <span class="hljs-keyword">if</span> (!tr)
            <span class="hljs-keyword">continue</span>;
        <span class="hljs-keyword">if</span> (tr.basePart != <span class="hljs-string">'true'</span>)
            <span class="hljs-keyword">continue</span>;
        getQueryForTR(tr);
    }
    <span class="hljs-keyword">return</span> filter;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getQueryForTR</span>(<span class="hljs-params">trItem</span>) </span>{
<span class="hljs-meta">    "use strict"</span>;
    <span class="hljs-keyword">var</span> trs = trItem.getElementsByTagName(<span class="hljs-string">"tr"</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; trs.length; i++) {
        <span class="hljs-keyword">var</span> tr = trs[i];
        <span class="hljs-keyword">var</span> field = getTDFieldValue(tr.tdField);
        <span class="hljs-keyword">if</span> (field == PLACEHOLDER || !tr.operSel)
            <span class="hljs-keyword">continue</span>;
        <span class="hljs-keyword">var</span> oper = getSelectedOption(tr.operSel).value;
        <span class="hljs-keyword">if</span> (!tr.sortSpec &amp;&amp; !tr.aggSpec) {
            <span class="hljs-keyword">var</span> filterPart = getTRFilter(tr, field, oper);
            <span class="hljs-keyword">if</span> (filter.length &gt; <span class="hljs-number">0</span>)
                filter += <span class="hljs-string">"^"</span>;
            <span class="hljs-keyword">if</span> (tr.gotoPart)
                filter += <span class="hljs-string">"GOTO"</span>;
            <span class="hljs-keyword">if</span> (i != <span class="hljs-number">0</span>)
                filter += <span class="hljs-string">"OR"</span>;
            filter += filterPart;
            <span class="hljs-keyword">var</span> ips = tr.getElementsByTagName(<span class="hljs-string">"input"</span>);
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> ti = <span class="hljs-number">0</span>; ti &lt; ips.length; ti++) {
                <span class="hljs-keyword">var</span> iput = ips[ti];
                <span class="hljs-keyword">if</span> (iput.type == <span class="hljs-string">"hidden"</span> &amp;&amp; iput.name == <span class="hljs-string">"subcon"</span>) {
                    filter += <span class="hljs-string">"^"</span> + iput.jop + iput.field + iput.oper +
                        iput.value;
                }
            }
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!tr.aggSpec) {
            <span class="hljs-keyword">if</span> (oper == <span class="hljs-string">'ascending'</span>)
                orderBy += <span class="hljs-string">"^"</span> + <span class="hljs-string">"ORDERBY"</span> + field;
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (oper == <span class="hljs-string">'descending'</span>)
                orderBy += <span class="hljs-string">"^"</span> + <span class="hljs-string">"ORDERBYDESC"</span> + field;
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTDFieldValue</span>(<span class="hljs-params">td</span>) </span>{
        <span class="hljs-keyword">if</span> (!td) {
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">var</span> fType = td.fieldType || <span class="hljs-string">"select"</span>;
        <span class="hljs-keyword">var</span> field = td.getElementsByTagName(fType)[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">if</span> (fType != <span class="hljs-string">"select"</span>)
            <span class="hljs-keyword">return</span> field.value;
        <span class="hljs-keyword">var</span> options = field.options;
        <span class="hljs-keyword">if</span> (!field.multiple)
            <span class="hljs-keyword">return</span> options[field.selectedIndex].value;
        <span class="hljs-keyword">var</span> retVal = [];
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; options.length; i++) {
            <span class="hljs-keyword">if</span> (options[i].selected)
                retVal[retVal.length] = options[i].value;
        }
        <span class="hljs-keyword">return</span> retVal.join(<span class="hljs-string">","</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTRFilter</span>(<span class="hljs-params">tr, field, oper</span>) </span>{
        <span class="hljs-keyword">if</span> (tr.handler) {
            <span class="hljs-keyword">var</span> answer = tr.handler.getFilterText(oper);
            <span class="hljs-keyword">if</span> (answer != <span class="hljs-string">''</span>)
                <span class="hljs-keyword">return</span> answer;
            <span class="hljs-keyword">var</span> val = tr.handler.getValues();
            <span class="hljs-keyword">if</span> (oper == <span class="hljs-string">'SINCE'</span>)
                oper = <span class="hljs-string">'&gt;'</span>;
        }
        <span class="hljs-keyword">return</span> field + oper + escapeEmbeddedQueryTermSeparator(val);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">escapeEmbeddedQueryTermSeparator</span>(<span class="hljs-params">val</span>) </span>{
        <span class="hljs-keyword">return</span> val.replace(<span class="hljs-regexp">/(\w)\^(\w)/g</span>, <span class="hljs-string">"$1^^$2"</span>);
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deleteFilterByID</span>(<span class="hljs-params">tablename, id</span>) </span>{
    <span class="hljs-keyword">var</span> td = getThing(tablename, id);
    deleteTD(tablename, td);
    _frameChanged();

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deleteTD</span>(<span class="hljs-params">tableName, butTD</span>) </span>{
        <span class="hljs-keyword">var</span> butTR = butTD.parentNode;
        <span class="hljs-keyword">var</span> orTR = butTR.previousSibling;
        <span class="hljs-keyword">if</span> (butTR.conditionObject)
            butTR.conditionObject.remove();
        <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">var</span> parent = butTR.parentNode;
            <span class="hljs-keyword">if</span> (parent.conditionObject) {
                parent.conditionObject.remove();
            }
        }
        <span class="hljs-keyword">if</span> (orTR &amp;&amp; $(orTR).hasClassName(<span class="hljs-string">'orRow'</span>)) {
            orTR.remove();
        }
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buildFieldsPerType</span>(<span class="hljs-params">tableName, tr, descriptorName, fOper, fValue, includeExtended, tableNameFull, filter</span>) </span>{
    <span class="hljs-keyword">var</span> filterClass = filter.type;
    <span class="hljs-keyword">var</span> isTemplate = filter.isTemplate;
    <span class="hljs-keyword">var</span> tableName = tableName.split(<span class="hljs-string">"."</span>)[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">var</span> tableDef = getTableReference(tableName, <span class="hljs-literal">null</span>, isTemplate);
    <span class="hljs-keyword">if</span> (!tableDef)
        <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> supportsMapping = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (filter) {
        supportsMapping = filter.elementSupportsMapping;
    }
    <span class="hljs-keyword">var</span> type;
    <span class="hljs-keyword">var</span> multi;
    <span class="hljs-keyword">var</span> isChoice;
    <span class="hljs-keyword">var</span> restrictI18NOpers;
    <span class="hljs-keyword">var</span> msg = NOW.msg;
    <span class="hljs-keyword">var</span> usingEnglish = g_lang == <span class="hljs-string">'en'</span>;
    <span class="hljs-keyword">var</span> parts = descriptorName.split(<span class="hljs-string">'.'</span>);
    descriptorName = parts[parts.length - <span class="hljs-number">1</span>];
    <span class="hljs-keyword">var</span> elementDef = tableDef.getElement(descriptorName);
    <span class="hljs-keyword">if</span> (elementDef == <span class="hljs-literal">null</span> &amp;&amp; tableDef.glide_var)
        elementDef = tableDef.getElement(parts[parts.length - <span class="hljs-number">2</span>] + <span class="hljs-string">"."</span> + parts[parts.length - <span class="hljs-number">1</span>]);
    <span class="hljs-keyword">if</span> (elementDef == <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">if</span> (descriptorName != TEXTQUERY &amp;&amp; descriptorName != PLACEHOLDER)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">if</span> (descriptorName == TEXTQUERY) {
            type = <span class="hljs-string">'keyword'</span>;
            multi = <span class="hljs-literal">true</span>;
            isChoice = <span class="hljs-literal">false</span>;
        } <span class="hljs-keyword">else</span> {
            type = <span class="hljs-string">'placeholder'</span>;
            multi = <span class="hljs-literal">false</span>;
            isChoice = <span class="hljs-literal">false</span>;
            fValue = msg.getMessage(<span class="hljs-string">'-- value --'</span>);
        }
    } <span class="hljs-keyword">else</span> {
        type = elementDef.getType();
        multi = elementDef.getMulti();
        isChoice = elementDef.isChoice();
        restrictI18NOpers = !usingEnglish &amp;&amp; !elementDef.canSortI18N();
        <span class="hljs-keyword">if</span> (!elementDef.getBooleanAttribute(<span class="hljs-string">"canmatch"</span>)) {
            <span class="hljs-keyword">if</span> (type != <span class="hljs-string">"variables"</span> &amp;&amp; type != <span class="hljs-string">"related_tags"</span>)
                type = <span class="hljs-string">"string_clob"</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (elementDef.isEdgeEncrypted())
            type = elementDef.canSort() ? <span class="hljs-string">"edgeEncryptionOrder"</span> : <span class="hljs-string">"edgeEncryptionEq"</span>;
    }
    <span class="hljs-keyword">var</span> tdOperator = tr.tdOper;
    <span class="hljs-keyword">var</span> tdValue = tr.tdValue;
    tr.varType = type;
    tr.gotoPart = gotoPart;
    <span class="hljs-keyword">if</span> (tr.handler)
        tr.handler.destroy();
    tr.handler = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">if</span> (tr.sortSpec == <span class="hljs-literal">true</span>) {
        tr.varType = <span class="hljs-string">'sortspec'</span>;
        type = <span class="hljs-string">'sortspec'</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tr.aggSpec == <span class="hljs-literal">true</span>) {
        tr.varType = <span class="hljs-string">'aggspec'</span>;
        type = <span class="hljs-string">'aggspec'</span>;
    }
    <span class="hljs-keyword">if</span> (elementDef != <span class="hljs-literal">null</span> &amp;&amp; tableDef.glide_var)
        tr.tableField = elementDef.tableName + <span class="hljs-string">"."</span> + descriptorName;
    <span class="hljs-keyword">else</span>
        tr.tableField = tableName + <span class="hljs-string">"."</span> + descriptorName;
    tdOperator.innerHTML = <span class="hljs-string">""</span>;
    tdValue.innerHTML = <span class="hljs-string">""</span>;
    tdValue.style.minWidth = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">if</span> (type == <span class="hljs-string">"float"</span>)
        type = <span class="hljs-string">"integer"</span>;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type == <span class="hljs-string">'domain_number'</span>)
        type = <span class="hljs-string">"integer"</span>;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type == <span class="hljs-string">"wide_text"</span> || type == <span class="hljs-string">"ref_ext"</span> || type == <span class="hljs-string">"sc_email"</span> || type == <span class="hljs-string">"sc_url"</span>)
        type = <span class="hljs-string">"string"</span>;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (dateTypes[type]) {
        type = <span class="hljs-string">"calendar"</span>;
        <span class="hljs-keyword">if</span> (fValue &amp;&amp; fValue.indexOf(<span class="hljs-string">"datePart"</span>) &gt; <span class="hljs-number">-1</span>)
            fOper = <span class="hljs-string">'DATEPART'</span>;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (fValue &amp;&amp; (fValue.indexOf(<span class="hljs-string">'getBaseFilter'</span>) &gt; <span class="hljs-number">0</span>))
            fOper = <span class="hljs-string">"SINCE"</span>;
    }
    <span class="hljs-keyword">var</span> showDynamicReferenceOperator = NOW.c14.shouldShowDynamicReferenceOperator(type, elementDef, tableNameFull);
    <span class="hljs-keyword">var</span> operSel = addOperators(tdOperator, type, fOper, isChoice, includeExtended,
        showDynamicReferenceOperator, filterClass, restrictI18NOpers);
    <span class="hljs-keyword">if</span> (operSel) {
        operSel.observe(<span class="hljs-string">'change'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> form = operSel.up(<span class="hljs-string">'form'</span>);
            <span class="hljs-keyword">if</span> (form) {
                <span class="hljs-keyword">var</span> nameWithoutTablePrefix = tableNameFull.substring(tableNameFull.indexOf(<span class="hljs-string">"."</span>) + <span class="hljs-number">1</span>);
                form.fire(<span class="hljs-string">"glideform:onchange"</span>, {
                    <span class="hljs-attr">id</span>: nameWithoutTablePrefix,
                    <span class="hljs-attr">value</span>: <span class="hljs-built_in">unescape</span>(getFilter(tableNameFull)),
                    <span class="hljs-attr">modified</span>: <span class="hljs-literal">true</span>
                });
            }
        });
    }
    tr.operSel = operSel;
    <span class="hljs-keyword">if</span> (fOper == <span class="hljs-literal">null</span> &amp;&amp; operSel)
        fOper = tdOperator.currentOper;
    tr.setAttribute(<span class="hljs-string">"type"</span>, type);
    <span class="hljs-keyword">if</span> (tableNameFull.endsWith(<span class="hljs-string">".var_map"</span>)) {
        tr.handler = <span class="hljs-keyword">new</span> GlideFilterVariableMap(tableName, elementDef);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((type == <span class="hljs-string">"boolean"</span>) || (type == <span class="hljs-string">'string_boolean'</span>)) {
        tr.handler = <span class="hljs-keyword">new</span> GlideFilterChoice(tableName, elementDef);
        <span class="hljs-keyword">var</span> keys = [];
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; sysvalues[type].length; i++)
            keys.push(sysvalues[type][i][<span class="hljs-number">0</span>]);
        <span class="hljs-keyword">var</span> map = msg.getMessages(keys);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; sysvalues[type].length; i++) {
            <span class="hljs-keyword">var</span> v = sysvalues[type][i][<span class="hljs-number">0</span>];
            sysvalues[type][i][<span class="hljs-number">1</span>] = map[v];
        }
        tr.handler.setChoices(sysvalues[type]);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type == <span class="hljs-string">'calendar'</span>)
        tr.handler = <span class="hljs-keyword">new</span> GlideFilterDate(tableName, elementDef, filter.mappingId);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type == <span class="hljs-string">"reference"</span>) {
        tr.handler = <span class="hljs-keyword">new</span> GlideFilterReference(tableName, elementDef);
        tr.handler.setOriginalTable(tableNameFull);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type == <span class="hljs-string">"related_tags"</span>) {
        tr.handler = <span class="hljs-keyword">new</span> GlideFilterLabels(tableName, elementDef);
        tr.handler.setOriginalTable(tableNameFull);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type == <span class="hljs-string">"variables"</span>) {
        <span class="hljs-keyword">if</span> (tableName == <span class="hljs-string">'sc_task'</span>)
            tr.handler = <span class="hljs-keyword">new</span> GlideFilterItemVariables(tableName, elementDef);
        <span class="hljs-keyword">else</span>
            tr.handler = <span class="hljs-keyword">new</span> GlideFilterVariables(tableName, elementDef);
        tr.handler.setOriginalTable(tableNameFull);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type == <span class="hljs-string">"questions"</span>) {
        tr.handler = <span class="hljs-keyword">new</span> GlideFilterQuestions(tableName, elementDef);
        tr.handler.setOriginalTable(tableNameFull);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type == <span class="hljs-string">"glide_list"</span>)
        tr.handler = tableNameFull.endsWith(<span class="hljs-string">".template"</span>) ?
        <span class="hljs-keyword">new</span> GlideFilterReferenceMulti(tableName, elementDef) :
        <span class="hljs-keyword">new</span> GlideFilterReference(tableName, elementDef);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type == <span class="hljs-string">'sortspec'</span> || type == <span class="hljs-string">'aggspec'</span>) {} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type == <span class="hljs-string">'mask_code'</span> || isChoice)
        tr.handler = <span class="hljs-keyword">new</span> GlideFilterChoiceDynamic(tableName, elementDef);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type == <span class="hljs-string">'glide_duration'</span> || type == <span class="hljs-string">'timer'</span>)
        tr.handler = <span class="hljs-keyword">new</span> GlideFilterDuration(tableName, elementDef);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isFilterExtension(type))
        tr.handler = initFilterExtension(type, tableName, elementDef);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((multi == <span class="hljs-string">'yes'</span>) &amp;&amp; (useTextareas)) {
        tr.setAttribute(<span class="hljs-string">"isMulti"</span>, <span class="hljs-string">"true"</span>);
        tr.handler = <span class="hljs-keyword">new</span> GlideFilterStringMulti(tableName, elementDef);
        tr.handler.setOriginalTable(tableNameFull);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type == <span class="hljs-string">'integer'</span>)
        tr.handler = <span class="hljs-keyword">new</span> GlideFilterNumber(tableName, elementDef);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type == <span class="hljs-string">'currency'</span> || type == <span class="hljs-string">'price'</span>)
        tr.handler = <span class="hljs-keyword">new</span> GlideFilterCurrency(tableName, elementDef);
    <span class="hljs-keyword">else</span> {
        tr.setAttribute(<span class="hljs-string">"isMulti"</span>, <span class="hljs-string">"false"</span>);
        tr.handler = <span class="hljs-keyword">new</span> GlideFilterString(tableName, elementDef);
        tr.handler.setOriginalTable(tableNameFull);
    }
    <span class="hljs-keyword">if</span> (tr.handler) {
        tr.handler.setFilterClass(filterClass);
        tr.handler.create(tr, fValue);
    }
    <span class="hljs-keyword">if</span> (tr.handler)
        tr.handler.initMappingSupport(supportsMapping, type, (filter &amp;&amp; filter.mappingMgr));
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addFirstLevelFields</span>(<span class="hljs-params">s, target, fValue, filterMethod, fieldName, filter</span>) </span>{
<span class="hljs-meta">    "use strict"</span>;
    <span class="hljs-keyword">var</span> isTemplate = filter &amp;&amp; filter.isTemplate;
    <span class="hljs-keyword">var</span> forFilter;
    <span class="hljs-keyword">var</span> onlyRestrictedFields;
    <span class="hljs-keyword">if</span> (filter) {
        forFilter = filter.getOpsWanted();
        onlyRestrictedFields = filter.onlyRestrictedFields;
    }
    <span class="hljs-keyword">var</span> messages = getMessages(MESSAGES_CONDITION_RELATED_FILES);
    s.options.length = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (!gotShowRelated) {
        gotShowRelated = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> g_filter_description != <span class="hljs-string">'undefined'</span>)
            showRelated = g_filter_description.getShowRelated();
        <span class="hljs-keyword">else</span>
            showRelated = getPreference(<span class="hljs-string">"filter.show_related"</span>);
    }
    <span class="hljs-keyword">var</span> placeholder = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> selindex = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">var</span> indentLabel = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> savedItems = {};
    <span class="hljs-keyword">var</span> savedLabels = [];
    <span class="hljs-keyword">var</span> labelPrefix = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">var</span> headersAdded = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> parts = target.split(<span class="hljs-string">"."</span>);
    <span class="hljs-keyword">var</span> tableName = parts[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">var</span> tableDef = getTableReference(tableName, <span class="hljs-literal">null</span>, isTemplate);
    <span class="hljs-keyword">var</span> extension = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">var</span> prefix = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">if</span> (parts.length &gt; <span class="hljs-number">1</span> &amp;&amp; parts[<span class="hljs-number">1</span>] != <span class="hljs-literal">null</span> &amp;&amp; parts[<span class="hljs-number">1</span>] != <span class="hljs-string">''</span>)
        <span class="hljs-keyword">var</span> elementDef = fixParts();
    columns = tableDef.getColumns();
    queueColumns[tableDef.getName()] = columns;
    <span class="hljs-keyword">var</span> textIndex = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (!noOps &amp;&amp; !indentLabel) {
        <span class="hljs-keyword">var</span> root = columns.getElementsByTagName(<span class="hljs-string">"xml"</span>);
        <span class="hljs-keyword">if</span> (root &amp;&amp; root.length == <span class="hljs-number">1</span>) {
            root = root[<span class="hljs-number">0</span>];
            textIndex = root.getAttribute(<span class="hljs-string">"textIndex"</span>);
        }
    }
    <span class="hljs-keyword">var</span> items = (extension != <span class="hljs-string">''</span>) ? tableDef.getTableElements(extension) : tableDef.getElements();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
        <span class="hljs-keyword">var</span> item = items[i];
        <span class="hljs-keyword">var</span> t = item.getName();
        <span class="hljs-keyword">if</span> (filterMethod &amp;&amp; t != fValue) {
            <span class="hljs-keyword">if</span> (!filterMethod(item))
                <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">var</span> t = item.getName();
        <span class="hljs-keyword">if</span> (prefix != <span class="hljs-string">''</span>)
            t = prefix + <span class="hljs-string">'.'</span> + t;
        <span class="hljs-keyword">if</span> (!noOps &amp;&amp; item.getAttribute(<span class="hljs-string">"filterable"</span>) == <span class="hljs-string">"no"</span> &amp;&amp;
            !allowConditionsForJournal(item.getAttribute(<span class="hljs-string">"type"</span>), filter))
            <span class="hljs-keyword">continue</span>;
        <span class="hljs-keyword">if</span> (!item.canRead()) {
            <span class="hljs-keyword">if</span> (t != fValue)
                <span class="hljs-keyword">continue</span>;
            item.setCanRead(<span class="hljs-string">'yes'</span>);
        }
        <span class="hljs-keyword">if</span> (!item.isActive()) {
            <span class="hljs-keyword">if</span> (t != fValue)
                <span class="hljs-keyword">continue</span>;
            item.setActive(<span class="hljs-string">'yes'</span>);
        }
        <span class="hljs-keyword">var</span> label = item.getLabel();
        <span class="hljs-keyword">if</span> (!elementDef || elementDef.getType() != <span class="hljs-string">"glide_var"</span>) {
            savedItems[label] = t;
            savedLabels.push(label);
        }
        <span class="hljs-keyword">if</span> (item.isReference() &amp;&amp; !item.isRefRotated() &amp;&amp;
            item.getType() != <span class="hljs-string">'glide_list'</span> &amp;&amp; filterExpanded &amp;&amp;
            showRelated == <span class="hljs-string">'yes'</span>) {
            label += <span class="hljs-string">"  "</span> + item.getRefLabel();
            label += <span class="hljs-string">" "</span> + messages[<span class="hljs-string">'lowercase_fields'</span>];
            t += <span class="hljs-string">"..."</span>;
            savedItems[label] = t;
            savedLabels.push(label);
        }
    }
    items = tableDef.getExtensions();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
        <span class="hljs-keyword">var</span> item = items[i];
        <span class="hljs-keyword">var</span> label = item.getLabel() + <span class="hljs-string">" (+)"</span>;
        t = item.getExtName() + <span class="hljs-string">"..."</span>;
        <span class="hljs-keyword">if</span> (prefix != <span class="hljs-string">''</span>)
            t = prefix + <span class="hljs-string">'.'</span> + t;
        savedItems[label] = t;
        savedLabels.push(label);
    }
    <span class="hljs-keyword">if</span> (!onlyRestrictedFields &amp;&amp;
        ((fValue == TEXTQUERY || textIndex) &amp;&amp; filterMethod == <span class="hljs-literal">null</span> || forFilter)) {
        o = addOption(s, TEXTQUERY, messages[<span class="hljs-string">'Keywords'</span>], (fValue == TEXTQUERY));
        o.fullLabel = messages[<span class="hljs-string">'Keywords'</span>];
    }
    savedLabels.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">sname</span>) </span>{
        <span class="hljs-keyword">var</span> o = addOption(s, savedItems[sname], sname, savedItems[sname] == fValue);
        o.tableName = tableDef.getName();
        <span class="hljs-keyword">if</span> (labelPrefix != <span class="hljs-string">''</span>)
            o.fullLabel = labelPrefix + <span class="hljs-string">"."</span> + sname;
        <span class="hljs-keyword">else</span>
            o.fullLabel = sname;
        <span class="hljs-keyword">if</span> (indentLabel)
            o.innerHTML = <span class="hljs-string">"&amp;nbsp;&amp;nbsp;&amp;nbsp;"</span> + o.innerHTML;
        <span class="hljs-keyword">if</span> (o.value.indexOf(<span class="hljs-string">"..."</span>) != <span class="hljs-number">-1</span>)
            <span class="hljs-keyword">if</span> (o.fullLabel.indexOf(<span class="hljs-string">"(+)"</span>) == <span class="hljs-number">-1</span>)
                o.style.color = <span class="hljs-string">'blue'</span>;
            <span class="hljs-keyword">else</span>
                o.style.color = <span class="hljs-string">'darkred'</span>;
    });
    <span class="hljs-keyword">if</span> (filterExpanded &amp;&amp; !onlyRestrictedFields) {
        <span class="hljs-keyword">if</span> (showRelated != <span class="hljs-string">'yes'</span>)
            <span class="hljs-keyword">var</span> o = addOption(s, <span class="hljs-string">"...Show Related Fields..."</span>, messages[<span class="hljs-string">'Show Related Fields'</span>], <span class="hljs-literal">false</span>);
        <span class="hljs-keyword">else</span>
            o = addOption(s, <span class="hljs-string">"...Remove Related Fields..."</span>, messages[<span class="hljs-string">'Remove Related Fields'</span>], <span class="hljs-literal">false</span>);
        o.style.color = <span class="hljs-string">'blue'</span>;
    }
    <span class="hljs-keyword">if</span> (!placeholder &amp;&amp; (s.selectedIndex == <span class="hljs-number">0</span> &amp;&amp; ((textIndex &amp;&amp; fValue != TEXTQUERY) || headersAdded)))
        s.selectedIndex = selindex;
    <span class="hljs-keyword">return</span> s;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fixParts</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> o = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">if</span> (filterExpanded &amp;&amp; parts.length &gt; <span class="hljs-number">2</span>) {
            <span class="hljs-keyword">var</span> tableLabel = tableDef.getLabel();
            <span class="hljs-keyword">if</span> (tableLabel == <span class="hljs-literal">null</span>)
                tableLabel = <span class="hljs-string">"Parent"</span>;
            o = addOption(s, tableDef.getName() + <span class="hljs-string">"..."</span>, tableLabel + <span class="hljs-string">" "</span> + messages[<span class="hljs-string">'lowercase_fields'</span>], <span class="hljs-literal">false</span>);
            o.tableName = tableDef.getName();
            o.style.color = <span class="hljs-string">'blue'</span>;
        }
        <span class="hljs-keyword">if</span> (parts[<span class="hljs-number">1</span>] == PLACEHOLDERFIELD) {
            o = addOption(s, PLACEHOLDER, messages[<span class="hljs-string">'-- choose field --'</span>], <span class="hljs-literal">true</span>);
            o.style.color = <span class="hljs-string">'blue'</span>;
            o.tableName = tableDef.getName();
            o.fullLabel = messages[<span class="hljs-string">'-- choose field --'</span>];
            placeholder = <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">var</span> sPeriod = <span class="hljs-string">""</span>;
        <span class="hljs-keyword">var</span> cname = <span class="hljs-string">''</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>; i &lt; parts.length - <span class="hljs-number">1</span>; i++) {
            <span class="hljs-keyword">var</span> f = parts[i];
            <span class="hljs-keyword">if</span> (f == <span class="hljs-literal">null</span> || f == <span class="hljs-string">''</span>)
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">var</span> elementDef = tableDef.getElement(parts[i]);
            <span class="hljs-keyword">if</span> (elementDef == <span class="hljs-literal">null</span> &amp;&amp; tableDef.glide_var &amp;&amp; parts.length &gt; <span class="hljs-number">3</span>)
                elementDef = tableDef.getElement(parts[i] + <span class="hljs-string">"."</span> + parts[++i]);
            <span class="hljs-keyword">if</span> (elementDef == <span class="hljs-literal">null</span>)
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">var</span> childTable = tableName;
            <span class="hljs-keyword">if</span> (elementDef.isReference()) {
                childTable = elementDef.getReference();
                <span class="hljs-keyword">if</span> (elementDef.isExtensionElement())
                    extension = childTable;
                <span class="hljs-keyword">else</span>
                    extension = <span class="hljs-string">''</span>;
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">if</span> (fieldName != <span class="hljs-literal">null</span> &amp;&amp; fieldName.indexOf(<span class="hljs-string">"..."</span>) &gt; <span class="hljs-number">-1</span>)
                    childTable = parts[<span class="hljs-number">0</span>];
                <span class="hljs-keyword">else</span>
                    <span class="hljs-keyword">break</span>;
            }
            <span class="hljs-keyword">var</span> parentTable = (extension != <span class="hljs-string">''</span>) ? extension : elementDef.getTable().getName();
            tableDef = getTableReference(childTable, parentTable);
            <span class="hljs-keyword">if</span> (cname.length)
                cname = cname + <span class="hljs-string">"."</span>;
            cname += elementDef.getName();
            sPeriod = <span class="hljs-string">"."</span> + sPeriod;
            <span class="hljs-keyword">var</span> clabel = sPeriod + elementDef.getLabel() + <span class="hljs-string">" \u00bb "</span> +
                elementDef.getRefLabel() + <span class="hljs-string">" "</span> +
                messages[<span class="hljs-string">'lowercase_fields'</span>];
            o = addOption(s, cname + <span class="hljs-string">"..."</span>, clabel, <span class="hljs-literal">false</span>);
            o.tableName = tableDef.getName();
            o.style.color = <span class="hljs-string">'blue'</span>;
            selindex++;
            indentLabel = <span class="hljs-literal">true</span>;
            headersAdded = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">if</span> (labelPrefix.length)
                labelPrefix += <span class="hljs-string">"."</span>;
            labelPrefix += elementDef.getLabel();
            <span class="hljs-keyword">if</span> (prefix.length)
                prefix += <span class="hljs-string">"."</span>;
            prefix += elementDef.getName();
        }
        <span class="hljs-keyword">return</span> elementDef;
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addSortSpec</span>(<span class="hljs-params">name, fField, fOper</span>) </span>{
    <span class="hljs-keyword">if</span> (!NOW.c14.setup(name))
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">var</span> fDiv = getThing(currentTable, <span class="hljs-string">'gcond_filters'</span>);
    <span class="hljs-keyword">var</span> e = $(<span class="hljs-string">'gcond_sort_order'</span>);
    <span class="hljs-keyword">if</span> (e) {
        e.filterObject = fDiv.filterObject;
        fDiv = e;
    }
    <span class="hljs-keyword">if</span> (!checkFilterSize(fDiv.filterObject))
        <span class="hljs-keyword">return</span>;
    fDiv.filterObject.addSortRow(fField, fOper);
    _frameChanged();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addFields</span>(<span class="hljs-params">tableName, fValue, isSort, extendedFields</span>) </span>{
    NOW.c14.setup(tableName);
    <span class="hljs-keyword">var</span> s = _createFilterSelect();
    <span class="hljs-keyword">if</span> (!isSort)
        s.onchange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            updateFields(tableName, <span class="hljs-keyword">this</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, extendedFields);
        };
    <span class="hljs-keyword">else</span>
        s.onchange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            updateSortFields(tableName, <span class="hljs-keyword">this</span>);
        };
    <span class="hljs-keyword">var</span> sname = tableName.split(<span class="hljs-string">"."</span>)[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">if</span> (fValue)
        sname = sname + <span class="hljs-string">"."</span> + fValue;
    <span class="hljs-keyword">if</span> (isSort)
        addFirstLevelFields(s, sname, fValue, sortByFilter);
    <span class="hljs-keyword">else</span>
        addFirstLevelFields(s, sname, fValue);
    <span class="hljs-keyword">return</span> s;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sortByFilter</span>(<span class="hljs-params">item</span>) </span>{
    <span class="hljs-keyword">return</span> item.canSort() &amp;&amp; (g_lang == <span class="hljs-string">'en'</span> || item.canSortI18N());
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateSortFields</span>(<span class="hljs-params">name, select</span>) </span>{
    <span class="hljs-keyword">if</span> (!NOW.c14.setup(name))
        <span class="hljs-keyword">return</span>;
    name = currentTable;
    <span class="hljs-keyword">var</span> o = getSelectedOption(select);
    <span class="hljs-keyword">var</span> fieldName = o.value;
    name = name.split(<span class="hljs-string">"."</span>)[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">var</span> idx = fieldName.indexOf(<span class="hljs-string">"..."</span>);
    <span class="hljs-keyword">if</span> (idx != <span class="hljs-number">-1</span>) {
        NOW.c14.setShowRelated(fieldName, idx, name, select);
        <span class="hljs-keyword">return</span>;
    }
    name = currentTable = getTableFromOption(o);
    <span class="hljs-keyword">var</span> options = select.options;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; options.length; i++) {
        <span class="hljs-keyword">var</span> option = options[i];
        <span class="hljs-keyword">if</span> (optionWasSelected(option)) {
            option.innerHTML = getNormalLabel(option);
            option.style.color = <span class="hljs-string">'black'</span>;
            option.wasSelected = <span class="hljs-string">'false'</span>;
            <span class="hljs-keyword">break</span>;
        }
    }
    <span class="hljs-keyword">if</span> (!NOW.c14.setup(name))
        <span class="hljs-keyword">return</span>;
    o.normalLabel = o.innerHTML;
    o.innerHTML = getFullLabel(o);
    o.style.color = <span class="hljs-string">'green'</span>;
    o.wasSelected = <span class="hljs-string">'true'</span>;
    $(select).addClassName(<span class="hljs-string">'filter_type'</span>);
    $j(select).select2();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addCondition</span>(<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">if</span> (!NOW.c14.setup(name))
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">var</span> fDiv = getThing(currentTable, <span class="hljs-string">'gcond_filters'</span>);
    <span class="hljs-keyword">if</span> (!checkFilterSize(fDiv.filterObject))
        <span class="hljs-keyword">return</span>;
    fDiv.filterObject.addConditionRowToFirstSection();
    _frameChanged();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addConditionSpec</span>(<span class="hljs-params">name, queryID, field, oper, value</span>) </span>{
    <span class="hljs-keyword">if</span> (firstTable == <span class="hljs-literal">null</span>)
        firstTable = currentTable;
    <span class="hljs-keyword">if</span> (!NOW.c14.setup(name))
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">var</span> divName = <span class="hljs-string">"gcond_filters"</span>;
    <span class="hljs-keyword">if</span> (fDiv != <span class="hljs-literal">null</span>)
        divName = fDiv + <span class="hljs-string">"gcond_filters"</span>;
    <span class="hljs-keyword">var</span> fDiv = getThing(currentTable, divName);
    <span class="hljs-keyword">var</span> filter = fDiv.filterObject;
    <span class="hljs-keyword">if</span> (filter == <span class="hljs-literal">null</span>) {
        filter = <span class="hljs-keyword">new</span> GlideFilter(currentTable, <span class="hljs-string">""</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> field == <span class="hljs-string">"undefined"</span>) {
            <span class="hljs-keyword">return</span>;
        }
    }
    <span class="hljs-keyword">if</span> (!checkFilterSize(filter))
        <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> answer = filter.addConditionRow(queryID, field, oper, value);
    _frameChanged();
    <span class="hljs-keyword">return</span> answer;
};
<span class="hljs-comment">/*! RESOURCE: /scripts/doctype/condition14_templates.js */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addTextArea</span>(<span class="hljs-params">td, dValue</span>) </span>{
    <span class="hljs-keyword">if</span> (!useTextareas)
        <span class="hljs-keyword">return</span> addTextInput(td, dValue);
    <span class="hljs-keyword">var</span> input = cel(<span class="hljs-string">"textarea"</span>);
    td.fieldType = <span class="hljs-string">"textarea"</span>;
    <span class="hljs-keyword">if</span> (dValue)
        input.value = dValue;
    input.className = <span class="hljs-string">"filerTableInput form-control"</span>;
    input.title = <span class="hljs-string">'input value'</span>;
    input.wrap = <span class="hljs-string">"soft"</span>;
    input.rows = <span class="hljs-number">5</span>;
    input.style.width = <span class="hljs-string">"80%"</span>;
    input.maxlength = <span class="hljs-number">80</span>;
    td.appendChild(input);
    <span class="hljs-keyword">return</span> input;
};
<span class="hljs-comment">/*! RESOURCE: /scripts/doctype/condition14_reporting.js */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">columnsGetWithFilter</span>(<span class="hljs-params">mft, filter, nu</span>) </span>{
    queueFilters[mft] = filter;
    queueTables[mft] = mft;
    columnsGet(mft, nu);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reconstruct</span>(<span class="hljs-params">table, column</span>) </span>{
    <span class="hljs-keyword">if</span> (!column)
        <span class="hljs-keyword">return</span> column;
    <span class="hljs-keyword">if</span> (column.indexOf(<span class="hljs-string">"..."</span>) &lt; <span class="hljs-number">0</span>)
        <span class="hljs-keyword">return</span> column;
    <span class="hljs-keyword">var</span> ngfi = column.indexOf(<span class="hljs-string">"..."</span>);
    <span class="hljs-keyword">var</span> ngf = column.substring(<span class="hljs-number">0</span>, ngfi);
    <span class="hljs-keyword">var</span> te = <span class="hljs-keyword">new</span> Table(table);
    <span class="hljs-keyword">var</span> recon = ngf + <span class="hljs-string">"."</span> + te.getDisplayName(ngf);
    <span class="hljs-keyword">return</span> recon;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resetFilters</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> t = getThing(currentTable, <span class="hljs-string">'gcond_filters'</span>);
    clearNodes(t);
};
<span class="hljs-comment">/*! RESOURCE: /scripts/doctype/GlideFilter14.js */</span>
MESSAGES_FILTER_BUTTONS = [<span class="hljs-string">'Run Filter'</span>, <span class="hljs-string">'Run'</span>, <span class="hljs-string">'Add AND Condition'</span>, <span class="hljs-string">'Add OR Condition'</span>, <span class="hljs-string">'and'</span>, <span class="hljs-string">'or'</span>, <span class="hljs-string">'Delete'</span>];
MESSAGES_FILTER_MISC = [<span class="hljs-string">'Run Filter'</span>, <span class="hljs-string">'Run'</span>, <span class="hljs-string">'Order results by the following fields'</span>];
<span class="hljs-keyword">var</span> GlideFilter = Class.create();
GlideFilter.prototype = {
    <span class="hljs-attr">VARIABLES</span>: <span class="hljs-string">"variables"</span>,
    <span class="hljs-attr">LABELS_QUERY</span>: <span class="hljs-string">"HASLABEL"</span>,
    <span class="hljs-attr">OPERATOR_EQUALS</span>: <span class="hljs-string">"="</span>,
    <span class="hljs-attr">FILTER_DIV</span>: <span class="hljs-string">"gcond_filters"</span>,
    <span class="hljs-attr">fIncludedExtendedOperators</span>: {},
    <span class="hljs-attr">fUsageContext</span>: <span class="hljs-string">"default"</span>,
    <span class="hljs-attr">fUseVariable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, query, fDiv, runnable, synchronous, callback, originalQuery</span>) </span>{
<span class="hljs-meta">        "use strict"</span>;
        <span class="hljs-keyword">this</span>.synchronous = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> synchronous != <span class="hljs-string">'undefined'</span>)
            <span class="hljs-keyword">this</span>.synchronous = synchronous;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> query === <span class="hljs-string">'function'</span>) {
            callback = query;
            query = <span class="hljs-literal">null</span>;
        }
        <span class="hljs-keyword">this</span>.callback = callback;
        <span class="hljs-keyword">this</span>.query = query;
        <span class="hljs-keyword">this</span>.maintainPlaceHolder = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">this</span>.conditionsWanted = !noConditionals;
        <span class="hljs-keyword">this</span>.opsWanted = !noOps;
        <span class="hljs-keyword">this</span>.defaultPlaceHolder = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">this</span>.runable = runnable;
        <span class="hljs-keyword">this</span>.textAreasWanted = useTextareas;
        <span class="hljs-keyword">this</span>.tableName = name;
        <span class="hljs-keyword">this</span>.restrictedFields = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.ignoreFields = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.onlyRestrictedFields = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">this</span>.includeExtended = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">this</span>.divName = <span class="hljs-string">"gcond_filters"</span>;
        <span class="hljs-keyword">this</span>.filterReadOnly = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">this</span>.isTemplate = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">if</span> (fDiv != <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">this</span>.divName = fDiv + <span class="hljs-string">"gcond_filters"</span>;
        <span class="hljs-keyword">this</span>.fDiv = getThing(<span class="hljs-keyword">this</span>.tableName, <span class="hljs-keyword">this</span>.divName);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.fDiv.filterObject) {
            <span class="hljs-keyword">this</span>.fDiv.filterObject.destroy();
            <span class="hljs-keyword">this</span>.fDiv.filterObject = <span class="hljs-literal">null</span>;
            <span class="hljs-keyword">this</span>.fDiv = <span class="hljs-literal">null</span>;
        }
        <span class="hljs-keyword">this</span>.fDiv = getThing(<span class="hljs-keyword">this</span>.tableName, <span class="hljs-keyword">this</span>.divName);
        <span class="hljs-keyword">this</span>.fDiv.filterObject = <span class="hljs-keyword">this</span>;
        <span class="hljs-keyword">this</span>.fDiv.initialQuery = query;
        <span class="hljs-keyword">var</span> mappingId = <span class="hljs-keyword">this</span>.mappingId = <span class="hljs-keyword">this</span>.fDiv.id.replace(<span class="hljs-regexp">/gcond_filters$/</span>, <span class="hljs-string">""</span>);
        <span class="hljs-keyword">this</span>.elementSupportsMapping = !!gel(<span class="hljs-string">"sys_mapping."</span> + <span class="hljs-keyword">this</span>.mappingId);
        <span class="hljs-keyword">this</span>.sortElement = $(<span class="hljs-string">'gcond_sort_order'</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.sortElement)
            <span class="hljs-keyword">this</span>.sortElement.filterObject = <span class="hljs-keyword">this</span>;
        <span class="hljs-keyword">else</span>
            <span class="hljs-keyword">this</span>.sortElement = <span class="hljs-keyword">this</span>.fDiv;
        <span class="hljs-keyword">this</span>.sections = [];
        <span class="hljs-keyword">this</span>.disabledFilter = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">this</span>.originalQuery = originalQuery;
        <span class="hljs-keyword">var</span> mappingRows = [];

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cleanMappingFields</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; mappingRows.length &gt; i; i++) {
                <span class="hljs-keyword">var</span> handler = mappingRows[i];
                <span class="hljs-keyword">if</span> (!$j.contains(<span class="hljs-built_in">document</span>.body, handler.tr)) {
                    destroyHandler(handler);
                    mappingRows.splice(i, <span class="hljs-number">1</span>);
                    i--;
                }
            }
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initMapHandler</span>(<span class="hljs-params">handler</span>) </span>{
            mappingRows.push(handler);
            CachedEvent.after(<span class="hljs-string">"sys_mapping:loaded"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">mAPI</span>) </span>{
                mAPI.initOperand(handler, mappingId);
            });
            cleanMappingFields();
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">destroyHandler</span>(<span class="hljs-params">handler</span>) </span>{
            CachedEvent.after(<span class="hljs-string">"sys_mapping:loaded"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">mAPI</span>) </span>{
                mAPI.destroyOperand(handler, mappingId);
            });
        }
        <span class="hljs-keyword">var</span> currentMapState = <span class="hljs-string">""</span>;

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">syncMappingStatus</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> active = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = mappingRows.length; l &gt; i; i++) {
                <span class="hljs-keyword">if</span> (mappingRows[i]._isMappingEnabled) {
                    active = <span class="hljs-literal">true</span>;
                    <span class="hljs-keyword">break</span>;
                }
            }
            <span class="hljs-keyword">var</span> status = active ? <span class="hljs-string">"partial"</span> : <span class="hljs-string">"inactive"</span>;
            <span class="hljs-keyword">if</span> (currentMapState !== status) {
                currentMapState = status;
                CustomEvent.fire(<span class="hljs-string">"sys_mapping:set_field_state::"</span> + mappingId, status);
            }
        }
        <span class="hljs-keyword">this</span>.mappingMgr = {
            <span class="hljs-attr">initElement</span>: initMapHandler,
            <span class="hljs-attr">destroyElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                cleanMappingFields();
                syncMappingStatus();
            },
            <span class="hljs-attr">notifyStateChange</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                cleanMappingFields();
                syncMappingStatus();
            }
        };
        <span class="hljs-keyword">this</span>.initMessageCache();
    },
    <span class="hljs-attr">init2</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.query != <span class="hljs-string">'undefined'</span>) {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.synchronous)
                <span class="hljs-keyword">this</span>.setQuery(<span class="hljs-keyword">this</span>.query);
            <span class="hljs-keyword">else</span>
                <span class="hljs-keyword">this</span>.setQueryAsync(<span class="hljs-keyword">this</span>.query);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">this</span>.reset();
        }
        <span class="hljs-keyword">this</span>.setOptionsFromParmsElement(<span class="hljs-keyword">this</span>.tableName);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.callback) {
            <span class="hljs-keyword">this</span>.callback(<span class="hljs-keyword">this</span>);
        }
    },
    <span class="hljs-attr">setValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
        <span class="hljs-keyword">this</span>.setQuery(value);
    },
    <span class="hljs-attr">_setValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
        <span class="hljs-keyword">this</span>.setQuery(value);
    },
    <span class="hljs-attr">setSectionClasses</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> tbody = $(<span class="hljs-keyword">this</span>.getDiv() || getThing(<span class="hljs-keyword">this</span>.tableName, <span class="hljs-keyword">this</span>.divName));
        tbody.removeClassName(<span class="hljs-string">'sn-filter-multi-clause'</span>);
        tbody.removeClassName(<span class="hljs-string">'sn-filter-multi-condition'</span>);
        tbody.removeClassName(<span class="hljs-string">'sn-filter-empty'</span>);
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.conditionsWanted)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">var</span> showOr = <span class="hljs-literal">false</span>;
        $j(<span class="hljs-string">"button.new-or-button"</span>).hide();
        <span class="hljs-keyword">var</span> sections = <span class="hljs-keyword">this</span>.sections;
        <span class="hljs-keyword">if</span> (sections.length == <span class="hljs-number">1</span>) {
            <span class="hljs-keyword">var</span> i = sections[<span class="hljs-number">0</span>].conditions.length;
            <span class="hljs-keyword">if</span> (i == <span class="hljs-number">0</span>)
                tbody.addClassName(<span class="hljs-string">'sn-filter-empty'</span>);
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i == <span class="hljs-number">1</span>)
                showOr = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">1</span>) {
                tbody.addClassName(<span class="hljs-string">'sn-filter-multi-condition'</span>);
                showOr = <span class="hljs-literal">true</span>;
            }
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sections.length &gt; <span class="hljs-number">1</span>) {
            tbody.addClassName(<span class="hljs-string">'sn-filter-multi-clause'</span>);
            showOr = <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">if</span> (sections.length &gt; <span class="hljs-number">0</span>)
            $j((sections[sections.length - <span class="hljs-number">1</span>]).table).addClass(<span class="hljs-string">'sn-animate-filter-clause'</span>);
        <span class="hljs-keyword">if</span> (showOr)
            $j(<span class="hljs-string">"button.new-or-button"</span>).show();
    },
    <span class="hljs-attr">setOptionsFromParmsElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
        <span class="hljs-keyword">var</span> p = name.split(<span class="hljs-string">"."</span>);
        <span class="hljs-keyword">var</span> elem = gel(p[<span class="hljs-number">1</span>] + <span class="hljs-string">"."</span> + p[<span class="hljs-number">2</span>]);
        <span class="hljs-keyword">if</span> (!elem)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">var</span> ut = elem.getAttribute(<span class="hljs-string">"data-usage_context"</span>);
        <span class="hljs-keyword">if</span> (ut)
            <span class="hljs-keyword">this</span>.setUsageContext(ut);
        <span class="hljs-keyword">var</span> uv = elem.getAttribute(<span class="hljs-string">"data-use-variables"</span>);
        <span class="hljs-keyword">if</span> (uv)
            <span class="hljs-keyword">this</span>.setUseVariables(uv);
        <span class="hljs-keyword">var</span> rf = elem.getAttribute(<span class="hljs-string">'data-restricted_fields'</span>);
        <span class="hljs-keyword">if</span> (rf) {
            <span class="hljs-keyword">this</span>.setRestrictedFields(rf);
            <span class="hljs-keyword">this</span>.setOnlyRestrictedFields(<span class="hljs-literal">true</span>);
        }
        <span class="hljs-keyword">var</span> eo = elem.getAttribute(<span class="hljs-string">"data-extended_operators"</span>);
        <span class="hljs-keyword">if</span> (eo)
            <span class="hljs-keyword">this</span>.setIncludeExtended(eo);
    },
    <span class="hljs-attr">setUsageContext</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">usage</span>) </span>{
        <span class="hljs-keyword">this</span>.fUsageContext = usage;
        <span class="hljs-keyword">if</span> (usage == <span class="hljs-string">"element_conditions"</span>) {
            <span class="hljs-keyword">this</span>.addExtendedOperator(<span class="hljs-string">"MATCH_PAT"</span>);
            <span class="hljs-keyword">this</span>.addExtendedOperator(<span class="hljs-string">"MATCH_RGX"</span>);
            <span class="hljs-keyword">this</span>.ignoreVariables();
        }
    },
    <span class="hljs-attr">getUsageContext</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.fUsageContext;
    },
    <span class="hljs-attr">setUseVariables</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">useVariables</span>) </span>{
        <span class="hljs-keyword">this</span>.fUseVariable = useVariables === <span class="hljs-string">'true'</span>;
    },
    <span class="hljs-attr">getUseVariables</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.fUseVariable;
    },
    <span class="hljs-attr">destroy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.destroyed = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.fDiv) {
            <span class="hljs-keyword">this</span>.fDiv.filterObject = <span class="hljs-literal">null</span>;
            <span class="hljs-keyword">this</span>.fDiv = <span class="hljs-literal">null</span>;
        }
        <span class="hljs-keyword">this</span>._clearSections();
    },
    <span class="hljs-attr">_clearSections</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.sections.length; i++)
            <span class="hljs-keyword">this</span>.sections[i].destroy();
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.sortSection)
            <span class="hljs-keyword">this</span>.sortSection.destroy();
        <span class="hljs-keyword">this</span>.sections = [];
        <span class="hljs-keyword">this</span>.sortSection = <span class="hljs-literal">null</span>;
    },
    <span class="hljs-attr">initMessageCache</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">        "use strict"</span>
        <span class="hljs-keyword">var</span> all = {};
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> sysvalues) {
            <span class="hljs-keyword">var</span> values = sysvalues[key];
            <span class="hljs-keyword">var</span> keys = buildMap(values, <span class="hljs-number">0</span>);
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; keys.length; i++)
                all[keys[i]] = <span class="hljs-string">'t'</span>;
        }
        <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> sysopers) {
            <span class="hljs-keyword">var</span> values = sysopers[key];
            <span class="hljs-keyword">var</span> keys = buildMap(values, <span class="hljs-number">1</span>);
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; keys.length; i++)
                all[keys[i]] = <span class="hljs-string">'t'</span>;
        }
        <span class="hljs-keyword">var</span> m = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
        m = m.concat(MESSAGES_FILTER_BUTTONS, MESSAGES_FILTER_MISC, MESSAGES_CONDITION_RELATED_FILES);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; m.length; i++)
            all[m[i]] = <span class="hljs-string">'t'</span>;
        <span class="hljs-keyword">var</span> send = [];
        <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> all)
            send.push(key);
        NOW.msg.fetch(send, <span class="hljs-keyword">this</span>.init2.bind(<span class="hljs-keyword">this</span>));
    },
    <span class="hljs-attr">setRestrictedFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fields</span>) </span>{
        jslog(<span class="hljs-string">"Received restricted fields "</span> + fields);
        <span class="hljs-keyword">var</span> fa = fields.split(<span class="hljs-string">","</span>);
        <span class="hljs-keyword">if</span> (fa.length == <span class="hljs-number">0</span>)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">this</span>.restrictedFields = {};
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; fa.length; i++)
            <span class="hljs-keyword">this</span>.restrictedFields[fa[i]] = fa[i];
    },
    <span class="hljs-attr">ignoreVariables</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">params</span>) </span>{
        <span class="hljs-keyword">var</span> variables = params || [<span class="hljs-string">'variables'</span>, <span class="hljs-string">'questions'</span>, <span class="hljs-string">'sys_tags'</span>];
        <span class="hljs-keyword">this</span>.addIgnoreFields(variables.join(<span class="hljs-string">','</span>));
    },
    <span class="hljs-attr">addIgnoreFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fields</span>) </span>{
        <span class="hljs-keyword">var</span> fa = fields.split(<span class="hljs-string">","</span>);
        <span class="hljs-keyword">if</span> (fa.length == <span class="hljs-number">0</span>)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.ignoreFields)
            <span class="hljs-keyword">this</span>.ignoreFields = {};
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; fa.length; i++)
            <span class="hljs-keyword">this</span>.ignoreFields[fa[i]] = fa[i];
    },
    <span class="hljs-attr">setOnlyRestrictedFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">only</span>) </span>{
        <span class="hljs-keyword">this</span>.onlyRestrictedFields = only;
    },
    <span class="hljs-attr">getIncludeExtended</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.fIncludedExtendedOperators;
    },
    <span class="hljs-attr">setIncludeExtended</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">include</span>) </span>{
        <span class="hljs-keyword">var</span> ops = include.split(<span class="hljs-string">";"</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> x = <span class="hljs-number">0</span>; x &lt; ops.length; x++) {
            <span class="hljs-keyword">this</span>.addExtendedOperator(ops[x]);
        }
    },
    <span class="hljs-attr">addExtendedOperator</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">oper</span>) </span>{
        <span class="hljs-keyword">this</span>.fIncludedExtendedOperators[oper] = <span class="hljs-literal">true</span>;
    },
    <span class="hljs-attr">filterFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
        <span class="hljs-keyword">var</span> name = item.getName();
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.restrictedFields) {
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.ignoreFields)
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.ignoreFields[name])
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">if</span> (name.indexOf(<span class="hljs-string">"."</span>) &gt; <span class="hljs-number">-1</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.restrictedFields[name])
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    },
    <span class="hljs-attr">setFieldUsed</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{},
    <span class="hljs-attr">clearFieldUsed</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{},
    <span class="hljs-attr">refreshSelectList</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
    <span class="hljs-attr">isTemplatable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    },
    <span class="hljs-attr">setQuery</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">query</span>) </span>{
        jslog(<span class="hljs-string">"setQuery Synchronously:  "</span> + query);
        <span class="hljs-keyword">this</span>.glideQuery = <span class="hljs-keyword">new</span> GlideEncodedQuery(<span class="hljs-keyword">this</span>.tableName, query);
        <span class="hljs-keyword">this</span>.glideQuery.parse();
        <span class="hljs-keyword">this</span>.reset();
        <span class="hljs-keyword">this</span>.build();
    },
    <span class="hljs-attr">setQueryAsync</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">query, defaultVal</span>) </span>{
        <span class="hljs-keyword">this</span>.addLoadingIcon();
        <span class="hljs-keyword">this</span>.glideQuery = <span class="hljs-keyword">new</span> GlideEncodedQuery(<span class="hljs-keyword">this</span>.tableName, query, <span class="hljs-keyword">this</span>.setQueryCallback.bind(<span class="hljs-keyword">this</span>));
        <span class="hljs-keyword">if</span> (defaultVal)
            <span class="hljs-keyword">this</span>.defaultVal = defaultVal.split(<span class="hljs-string">","</span>);
        <span class="hljs-keyword">this</span>.glideQuery.parse();
        <span class="hljs-keyword">this</span>.queryProcessed = <span class="hljs-literal">true</span>;
    },
    <span class="hljs-attr">setQueryCallback</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.destroyed)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">this</span>.reset();
        <span class="hljs-keyword">this</span>.build();
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.getFilterReadOnly()) {
            <span class="hljs-keyword">this</span>.setReadOnly(<span class="hljs-literal">true</span>);
        }
        CustomEvent.fire(<span class="hljs-string">'filter:'</span> + <span class="hljs-keyword">this</span>.type + <span class="hljs-string">'-done'</span>, <span class="hljs-literal">true</span>);
    },
    <span class="hljs-attr">setRunable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
        <span class="hljs-keyword">this</span>.runable = b;
    },
    <span class="hljs-attr">isRunable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.runable;
    },
    <span class="hljs-attr">setDefaultPlaceHolder</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
        <span class="hljs-keyword">this</span>.defaultPlaceHolder = b;
    },
    <span class="hljs-attr">setMaintainPlaceHolder</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
        <span class="hljs-keyword">this</span>.maintainPlaceHolder = <span class="hljs-literal">true</span>;
    },
    <span class="hljs-attr">getMaintainPlaceHolder</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.maintainPlaceHolder;
    },
    <span class="hljs-attr">setFilterReadOnly</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
        <span class="hljs-keyword">this</span>.filterReadOnly = b;
    },
    <span class="hljs-attr">getFilterReadOnly</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.filterReadOnly;
    },
    <span class="hljs-attr">setRunCode</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">code</span>) </span>{
        <span class="hljs-keyword">this</span>.runCode = code;
    },
    <span class="hljs-attr">reset</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> e = <span class="hljs-keyword">this</span>.fDiv;
        <span class="hljs-keyword">if</span> (!e)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">if</span> (e.tagName == <span class="hljs-string">'TBODY'</span>) {
            <span class="hljs-keyword">var</span> toRemove = [];
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; e.childNodes.length; i++) {
                <span class="hljs-keyword">var</span> tr = e.childNodes[i];
                <span class="hljs-keyword">if</span> ($(tr).hasClassName(<span class="hljs-string">'no_remove'</span>))
                    <span class="hljs-keyword">continue</span>;
                toRemove.unshift(i);
            }
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; toRemove.length; i++)
                e.removeChild(e.childNodes[toRemove[i]]);
        } <span class="hljs-keyword">else</span> {
            clearNodes(<span class="hljs-keyword">this</span>.fDiv);
        }
        <span class="hljs-keyword">this</span>._clearSections();
    },
    <span class="hljs-attr">getXML</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.glideQuery.getXML();
    },
    <span class="hljs-attr">build</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.queryProcessed = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">this</span>.terms = <span class="hljs-keyword">this</span>.glideQuery.getTerms();
        <span class="hljs-keyword">this</span>.buildQuery();
        <span class="hljs-keyword">this</span>.buildOrderBy();
    },
    <span class="hljs-attr">buildOrderBy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> orderArray = <span class="hljs-keyword">this</span>.glideQuery.getOrderBy();
        <span class="hljs-keyword">if</span> (orderArray.length == <span class="hljs-number">0</span>)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; orderArray.length; i++) {
            <span class="hljs-keyword">var</span> order = orderArray[i];
            <span class="hljs-keyword">if</span> (order.isAscending())
                <span class="hljs-keyword">this</span>.addSortRow(order.getName(), <span class="hljs-string">'ascending'</span>);
            <span class="hljs-keyword">else</span>
                <span class="hljs-keyword">this</span>.addSortRow(order.getName(), <span class="hljs-string">'descending'</span>);
        }
    },
    <span class="hljs-attr">buildQuery</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">        "use strict"</span>
        <span class="hljs-keyword">this</span>._loadTablesForQuery();
        <span class="hljs-keyword">this</span>.preQuery();
        <span class="hljs-keyword">var</span> partCount = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">var</span> section = <span class="hljs-keyword">this</span>.addSection();
        <span class="hljs-keyword">var</span> queryID = section.getQueryID();
        <span class="hljs-keyword">this</span>.removeLoadingIcon();
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.terms.length; i++) {
            <span class="hljs-keyword">var</span> qp = <span class="hljs-keyword">this</span>.terms[i];
            <span class="hljs-keyword">if</span> (!qp.isValid())
                <span class="hljs-keyword">continue</span>;
            partCount += <span class="hljs-number">1</span>;
            <span class="hljs-keyword">if</span> (qp.isNewQuery()) {
                <span class="hljs-keyword">var</span> section = <span class="hljs-keyword">this</span>.addSection();
                queryID = section.getQueryID();
            }
            <span class="hljs-keyword">var</span> field = qp.getField();
            <span class="hljs-keyword">var</span> operator = qp.getOperator();
            <span class="hljs-keyword">var</span> operands = qp.getValue();
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isHaslabelQuery(field, operator, operands)) {
                operands = operands.substring(<span class="hljs-number">1</span>);
                field = <span class="hljs-string">"sys_tags"</span>;
                operator = <span class="hljs-keyword">this</span>.OPERATOR_EQUALS;
            }
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.defaultVal) {
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = <span class="hljs-number">0</span>; n &lt; <span class="hljs-keyword">this</span>.defaultVal.length; n++) {
                    <span class="hljs-keyword">var</span> fieldIsDefault = <span class="hljs-literal">false</span>;
                    <span class="hljs-keyword">var</span> defaultQuery = <span class="hljs-keyword">this</span>.defaultVal[n].split(<span class="hljs-string">"="</span>);
                    <span class="hljs-keyword">var</span> defaultField = defaultQuery[<span class="hljs-number">0</span>];
                    <span class="hljs-keyword">if</span> (defaultField == field) {
                        fieldIsDefault = <span class="hljs-literal">true</span>;
                        <span class="hljs-keyword">this</span>.defaultVal.splice(n, <span class="hljs-number">1</span>);
                        n = <span class="hljs-keyword">this</span>.defaultVal.length;
                    }
                }
            }
            gotoPart = qp.isGoTo();
            <span class="hljs-keyword">if</span> (qp.isOR())
                <span class="hljs-keyword">this</span>.currentCondition.addNewSubCondition(field, operator, operands);
            <span class="hljs-keyword">else</span>
                <span class="hljs-keyword">this</span>.addConditionRow(queryID, field, operator, operands, fieldIsDefault);
        }
        <span class="hljs-keyword">if</span> (partCount == <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-keyword">this</span>.defaultPlaceHolder)
            <span class="hljs-keyword">this</span>.addConditionRow(queryID);
        gotoPart = <span class="hljs-literal">false</span>;
    },
    <span class="hljs-attr">addLoadingIcon</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> templateFilter = gel(<span class="hljs-keyword">this</span>.fieldName + <span class="hljs-string">"filters_table"</span>);
        <span class="hljs-keyword">if</span> (templateFilter &amp;&amp; templateFilter.className !== <span class="hljs-string">'filter_load_icon'</span>) {
            <span class="hljs-keyword">this</span>.filterClasses = templateFilter.getAttribute(<span class="hljs-string">"class"</span>);
            templateFilter.className = <span class="hljs-string">'filter_load_icon'</span>;
        }
    },
    <span class="hljs-attr">removeLoadingIcon</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> templateFilter = gel(<span class="hljs-keyword">this</span>.fieldName + <span class="hljs-string">"filters_table"</span>);
        <span class="hljs-keyword">if</span> (templateFilter &amp;&amp; templateFilter.className === <span class="hljs-string">'filter_load_icon'</span>)
            templateFilter.className = <span class="hljs-keyword">this</span>.filterClasses;
    },
    <span class="hljs-attr">isHaslabelQuery</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">field, operator, operands</span>) </span>{
        <span class="hljs-keyword">return</span> field == <span class="hljs-keyword">this</span>.VARIABLES &amp;&amp;
            operator == <span class="hljs-keyword">this</span>.LABELS_QUERY &amp;&amp;
            operands.length &gt; <span class="hljs-number">1</span>;
    },
    <span class="hljs-attr">preQuery</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
    <span class="hljs-attr">isProtectedField</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    },
    <span class="hljs-attr">_loadTablesForQuery</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.terms.length; i++) {
            <span class="hljs-keyword">var</span> qp = <span class="hljs-keyword">this</span>.terms[i];
            <span class="hljs-keyword">if</span> (!qp.isValid())
                <span class="hljs-keyword">continue</span>;
            <span class="hljs-keyword">var</span> field = qp.getField();
            <span class="hljs-keyword">this</span>._loadTablesForField(field);
        }
    },
    <span class="hljs-attr">_loadTablesForField</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fieldName</span>) </span>{
        <span class="hljs-keyword">if</span> (!fieldName)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">var</span> tableName = <span class="hljs-keyword">this</span>.tableName.split(<span class="hljs-string">"."</span>)[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">var</span> parts = fieldName.split(<span class="hljs-string">"."</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; parts.length; i++) {
            <span class="hljs-keyword">var</span> tableDef = loadFilterTableReference(tableName, <span class="hljs-keyword">this</span>.isTemplate);
            <span class="hljs-keyword">if</span> (!tableDef)
                <span class="hljs-keyword">return</span>;
            <span class="hljs-keyword">var</span> edef = tableDef.getElement(parts[i]);
            <span class="hljs-keyword">if</span> (edef == <span class="hljs-literal">null</span> &amp;&amp; tableDef.glide_var)
                edef = tableDef.getElement(parts[i] + <span class="hljs-string">"."</span> + parts[++i]);
            <span class="hljs-keyword">if</span> (edef == <span class="hljs-literal">null</span>)
                <span class="hljs-keyword">return</span>;
            <span class="hljs-keyword">if</span> (!edef.isReference())
                <span class="hljs-keyword">return</span>;
            tableName = edef.getReference();
        }
    },
    <span class="hljs-attr">addSortRow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">field, oper</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.sortSection == <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">this</span>.sortSection = <span class="hljs-keyword">new</span> GlideSortSection(<span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">this</span>.sortSection.addField(field, oper);
        <span class="hljs-keyword">this</span>.addRunButton();
    },
    <span class="hljs-attr">addConditionRowToFirstSection</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.sections.length == <span class="hljs-number">0</span>)
            <span class="hljs-keyword">this</span>.addSection();
        <span class="hljs-keyword">var</span> section = <span class="hljs-keyword">this</span>.sections[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">this</span>.addConditionRow(section.getQueryID());
    },
    <span class="hljs-attr">addConditionRow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">queryID, field, oper, value, defaultField</span>) </span>{
        <span class="hljs-keyword">var</span> section = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">if</span> (queryID) {
            <span class="hljs-keyword">var</span> i = findInArray(<span class="hljs-keyword">this</span>.sections, queryID);
            <span class="hljs-keyword">if</span> (i != <span class="hljs-literal">null</span>)
                section = <span class="hljs-keyword">this</span>.sections[i];
        }
        <span class="hljs-keyword">if</span> (!section)
            section = <span class="hljs-keyword">this</span>.addSection();
        <span class="hljs-keyword">var</span> condition = section.addCondition(<span class="hljs-literal">true</span>, field, oper, value);
        <span class="hljs-keyword">if</span> (defaultField) {
            condition.actionRow.className += <span class="hljs-string">" modal_template_icon"</span>;
        }
        <span class="hljs-keyword">this</span>.setSectionClasses();
        <span class="hljs-keyword">if</span> (!condition)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.currentCondition = condition;
        <span class="hljs-keyword">return</span> condition.getRow();
    },
    <span class="hljs-attr">addSection</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> section = <span class="hljs-keyword">new</span> GlideFilterSection(<span class="hljs-keyword">this</span>);
        queryID = section._setup(<span class="hljs-keyword">this</span>.sortSection == <span class="hljs-literal">null</span>, <span class="hljs-keyword">this</span>.sections.length == <span class="hljs-number">0</span>);
        <span class="hljs-keyword">this</span>.sections[<span class="hljs-keyword">this</span>.sections.length] = section;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.sortSection != <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-keyword">this</span>.sortElement == <span class="hljs-keyword">this</span>.fDiv) {
            <span class="hljs-keyword">var</span> sortRow = <span class="hljs-keyword">this</span>.sortSection.getSection().getRow();
            <span class="hljs-keyword">this</span>.fDiv.insertBefore(section.getRow(), sortRow);
        }
        <span class="hljs-keyword">this</span>.addRunButton();
        <span class="hljs-keyword">this</span>.setSectionClasses();
        <span class="hljs-keyword">return</span> section;
    },
    <span class="hljs-attr">removeSection</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">queryID</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.sortSection) {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.sortSection.getID() == queryID) {
                clearNodes(<span class="hljs-keyword">this</span>.sortSection.getSection().getRow());
                fDiv = <span class="hljs-keyword">this</span>.fDiv;
                <span class="hljs-keyword">var</span> e = $(<span class="hljs-string">'gcond_sort_order'</span>);
                <span class="hljs-keyword">if</span> (e)
                    fDiv = e;
                fDiv.removeChild(<span class="hljs-keyword">this</span>.sortSection.getSection().getRow());
                <span class="hljs-keyword">this</span>.sortSection = <span class="hljs-literal">null</span>;
                <span class="hljs-keyword">this</span>.addRunButton();
                <span class="hljs-keyword">return</span>;
            }
        }
        <span class="hljs-keyword">var</span> i = findInArray(<span class="hljs-keyword">this</span>.sections, queryID);
        <span class="hljs-keyword">if</span> (i == <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">var</span> section = <span class="hljs-keyword">this</span>.sections[i];
        <span class="hljs-keyword">this</span>.sections.splice(i, <span class="hljs-number">1</span>);
        clearNodes(section.getRow());
        <span class="hljs-keyword">this</span>.fDiv.removeChild(section.getRow());
        <span class="hljs-keyword">if</span> (i == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.sections.length &gt; <span class="hljs-number">0</span>)
                <span class="hljs-keyword">this</span>.sections[<span class="hljs-number">0</span>].setFirst(<span class="hljs-keyword">this</span>.sections.length);
            <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.defaultPlaceHolder)
                    <span class="hljs-keyword">this</span>.addConditionRow();
            }
        }
        <span class="hljs-keyword">this</span>.addRunButton();
        <span class="hljs-keyword">this</span>.updateDBValue();
        <span class="hljs-keyword">this</span>.setSectionClasses();
    },
    <span class="hljs-attr">singleCondition</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.sections.length &gt; <span class="hljs-number">1</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">var</span> section = <span class="hljs-keyword">this</span>.sections[<span class="hljs-number">0</span>];
        count = section.getConditionCount();
        <span class="hljs-keyword">return</span> count == <span class="hljs-number">1</span>;
    },
    <span class="hljs-attr">runFilter</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> filter = getFilter(<span class="hljs-keyword">this</span>.tableName, <span class="hljs-literal">true</span>);
        <span class="hljs-keyword">if</span> (runFilterHandlers[<span class="hljs-keyword">this</span>.tableName]) {
            runFilterHandlers[<span class="hljs-keyword">this</span>.tableName](<span class="hljs-keyword">this</span>.tableName, filter);
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">var</span> url = buildURL(<span class="hljs-keyword">this</span>.tableName, filter);
        <span class="hljs-built_in">window</span>.location = url;
    },
    <span class="hljs-attr">getName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tableName;
    },
    <span class="hljs-attr">getSortDiv</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.fDiv;
    },
    <span class="hljs-attr">getDiv</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.fDiv;
    },
    <span class="hljs-attr">getConditionsWanted</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.conditionsWanted;
    },
    <span class="hljs-attr">getOpsWanted</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.opsWanted;
    },
    <span class="hljs-attr">getTextAreasWanted</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.textAreasWanted;
    },
    <span class="hljs-attr">isQueryProcessed</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.queryProcessed;
    },
    <span class="hljs-attr">addRunButton</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.runable)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">var</span> max = (<span class="hljs-keyword">this</span>.sortSection == <span class="hljs-literal">null</span>) ? <span class="hljs-keyword">this</span>.sections.length - <span class="hljs-number">1</span> : <span class="hljs-keyword">this</span>.sections.length;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; max; i++) {
            <span class="hljs-keyword">var</span> section = <span class="hljs-keyword">this</span>.sections[i];
            section.removeRunButton();
        }
        <span class="hljs-keyword">var</span> section = <span class="hljs-keyword">this</span>.sortSection;
        <span class="hljs-keyword">if</span> (section == <span class="hljs-literal">null</span>)
            section = <span class="hljs-keyword">this</span>.sections[<span class="hljs-keyword">this</span>.sections.length - <span class="hljs-number">1</span>];
        section.addRunButton();
    },
    <span class="hljs-attr">setReadOnly</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">disabled</span>) </span>{
        <span class="hljs-keyword">var</span> parentElement = <span class="hljs-keyword">this</span>.fDiv.parentNode;
        <span class="hljs-keyword">this</span>._toggleReadOnlyAttribute(disabled);
        <span class="hljs-keyword">this</span>._hideClass(parentElement, <span class="hljs-string">"filerTableAction"</span>, disabled);
        <span class="hljs-keyword">this</span>._disableClass(parentElement, <span class="hljs-string">"filerTableSelect"</span>, disabled);
        <span class="hljs-keyword">this</span>._disableClass(parentElement, <span class="hljs-string">"filerTableInput"</span>, disabled);
        <span class="hljs-keyword">this</span>.setFilterReadOnly(disabled);
        <span class="hljs-keyword">this</span>.disabledFilter = disabled;
    },
    <span class="hljs-attr">_toggleReadOnlyAttribute</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">disabled</span>) </span>{
        <span class="hljs-keyword">var</span> fieldName,
            element;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.fDiv &amp;&amp; <span class="hljs-keyword">this</span>.fDiv.id)
            fieldName = <span class="hljs-keyword">this</span>.fDiv.id.replace(<span class="hljs-string">'gcond_filters'</span>, <span class="hljs-string">''</span>);
        <span class="hljs-keyword">if</span> (fieldName)
            element = gel(fieldName);
        <span class="hljs-keyword">if</span> (element)
            element.readOnly = disabled;
        <span class="hljs-keyword">return</span> !!element;
    },
    <span class="hljs-attr">isReadOnly</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getFilterReadOnly();
    },
    <span class="hljs-attr">_disableClass</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">parentElement, className, disabled</span>) </span>{
        <span class="hljs-keyword">var</span> elements = $(parentElement).select(<span class="hljs-string">"."</span> + className);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; elements.length; i++) {
            g_form.setDisabledControl(elements[i], disabled);
        }
    },
    <span class="hljs-attr">_hideClass</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">parentElement, className, hideIt</span>) </span>{
        <span class="hljs-keyword">var</span> elements = $(parentElement).select(<span class="hljs-string">"."</span> + className);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; elements.length; i++) {
            <span class="hljs-keyword">if</span> (hideIt)
                hideObject(elements[i]);
            <span class="hljs-keyword">else</span>
                showObjectInline(elements[i]);
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.type == <span class="hljs-string">"GlideTemplateFilter"</span>) {
            <span class="hljs-keyword">if</span> (hideIt &amp;&amp; parentElement &amp;&amp; parentElement.parentElement)
                parentElement.parentElement.removeChild(parentElement);
            <span class="hljs-keyword">else</span>
                showObjectInline(parentElement);
        }
    },
    <span class="hljs-attr">getValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> getFilter(<span class="hljs-keyword">this</span>.tableName, <span class="hljs-literal">false</span>);
    },
    <span class="hljs-attr">isDisabled</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.disabledFilter;
    },
    <span class="hljs-attr">updateDBValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
    <span class="hljs-attr">type</span>: <span class="hljs-string">"GlideFilter"</span>
};
<span class="hljs-keyword">var</span> GlideFilterSection = Class.create();
GlideFilterSection.prototype = {
    <span class="hljs-attr">PLACE_HOLDER_FIELD</span>: <span class="hljs-string">"-- choose field --"</span>,
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">filter</span>) </span>{
        <span class="hljs-keyword">this</span>.filter = filter;
        <span class="hljs-keyword">this</span>.sort = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">this</span>.queryID = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.tdMessage = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.runRow = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.conditions = [];
        <span class="hljs-keyword">var</span> msg = NOW.msg;
        <span class="hljs-keyword">var</span> values = MESSAGES_FILTER_MISC;
        <span class="hljs-keyword">this</span>.answer = msg.getMessages(values);
    },
    <span class="hljs-attr">destroy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.runRow = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.runCondition)
            <span class="hljs-keyword">this</span>.runCondition.destroy();
        <span class="hljs-keyword">this</span>.row.rowObject = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.row = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.table = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.tbody = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.conditions.length; i++)
            <span class="hljs-keyword">this</span>.conditions[i].destroy();
    },
    <span class="hljs-attr">_setup</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">link, first</span>) </span>{
        <span class="hljs-keyword">this</span>.queryID = <span class="hljs-string">'QUERYPART'</span> + guid();
        <span class="hljs-keyword">this</span>.row = cel(<span class="hljs-string">'tr'</span>);
        <span class="hljs-keyword">this</span>.row.queryID = <span class="hljs-keyword">this</span>.queryID;
        <span class="hljs-keyword">this</span>.row.queryPart = <span class="hljs-string">'true'</span>;
        <span class="hljs-keyword">this</span>.row.rowObject = <span class="hljs-keyword">this</span>;
        <span class="hljs-keyword">var</span> e = <span class="hljs-keyword">this</span>.filter.getDiv() || getThing(<span class="hljs-keyword">this</span>.filter.tableName, <span class="hljs-keyword">this</span>.filter.divName);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.sort)
            e = <span class="hljs-keyword">this</span>.filter.sortElement;
        e.appendChild(<span class="hljs-keyword">this</span>.row);
        <span class="hljs-keyword">var</span> td = cel(<span class="hljs-string">'td'</span>, <span class="hljs-keyword">this</span>.row);
        td.style.verticalAlign = <span class="hljs-string">"top"</span>;
        td.style.width = <span class="hljs-string">"100%"</span>;
        <span class="hljs-keyword">this</span>.table = cel(<span class="hljs-string">'table'</span>, td);
        $(<span class="hljs-keyword">this</span>.table).addClassName(<span class="hljs-string">'sn-filter-clause'</span>);
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.filter.getConditionsWanted() || <span class="hljs-keyword">this</span>.sort)
            <span class="hljs-keyword">this</span>.table.className = <span class="hljs-string">"wide"</span>;
        <span class="hljs-keyword">this</span>.tbody = cel(<span class="hljs-string">'TBODY'</span>, <span class="hljs-keyword">this</span>.table);
        <span class="hljs-keyword">this</span>.tbody.id = <span class="hljs-keyword">this</span>.queryID;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.sort)
            <span class="hljs-keyword">this</span>.addSortHeader();
        <span class="hljs-keyword">else</span>
            <span class="hljs-keyword">this</span>.addConditionHeader(first);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.queryID;
    },
    <span class="hljs-attr">addSortHeader</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> tr = <span class="hljs-string">'&lt;tr class="sn-filter-order-message"&gt;&lt;td class="sn-filter-top" &gt;'</span>;
        tr += <span class="hljs-string">"&lt;hr&gt;&lt;/hr&gt;&lt;span style='padding: 10px'&gt;"</span> + <span class="hljs-keyword">this</span>.answer[<span class="hljs-string">'Order results by the following fields'</span>] + <span class="hljs-string">"&lt;/span&gt;"</span>;
        tr += <span class="hljs-string">"&lt;/td&gt;&lt;/tr&gt;"</span>;
        $j(<span class="hljs-keyword">this</span>.tbody).append(tr);
    },
    <span class="hljs-attr">addConditionHeader</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">first</span>) </span>{
        <span class="hljs-keyword">this</span>._addHRTR(first);
        <span class="hljs-keyword">this</span>._addMessageTR(first);
    },
    <span class="hljs-attr">_addHRTR</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">first</span>) </span>{
        <span class="hljs-keyword">var</span> tr = $j(<span class="hljs-string">'&lt;tr&gt;&lt;td class="sn-filter-top sn_multiple_conditions"&gt;&lt;hr&gt;&lt;/hr&gt;&lt;td&gt;&lt;/tr&gt;'</span>);
        $j(<span class="hljs-keyword">this</span>.tbody).append(tr);
        <span class="hljs-keyword">if</span> (first)
            tr.hide();
    },
    <span class="hljs-attr">_addMessageTR</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">first</span>) </span>{
        <span class="hljs-keyword">if</span> (first)
            <span class="hljs-keyword">var</span> m = getMessage(<span class="hljs-string">"All of these conditions must be met"</span>);
        <span class="hljs-keyword">else</span>
            m = getMessage(<span class="hljs-string">"OR all of these conditions must be met"</span>);
        <span class="hljs-keyword">var</span> tr = <span class="hljs-string">'&lt;tr class="sn-filter-section-message"&gt;&lt;td class="sn-filter-top"&gt;'</span>;
        tr += m;
        tr += <span class="hljs-string">"&lt;/td&gt;&lt;/tr&gt;"</span>;
        <span class="hljs-keyword">this</span>.sectionSepMessage = $j(tr);
        $j(<span class="hljs-keyword">this</span>.tbody).append(<span class="hljs-keyword">this</span>.sectionSepMessage);
    },
    <span class="hljs-attr">setFirst</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">length</span>) </span>{
        <span class="hljs-keyword">this</span>.sectionSepMessage.find(<span class="hljs-string">"td"</span>).html(getMessage(<span class="hljs-string">"All of these conditions must be met"</span>));
    },
    <span class="hljs-attr">addSortCondition</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> condition = <span class="hljs-keyword">new</span> GlideSectionCondition(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.queryID);
        <span class="hljs-keyword">this</span>.conditions[<span class="hljs-keyword">this</span>.conditions.length] = condition;
        condition.setOrWanted(<span class="hljs-literal">false</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.runRow == <span class="hljs-literal">null</span>)
            condition.build(<span class="hljs-keyword">this</span>.tbody);
        <span class="hljs-keyword">else</span> {
            condition.build(<span class="hljs-literal">null</span>);
            <span class="hljs-keyword">this</span>.tbody.insertBefore(condition.getRow(), <span class="hljs-keyword">this</span>.runRow);
        }
        <span class="hljs-keyword">return</span> condition;
    },
    <span class="hljs-attr">newPlaceHolder</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.addPlaceHolder(<span class="hljs-literal">true</span>);
    },
    <span class="hljs-attr">removePlaceHolder</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.placeHolderCondition)
            <span class="hljs-keyword">this</span>.placeHolderCondition.remove();
    },
    <span class="hljs-attr">clearPlaceHolder</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.filter.getMaintainPlaceHolder())
            <span class="hljs-keyword">this</span>.placeHolderCondition = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">else</span>
            <span class="hljs-keyword">this</span>.newPlaceHolder();
    },
    <span class="hljs-attr">addPlaceHolder</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">wantOR</span>) </span>{
        <span class="hljs-keyword">this</span>.placeHolderCondition = <span class="hljs-keyword">new</span> GlideSectionCondition(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.queryID);
        <span class="hljs-keyword">this</span>.conditions[<span class="hljs-keyword">this</span>.conditions.length] = <span class="hljs-keyword">this</span>.placeHolderCondition;
        <span class="hljs-keyword">this</span>.placeHolderCondition.setPlaceHolder(<span class="hljs-literal">true</span>);
        <span class="hljs-keyword">this</span>.placeHolderCondition.setOrWanted(<span class="hljs-literal">true</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.runRow == <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">this</span>.placeHolderCondition.buildRow(<span class="hljs-keyword">this</span>.tbody, <span class="hljs-keyword">this</span>.PLACE_HOLDER_FIELD);
        <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">this</span>.placeHolderCondition.buildRow(<span class="hljs-literal">null</span>, <span class="hljs-keyword">this</span>.PLACE_HOLDER_FIELD);
            <span class="hljs-keyword">this</span>.tbody.insertBefore(<span class="hljs-keyword">this</span>.placeHolderCondition.getRow(), <span class="hljs-keyword">this</span>.runRow);
        }
    },
    <span class="hljs-attr">addCondition</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">wantOR, field, oper, value</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.filter.getMaintainPlaceHolder())
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.addConditionWithPlaceHolder(wantOR, field, oper, value);
        <span class="hljs-keyword">if</span> (!field &amp;&amp; !oper &amp;&amp; !value) {
            <span class="hljs-keyword">this</span>.newPlaceHolder();
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.placeHolderCondition == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> field == <span class="hljs-string">"undefined"</span> || field == <span class="hljs-string">''</span>) {
                <span class="hljs-keyword">this</span>.newPlaceHolder();
                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
            }
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> field == <span class="hljs-string">"undefined"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">var</span> condition = <span class="hljs-keyword">new</span> GlideSectionCondition(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.queryID);
        <span class="hljs-keyword">this</span>.conditions[<span class="hljs-keyword">this</span>.conditions.length] = condition;
        condition.setOrWanted(wantOR);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.runRow == <span class="hljs-literal">null</span>)
            condition.buildRow(<span class="hljs-keyword">this</span>.tbody, field, oper, value);
        <span class="hljs-keyword">else</span> {
            condition.buildRow(<span class="hljs-literal">null</span>, field, oper, value);
            <span class="hljs-keyword">this</span>.tbody.insertBefore(condition.getRow(), <span class="hljs-keyword">this</span>.runRow);
        }
        <span class="hljs-keyword">return</span> condition;
    },
    <span class="hljs-attr">addConditionWithPlaceHolder</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">wantOR, field, oper, value</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.placeHolderCondition == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">this</span>.newPlaceHolder();
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> field == <span class="hljs-string">"undefined"</span>)
                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> field == <span class="hljs-string">"undefined"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">var</span> condition = <span class="hljs-keyword">new</span> GlideSectionCondition(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.queryID);
        <span class="hljs-keyword">this</span>.conditions[<span class="hljs-keyword">this</span>.conditions.length - <span class="hljs-number">1</span>] = condition;
        <span class="hljs-keyword">this</span>.conditions[<span class="hljs-keyword">this</span>.conditions.length] = <span class="hljs-keyword">this</span>.placeHolderCondition;
        condition.setOrWanted(wantOR);
        condition.buildRow(<span class="hljs-literal">null</span>, field, oper, value);
        <span class="hljs-keyword">this</span>.tbody.insertBefore(condition.getRow(), <span class="hljs-keyword">this</span>.placeHolderCondition.getRow());
        <span class="hljs-keyword">return</span> condition;
    },
    <span class="hljs-attr">addRunButton</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.runRow != <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">this</span>.runCondition = <span class="hljs-keyword">new</span> GlideSectionCondition(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.queryID);
        <span class="hljs-keyword">this</span>.runCondition.build(<span class="hljs-keyword">this</span>.tbody);
        <span class="hljs-keyword">this</span>.runRow = <span class="hljs-keyword">this</span>.runCondition.getRow();
        <span class="hljs-keyword">this</span>.runRow.basePart = <span class="hljs-string">''</span>;
        <span class="hljs-keyword">this</span>.runCondition.setAsRunRow(<span class="hljs-keyword">this</span>.PLACE_HOLDER_FIELD);
    },
    <span class="hljs-attr">removeRunButton</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.runRow == <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">this</span>.tbody.removeChild(<span class="hljs-keyword">this</span>.runRow);
        clearNodes(<span class="hljs-keyword">this</span>.runRow);
        <span class="hljs-keyword">this</span>.runRow = <span class="hljs-literal">null</span>;
    },
    <span class="hljs-attr">getQueryID</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.queryID;
    },
    <span class="hljs-attr">getID</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.queryID;
    },
    <span class="hljs-attr">getRow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.row;
    },
    <span class="hljs-attr">getFilterTable</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tbody;
    },
    <span class="hljs-attr">setSort</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
        <span class="hljs-keyword">this</span>.sort = b;
    },
    <span class="hljs-attr">getName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.filter.getName();
    },
    <span class="hljs-attr">getFilter</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.filter;
    },
    <span class="hljs-attr">getConditionCount</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.conditions.length;
    },
    <span class="hljs-attr">firstCondition</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">condition</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.conditions[<span class="hljs-number">0</span>] == condition;
    },
    <span class="hljs-attr">removeCondition</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
        <span class="hljs-keyword">var</span> i = findInArray(<span class="hljs-keyword">this</span>.conditions, id);
        <span class="hljs-keyword">if</span> (i == <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">var</span> condition = <span class="hljs-keyword">this</span>.conditions[i];
        <span class="hljs-keyword">this</span>.conditions.splice(i, <span class="hljs-number">1</span>);
        <span class="hljs-keyword">var</span> row = condition.getRow();
        clearNodes(row);
        <span class="hljs-keyword">this</span>.tbody.removeChild(row);
        <span class="hljs-keyword">if</span> (condition == <span class="hljs-keyword">this</span>.placeHolderCondition)
            <span class="hljs-keyword">this</span>.placeHolderCondition = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">this</span>.placeHolderCondition != <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-keyword">this</span>.conditions.length == <span class="hljs-number">1</span>) || <span class="hljs-keyword">this</span>.conditions.length == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">this</span>.filter.removeSection(<span class="hljs-keyword">this</span>.queryID);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i == <span class="hljs-number">0</span>)
            <span class="hljs-keyword">this</span>.conditions[<span class="hljs-number">0</span>].makeFirst();
    },
    <span class="hljs-attr">refreshSelectList</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.conditions.length; i++)
            <span class="hljs-keyword">this</span>.conditions[i].refreshSelectList();
    },
    <span class="hljs-attr">z</span>: <span class="hljs-literal">null</span>
};
<span class="hljs-keyword">var</span> GlideSectionCondition = Class.create();
GlideSectionCondition.prototype = {
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">section, queryID</span>) </span>{
        <span class="hljs-keyword">this</span>.section = section;
        <span class="hljs-keyword">this</span>.filter = section.getFilter();
        <span class="hljs-keyword">this</span>.queryID = queryID;
        <span class="hljs-keyword">this</span>.id = guid();
        <span class="hljs-keyword">this</span>.wantOR = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">this</span>.subConditions = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
        <span class="hljs-keyword">this</span>.field = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.oper = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.value = <span class="hljs-literal">null</span>;
    },
    <span class="hljs-attr">destroy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.section = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.filter = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.row = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.tbody.conditionObject = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.tbody = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.conditionRow.destroy();
        <span class="hljs-keyword">this</span>.actionRow = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.subConditions.length; i++)
            <span class="hljs-keyword">this</span>.subConditions[i].destroy();
    },
    <span class="hljs-attr">build</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">parent</span>) </span>{
        trNew = celQuery(<span class="hljs-string">'tr'</span>, parent, <span class="hljs-keyword">this</span>.queryID);
        <span class="hljs-keyword">this</span>.row = trNew;
        trNew.className = <span class="hljs-string">"filter_row"</span>;
        trNew.basePart = <span class="hljs-string">'true'</span>;
        trNew.conditionObject = <span class="hljs-keyword">this</span>;
        trNew.setAttribute(<span class="hljs-string">"mapping_support"</span>, <span class="hljs-keyword">this</span>.filter.elementSupportsMapping);
        <span class="hljs-keyword">var</span> td = celQuery(<span class="hljs-string">'td'</span>, trNew, <span class="hljs-keyword">this</span>.queryID);
        td.style.width = <span class="hljs-string">"100%"</span>;
        <span class="hljs-keyword">var</span> table = celQuery(<span class="hljs-string">'table'</span>, td, <span class="hljs-keyword">this</span>.queryID);
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.filter.getConditionsWanted())
            table.className = <span class="hljs-string">"wide"</span>;
        <span class="hljs-keyword">this</span>.tbody = celQuery(<span class="hljs-string">'TBODY'</span>, table, <span class="hljs-keyword">this</span>.queryID);
        <span class="hljs-keyword">this</span>.tbody.conditionObject = <span class="hljs-keyword">this</span>;
        <span class="hljs-keyword">var</span> first = <span class="hljs-keyword">this</span>.section.firstCondition(<span class="hljs-keyword">this</span>) &amp;&amp; !<span class="hljs-keyword">this</span>.isPlaceHolder();
        <span class="hljs-keyword">this</span>.conditionRow = <span class="hljs-keyword">new</span> GlideConditionRow(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.queryID, <span class="hljs-keyword">this</span>.wantOR, first);
        <span class="hljs-keyword">var</span> tr = <span class="hljs-keyword">this</span>.conditionRow.getRow();
        <span class="hljs-keyword">this</span>.tbody.appendChild(tr);
        <span class="hljs-keyword">this</span>.actionRow = tr;
        tr.conditionObject = <span class="hljs-keyword">this</span>;
    },
    <span class="hljs-attr">buildRow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">parent, field, oper, value</span>) </span>{
        <span class="hljs-keyword">this</span>.field = field;
        <span class="hljs-keyword">this</span>.oper = oper;
        <span class="hljs-keyword">if</span> (value)
            <span class="hljs-keyword">this</span>.value = value.replace(<span class="hljs-regexp">/&amp;amp;/g</span>, <span class="hljs-string">'&amp;'</span>);
        <span class="hljs-keyword">else</span>
            <span class="hljs-keyword">this</span>.value = value;
        <span class="hljs-keyword">this</span>.build(parent);
        <span class="hljs-keyword">this</span>.conditionRow.build(<span class="hljs-keyword">this</span>.field, <span class="hljs-keyword">this</span>.oper, <span class="hljs-keyword">this</span>.value);
    },
    <span class="hljs-attr">addNewSubCondition</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">field, oper, value</span>) </span>{
        <span class="hljs-keyword">if</span> (field == <span class="hljs-literal">null</span> || <span class="hljs-keyword">typeof</span>(field) == <span class="hljs-string">"undefined"</span>) {
            field = <span class="hljs-keyword">this</span>.conditionRow.getField();
            oper = <span class="hljs-keyword">this</span>.conditionRow.getOper();
        }
        <span class="hljs-keyword">var</span> sub = <span class="hljs-keyword">new</span> GlideSubCondition(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.queryID);
        sub.buildRow(<span class="hljs-keyword">this</span>.tbody, field, oper, value);
        <span class="hljs-keyword">this</span>.subConditions[<span class="hljs-keyword">this</span>.subConditions.length] = sub;
        <span class="hljs-keyword">var</span> $select = $j(sub.getFieldSelect());
        $select.css(<span class="hljs-string">"margin-left"</span>, <span class="hljs-string">"10px"</span>).css(<span class="hljs-string">"display"</span>, <span class="hljs-string">"inline-block"</span>).css(<span class="hljs-string">"width"</span>, <span class="hljs-string">"inherit"</span>);
    },
    <span class="hljs-attr">addLeftButtons</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.conditionRow.addLeftButtons();
    },
    <span class="hljs-attr">getRow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.row;
    },
    <span class="hljs-attr">getBody</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tbody;
    },
    <span class="hljs-attr">getActionRow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.actionRow;
    },
    <span class="hljs-attr">setAsRunRow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.conditionRow.setAsRunRow();
    },
    <span class="hljs-attr">setOrWanted</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
        <span class="hljs-keyword">this</span>.wantOR = b;
    },
    <span class="hljs-attr">remove</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.conditionRow)
            <span class="hljs-keyword">this</span>.conditionRow.destroy();
        <span class="hljs-keyword">this</span>.section.removeCondition(<span class="hljs-keyword">this</span>.id);
        <span class="hljs-keyword">this</span>.section.filter.setSectionClasses();
    },
    <span class="hljs-attr">removeSub</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
        <span class="hljs-keyword">var</span> i = findInArray(<span class="hljs-keyword">this</span>.subConditions, id);
        <span class="hljs-keyword">if</span> (i == <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">var</span> orc = <span class="hljs-keyword">this</span>.subConditions[i];
        clearNodes(orc.getRow());
        <span class="hljs-keyword">this</span>.tbody.removeChild(orc.getRow());
        <span class="hljs-keyword">this</span>.subConditions.splice(i, <span class="hljs-number">1</span>);
    },
    <span class="hljs-attr">getID</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.id;
    },
    <span class="hljs-attr">getFilter</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.filter;
    },
    <span class="hljs-attr">isFirst</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.section.firstCondition(<span class="hljs-keyword">this</span>);
    },
    <span class="hljs-attr">makeFirst</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.conditionRow.makeFirst();
    },
    <span class="hljs-attr">getName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.section.getName();
    },
    <span class="hljs-attr">setPlaceHolder</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) </span>{
        <span class="hljs-keyword">this</span>.placeHolder = b;
    },
    <span class="hljs-attr">isPlaceHolder</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.placeHolder;
    },
    <span class="hljs-attr">removePlaceHolder</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.section)
            <span class="hljs-keyword">this</span>.section.removePlaceHolder();
    },
    <span class="hljs-attr">newPlaceHolder</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.section)
            <span class="hljs-keyword">this</span>.section.newPlaceHolder();
    },
    <span class="hljs-attr">clearPlaceHolder</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.section)
            <span class="hljs-keyword">this</span>.section.clearPlaceHolder();
    },
    <span class="hljs-attr">refreshSelectList</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.conditionRow)
            <span class="hljs-keyword">this</span>.conditionRow.refreshSelectList();
    },
    <span class="hljs-attr">z</span>: <span class="hljs-literal">null</span>
};
<span class="hljs-keyword">var</span> GlideSubCondition = Class.create();
GlideSubCondition.prototype = {
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">condition, queryID</span>) </span>{
        <span class="hljs-keyword">this</span>.condition = condition;
        <span class="hljs-keyword">this</span>.filter = condition.getFilter();
        <span class="hljs-keyword">this</span>.queryID = queryID;
        <span class="hljs-keyword">this</span>.id = guid();
    },
    <span class="hljs-attr">destroy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.filter = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.condition = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.row)
            <span class="hljs-keyword">this</span>.row.destroy();
    },
    <span class="hljs-attr">buildRow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">parent, field, oper, value</span>) </span>{
        <span class="hljs-keyword">this</span>.field = field;
        <span class="hljs-keyword">this</span>.oper = oper;
        <span class="hljs-keyword">if</span> (value)
            <span class="hljs-keyword">this</span>.value = value.replace(<span class="hljs-regexp">/&amp;amp;/g</span>, <span class="hljs-string">'&amp;'</span>);
        <span class="hljs-keyword">else</span>
            <span class="hljs-keyword">this</span>.value = value;
        <span class="hljs-keyword">this</span>.row = <span class="hljs-keyword">new</span> GlideConditionRow(<span class="hljs-keyword">this</span>.condition, queryID, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>);
        <span class="hljs-keyword">var</span> tr = <span class="hljs-keyword">this</span>.row.getRow();
        parent.appendChild(tr);
        tr.conditionObject = <span class="hljs-keyword">this</span>;
        <span class="hljs-keyword">this</span>.row.build(field, oper, <span class="hljs-keyword">this</span>.value)
    },
    <span class="hljs-attr">getNameTD</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.row.getNameTD();
    },
    <span class="hljs-attr">getFieldSelect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.row.getFieldSelect();
    },
    <span class="hljs-attr">getRow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.row.getRow();
    },
    <span class="hljs-attr">getID</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.id;
    },
    <span class="hljs-attr">isPlaceHolder</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.condition.isPlaceHolder();
    },
    <span class="hljs-attr">remove</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.condition.removeSub(<span class="hljs-keyword">this</span>.id);
    },
    <span class="hljs-attr">z</span>: <span class="hljs-literal">null</span>
};
<span class="hljs-keyword">var</span> GlideConditionRow = Class.create();
GlideConditionRow.prototype = {
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">condition, queryID, wantOr, first</span>) </span>{
        <span class="hljs-keyword">this</span>.condition = condition;
        <span class="hljs-keyword">this</span>.filter = condition.getFilter();
        <span class="hljs-keyword">this</span>.first = first;
        <span class="hljs-keyword">this</span>.wantOr = wantOr;
        <span class="hljs-keyword">this</span>.tableName = <span class="hljs-keyword">this</span>.condition.getName();
        <span class="hljs-keyword">this</span>.queryID = queryID;
        <span class="hljs-keyword">this</span>.currentText = [];
        <span class="hljs-keyword">var</span> tr = celQuery(<span class="hljs-string">'tr'</span>, <span class="hljs-literal">null</span>, queryID);
        tr.conditionObject = <span class="hljs-keyword">this</span>.condition;
        tr.rowObject = <span class="hljs-keyword">this</span>;
        tr.className = <span class="hljs-string">"filter_row_condition"</span>;
        tr.style.display = <span class="hljs-string">"table"</span>;
        <span class="hljs-keyword">this</span>.row = tr;
        tr.conditionRow = <span class="hljs-keyword">this</span>;
        <span class="hljs-keyword">this</span>.addAndOrTextCell();
        td = <span class="hljs-keyword">this</span>.addTD(tr, queryID);
        <span class="hljs-keyword">this</span>.tdName = td;
        td.id = <span class="hljs-string">"field"</span>;
        td.className += <span class="hljs-string">" condition-row__field-cell"</span>;
        tr.tdField = td;
        td = <span class="hljs-keyword">this</span>.addTD(tr, queryID);
        <span class="hljs-keyword">this</span>.tdOper = td;
        td.id = <span class="hljs-string">"oper"</span>;
        td.className += <span class="hljs-string">" condition-row__operator-cell"</span>;
        tr.tdOper = td;
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.filter.getOpsWanted())
            td.style.display = <span class="hljs-string">"none"</span>;
        td.style.width = <span class="hljs-string">"auto"</span>;
        td = <span class="hljs-keyword">this</span>.addTD(tr, queryID);
        <span class="hljs-keyword">this</span>.tdValue = td;
        td.id = <span class="hljs-string">"value"</span>;
        td.noWrap = <span class="hljs-literal">true</span>;
        tr.tdValue = td;
        td.className += <span class="hljs-string">" form-inline condition-row__value-cell"</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.filter.elementSupportsMapping) {
            <span class="hljs-keyword">this</span>.addMappingTd(tr);
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.filter.getTextAreasWanted())
            td.style.width = <span class="hljs-string">"90%"</span>;
        <span class="hljs-keyword">this</span>.addPlusImageCell();
        <span class="hljs-keyword">this</span>.addRemoveButtonCell();
        <span class="hljs-keyword">this</span>.answer = getMessages(MESSAGES_FILTER_BUTTONS);
    },
    <span class="hljs-attr">destroy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.filter.clearFieldUsed(<span class="hljs-keyword">this</span>.getField(), <span class="hljs-keyword">this</span>.condition);
        <span class="hljs-keyword">this</span>.filter = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.condition = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.rowCondition = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.row.handler)
            <span class="hljs-keyword">this</span>.row.handler.destroy();
        <span class="hljs-keyword">this</span>.row.tdOper = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.row.tdValue = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.row.tdField = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.row.conditionObject = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.row.rowObject = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.row = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.tdOper = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.tdValue = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.tdName = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.fieldSelect) {
            <span class="hljs-keyword">this</span>.fieldSelect.onchange = <span class="hljs-literal">null</span>;
            <span class="hljs-keyword">this</span>.fieldSelect = <span class="hljs-literal">null</span>;
        }
        <span class="hljs-keyword">this</span>.tdOrButton = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.tdRemoveButton.conditionObject = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.tdRemoveButton = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.tdAndOrText = <span class="hljs-literal">null</span>;
    },
    <span class="hljs-attr">setAsRunRow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">field</span>) </span>{
        <span class="hljs-keyword">this</span>.build(field);
        <span class="hljs-keyword">this</span>.tdName.style.visibility = <span class="hljs-string">'hidden'</span>;
        <span class="hljs-keyword">this</span>.tdOper.style.visibility = <span class="hljs-string">'hidden'</span>;
        <span class="hljs-keyword">this</span>.tdAndOrText.style.visibility = <span class="hljs-string">'hidden'</span>;
        <span class="hljs-keyword">this</span>.row.removeChild(<span class="hljs-keyword">this</span>.tdValue);
        <span class="hljs-keyword">this</span>.row.removeChild(<span class="hljs-keyword">this</span>.tdOrButton);
        <span class="hljs-keyword">this</span>.row.removeChild(<span class="hljs-keyword">this</span>.tdRemoveButton);
        clearNodes(<span class="hljs-keyword">this</span>.tdValue);
        clearNodes(<span class="hljs-keyword">this</span>.tdOrButton);
        clearNodes(<span class="hljs-keyword">this</span>.tdRemoveButton);
        <span class="hljs-keyword">var</span> td = celQuery(<span class="hljs-string">'td'</span>, <span class="hljs-keyword">this</span>.row, <span class="hljs-keyword">this</span>.queryID);
        td.style.width = <span class="hljs-string">"100%"</span>;
        td.style.paddingBottom = <span class="hljs-string">"4px"</span>;
        td.filterObject = <span class="hljs-keyword">this</span>.filter;
        <span class="hljs-keyword">var</span> runCode = <span class="hljs-string">"runThisFilter(this);"</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.filter.runCode)
            runCode = <span class="hljs-keyword">this</span>.filter.runCode;
        td.innerHTML = <span class="hljs-keyword">this</span>.buildRunButton(runCode);
    },
    <span class="hljs-attr">addAndOrTextCell</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> td = <span class="hljs-keyword">this</span>.addTD(<span class="hljs-keyword">this</span>.row, <span class="hljs-keyword">this</span>.queryID);
        td.className += <span class="hljs-string">" condition-row__and-or-text-cell"</span>;
        <span class="hljs-keyword">this</span>.tdAndOrText = td;
        td.style.textAlign = <span class="hljs-string">"right"</span>;
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.filter.getConditionsWanted())
            td.style.display = <span class="hljs-string">"none"</span>;
    },
    <span class="hljs-attr">addPlusImageCell</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> td = <span class="hljs-keyword">this</span>.addTD(<span class="hljs-keyword">this</span>.row, <span class="hljs-keyword">this</span>.queryID);
        td.style.whiteSpace = <span class="hljs-string">"nowrap"</span>;
        td.className += <span class="hljs-string">" condition_buttons_cell"</span>;
        <span class="hljs-keyword">this</span>.tdOrButton = td;
        <span class="hljs-keyword">this</span>.row.tdOrButton = td;
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.filter.getConditionsWanted())
            td.style.display = <span class="hljs-string">"none"</span>;
    },
    <span class="hljs-attr">addRemoveButtonCell</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> td = <span class="hljs-keyword">this</span>.addTD(<span class="hljs-keyword">this</span>.row, <span class="hljs-keyword">this</span>.queryID);
        <span class="hljs-keyword">this</span>.tdRemoveButton = td;
        <span class="hljs-keyword">this</span>.row.tdRemoveButton = td;
        td.conditionObject = <span class="hljs-keyword">this</span>.condition;
        td.className += <span class="hljs-string">" condition-row__remove-cell"</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.wantOr)
            td.hasOrButton = <span class="hljs-string">'true'</span>;
    },
    <span class="hljs-attr">addTD</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">row, queryID</span>) </span>{
        <span class="hljs-keyword">var</span> td = celQuery(<span class="hljs-string">'td'</span>, row, queryID);
        $j(td).addClass(<span class="hljs-string">"sn-filter-top"</span>);
        <span class="hljs-keyword">return</span> td;
    },
    <span class="hljs-attr">addMappingTd</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tr</span>) </span>{
        <span class="hljs-keyword">var</span> mappingTd = cel(<span class="hljs-string">"td"</span>);
        mappingTd.className = <span class="hljs-string">"condition-row__sys-mapping-cell form-inline"</span>;
        tr.appendChild(mappingTd);
        tr.tdMapping = mappingTd;
    },
    <span class="hljs-attr">build</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">field, oper, value</span>) </span>{
        <span class="hljs-keyword">this</span>.field = field;
        <span class="hljs-keyword">this</span>.oper = oper;
        <span class="hljs-keyword">this</span>.value = value;
        <span class="hljs-keyword">var</span> tableName = <span class="hljs-keyword">this</span>.getName();
        <span class="hljs-keyword">var</span> tds = <span class="hljs-keyword">this</span>.row.getElementsByTagName(<span class="hljs-string">"td"</span>);
        <span class="hljs-keyword">this</span>.fieldSelect = _createFilterSelect();
        <span class="hljs-keyword">this</span>.fieldSelect.onchange = <span class="hljs-keyword">this</span>.fieldOnChange.bind(<span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">var</span> sname = tableName.split(<span class="hljs-string">"."</span>)[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.field != <span class="hljs-literal">null</span>)
            sname = sname + <span class="hljs-string">"."</span> + field;
        <span class="hljs-keyword">this</span>.filter.setFieldUsed(field);
        addFirstLevelFields(<span class="hljs-keyword">this</span>.fieldSelect, sname, field, <span class="hljs-keyword">this</span>.filter.filterFields.bind(<span class="hljs-keyword">this</span>.filter), <span class="hljs-literal">null</span>, <span class="hljs-keyword">this</span>.filter, <span class="hljs-keyword">this</span>.filter);
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.tdName) {
            <span class="hljs-keyword">return</span> [];
        }
        <span class="hljs-keyword">this</span>.tdName.appendChild(<span class="hljs-keyword">this</span>.fieldSelect);
        updateFields(tableName, <span class="hljs-keyword">this</span>.fieldSelect, oper, value, <span class="hljs-keyword">this</span>.filter.getIncludeExtended(), <span class="hljs-keyword">this</span>.filter);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.filter.isProtectedField(field))
            <span class="hljs-keyword">this</span>._setReadOnly();
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.filter.fieldName == <span class="hljs-string">"sys_template.template"</span>)
            <span class="hljs-keyword">this</span>.addHelpText();
        currentTable = tableName;
        <span class="hljs-keyword">this</span>.addLeftButtons();
        <span class="hljs-keyword">return</span> tds;
    },
    <span class="hljs-attr">_setReadOnly</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.filter._hideClass(<span class="hljs-keyword">this</span>.row, <span class="hljs-string">"filerTableAction"</span>, <span class="hljs-literal">true</span>);
        <span class="hljs-keyword">this</span>.filter._disableClass(<span class="hljs-keyword">this</span>.row, <span class="hljs-string">"filerTableSelect"</span>, <span class="hljs-literal">true</span>);
        <span class="hljs-keyword">this</span>.filter._disableClass(<span class="hljs-keyword">this</span>.row, <span class="hljs-string">"filerTableInput"</span>, <span class="hljs-literal">true</span>);
    },
    <span class="hljs-attr">fieldOnChange</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.filter.setFieldUsed(<span class="hljs-keyword">this</span>.getField());
        <span class="hljs-keyword">this</span>.filter.clearFieldUsed(<span class="hljs-keyword">this</span>.field, <span class="hljs-keyword">this</span>.condition);
        <span class="hljs-keyword">this</span>.field = <span class="hljs-keyword">this</span>.getField();
        <span class="hljs-keyword">var</span> b = <span class="hljs-keyword">this</span>.condition.isPlaceHolder();
        <span class="hljs-keyword">this</span>.condition.setPlaceHolder(<span class="hljs-literal">false</span>);
        updateFields(<span class="hljs-keyword">this</span>.getName(), <span class="hljs-keyword">this</span>.fieldSelect, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-keyword">this</span>.filter.getIncludeExtended(), <span class="hljs-keyword">this</span>.filter);
        <span class="hljs-keyword">if</span> (b) {
            <span class="hljs-keyword">this</span>.condition.setPlaceHolder(<span class="hljs-literal">false</span>);
            <span class="hljs-keyword">this</span>.showFields();
            <span class="hljs-keyword">this</span>.condition.clearPlaceHolder();
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.condition.isFirst())
                <span class="hljs-keyword">this</span>.makeFirst();
        }
        <span class="hljs-keyword">this</span>.filter.refreshSelectList();
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.filter.fieldName == <span class="hljs-string">"sys_template.template"</span>)
            <span class="hljs-keyword">this</span>.addHelpText();
        <span class="hljs-keyword">var</span> form = <span class="hljs-keyword">this</span>.getFieldSelect().up(<span class="hljs-string">'form'</span>);
        <span class="hljs-keyword">if</span> (form) {
            <span class="hljs-keyword">var</span> nameWithoutTablePrefix = <span class="hljs-keyword">this</span>.getName().substring(<span class="hljs-keyword">this</span>.getName().indexOf(<span class="hljs-string">"."</span>) + <span class="hljs-number">1</span>);
            form.fire(<span class="hljs-string">"glideform:onchange"</span>, {
                <span class="hljs-attr">id</span>: nameWithoutTablePrefix,
                <span class="hljs-attr">value</span>: <span class="hljs-built_in">unescape</span>(getFilter(<span class="hljs-keyword">this</span>.getName())),
                <span class="hljs-attr">modified</span>: <span class="hljs-literal">true</span>
            });
        }
    },
    <span class="hljs-attr">addHelpText</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.fieldElements = <span class="hljs-keyword">this</span>.condition.actionRow.getAttribute(<span class="hljs-string">"type"</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.fieldElements) {
            <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">this</span>.fieldElements) {
                <span class="hljs-keyword">case</span> <span class="hljs-string">"color"</span>:
                    <span class="hljs-keyword">this</span>.helpText(<span class="hljs-string">"Insert HTML color name or hex value"</span>);
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-string">"glide_list"</span>:
                <span class="hljs-keyword">case</span> <span class="hljs-string">"slushbucket"</span>:
                <span class="hljs-keyword">case</span> <span class="hljs-string">"user_roles"</span>:
                    <span class="hljs-keyword">this</span>.helpText(<span class="hljs-string">"Separate individual references with a comma"</span>);
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-string">"composite_name"</span>:
                    <span class="hljs-keyword">this</span>.helpText(<span class="hljs-string">"Use the following format: TableName.FieldName"</span>);
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-string">"days_of_week"</span>:
                    <span class="hljs-keyword">this</span>.helpText(<span class="hljs-string">"1 for Monday, 2 for Tuesday, etc. Multiple values can be entered, like '135' for Monday, Wednesday, and Friday"</span>);
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-string">"html"</span>:
                <span class="hljs-keyword">case</span> <span class="hljs-string">"translated_html"</span>:
                    <span class="hljs-keyword">this</span>.helpText(<span class="hljs-string">"Enter text in HTML format"</span>);
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">default</span>:
                    <span class="hljs-keyword">this</span>.removeHelpText();
            }
        }
    },
    <span class="hljs-attr">helpText</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">text</span>) </span>{
        <span class="hljs-keyword">this</span>.removeHelpText();
        <span class="hljs-keyword">var</span> newDiv = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
        <span class="hljs-keyword">var</span> newContent = <span class="hljs-built_in">document</span>.createTextNode(text);
        newDiv.appendChild(newContent);
        newDiv.id = <span class="hljs-keyword">this</span>.fieldElements;
        newDiv.className = <span class="hljs-string">'fieldmsg'</span>;
        <span class="hljs-keyword">var</span> currentDiv = <span class="hljs-keyword">this</span>.condition.tbody;
        currentDiv.insertBefore(newDiv, <span class="hljs-literal">null</span>);
        <span class="hljs-keyword">this</span>.currentText.push(<span class="hljs-keyword">this</span>.fieldElements);
    },
    <span class="hljs-attr">removeHelpText</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.currentText.length; i++) {
            <span class="hljs-keyword">var</span> parNode = gel(<span class="hljs-keyword">this</span>.currentText[i]).parentElement;
            <span class="hljs-keyword">var</span> chilNode = parNode.childNodes;
            chilNode[<span class="hljs-number">1</span>].remove();
            <span class="hljs-keyword">this</span>.currentText.splice(i, <span class="hljs-number">1</span>);
        }
    },
    <span class="hljs-attr">getNameTD</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tdName;
    },
    <span class="hljs-attr">getFieldSelect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.fieldSelect;
    },
    <span class="hljs-attr">getField</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> select = getSelectedOption(<span class="hljs-keyword">this</span>.fieldSelect);
        <span class="hljs-keyword">if</span> (select != <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">return</span> select.value;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    },
    <span class="hljs-attr">getOper</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>.getOperSelect();
        <span class="hljs-keyword">return</span> getSelectedOption(s).value;
    },
    <span class="hljs-attr">getOperSelect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tdOper.getElementsByTagName(<span class="hljs-string">"select"</span>)[<span class="hljs-number">0</span>];
    },
    <span class="hljs-attr">getValueInput</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tdValue.getElementsByTagName(<span class="hljs-string">"input"</span>)[<span class="hljs-number">0</span>];
    },
    <span class="hljs-attr">getRow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.row;
    },
    <span class="hljs-attr">getName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tableName;
    },
    <span class="hljs-attr">showFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.tdRemoveButton.style.visibility = <span class="hljs-string">'visible'</span>;
        <span class="hljs-keyword">this</span>.tdOrButton.style.visibility = <span class="hljs-string">'visible'</span>;
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.first)
            <span class="hljs-keyword">this</span>.tdAndOrText.style.visibility = <span class="hljs-string">'visible'</span>;
        <span class="hljs-keyword">this</span>.getOperSelect().disabled = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">var</span> cel = <span class="hljs-keyword">this</span>.getValueInput();
        <span class="hljs-keyword">if</span> (cel)
            cel.disabled = <span class="hljs-literal">false</span>;
    },
    <span class="hljs-attr">addLeftButtons</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.wantOr) {
            tdAddOr = <span class="hljs-keyword">this</span>.tdOrButton;
            <span class="hljs-keyword">var</span> fDiv = <span class="hljs-keyword">this</span>.filter.getDiv() || getThing(<span class="hljs-keyword">this</span>.filter.tableName, <span class="hljs-keyword">this</span>.filter.divName);
            fDiv = fDiv.id.split(<span class="hljs-string">"gcond_filters"</span>, <span class="hljs-number">1</span>);
            <span class="hljs-keyword">var</span> andOnClick = <span class="hljs-string">"addConditionSpec('"</span> + <span class="hljs-keyword">this</span>.tableName + <span class="hljs-string">"','"</span> + <span class="hljs-keyword">this</span>.queryID + <span class="hljs-string">"','','','','"</span> + fDiv + <span class="hljs-string">"'); return false;"</span>;
            <span class="hljs-keyword">var</span> orOnClick = <span class="hljs-string">"newSubRow(this,'"</span> + fDiv + <span class="hljs-string">"'); return false;"</span>;
            tdAddOr.innerHTML = <span class="hljs-keyword">this</span>.getAndButtonHTML(andOnClick) + <span class="hljs-keyword">this</span>.getOrButtonHTML(orOnClick);
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.condition.isPlaceHolder())
                tdAddOr.style.visibility = <span class="hljs-string">'hidden'</span>;
        }
        <span class="hljs-keyword">var</span> td = <span class="hljs-keyword">this</span>.tdRemoveButton;
        <span class="hljs-keyword">var</span> tdMessage = <span class="hljs-keyword">this</span>.tdAndOrText;
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.wantOr) {
            <span class="hljs-keyword">if</span> (td.parentNode.sortSpec != <span class="hljs-literal">true</span>) {
                <span class="hljs-keyword">var</span> fieldTD = <span class="hljs-keyword">this</span>.row.childNodes[<span class="hljs-number">1</span>];
                <span class="hljs-keyword">var</span> orSpan = <span class="hljs-string">"&lt;span class='sn-or-message'&gt;"</span> + <span class="hljs-keyword">this</span>.answer[<span class="hljs-string">'or'</span>] + <span class="hljs-string">"&lt;/span&gt;"</span>;
                $(fieldTD).insert({
                    <span class="hljs-attr">top</span>: orSpan
                });
            } <span class="hljs-keyword">else</span> {
                tdMessage.innerHTML = <span class="hljs-string">''</span>;
            }
        }
        tdMessage.style.width = DEFAULT_WIDTH;
        <span class="hljs-keyword">var</span> id = <span class="hljs-string">'r'</span> + guid();
        td.id = id;
        <span class="hljs-keyword">var</span> deleteOnClick = <span class="hljs-string">"deleteFilterByID('"</span> + <span class="hljs-keyword">this</span>.getName() + <span class="hljs-string">"','"</span> + id + <span class="hljs-string">"');"</span>;
        td.innerHTML = <span class="hljs-keyword">this</span>.getDeleteButtonHTML(id, deleteOnClick);
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.condition.isPlaceHolder())
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.filter.defaultPlaceHolder)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.filter.getMaintainPlaceHolder() || <span class="hljs-keyword">this</span>.filter.singleCondition())
            td.style.visibility = <span class="hljs-string">'hidden'</span>;
    },
    <span class="hljs-attr">getAndButtonHTML</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">onClick</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"&lt;button onclick=\""</span> + onClick + <span class="hljs-string">"\" title='"</span> + <span class="hljs-keyword">this</span>.answer[<span class="hljs-string">'Add AND Condition'</span>] + <span class="hljs-string">"' alt='"</span> + <span class="hljs-keyword">this</span>.answer[<span class="hljs-string">'Add AND Condition'</span>] + <span class="hljs-string">"' class='btn btn-default filerTableAction'&gt;"</span> + <span class="hljs-keyword">this</span>.answer[<span class="hljs-string">'and'</span>].toUpperCase() + <span class="hljs-string">"&lt;/button&gt;"</span>;
    },
    <span class="hljs-attr">getOrButtonHTML</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">onClick</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"&lt;button onclick=\""</span> + onClick + <span class="hljs-string">"\" title='"</span> + <span class="hljs-keyword">this</span>.answer[<span class="hljs-string">'Add OR Condition'</span>] + <span class="hljs-string">"' alt='"</span> + <span class="hljs-keyword">this</span>.answer[<span class="hljs-string">'Add OR Condition'</span>] + <span class="hljs-string">"' class='btn btn-default filerTableAction'&gt;"</span> + <span class="hljs-keyword">this</span>.answer[<span class="hljs-string">'or'</span>].toUpperCase() + <span class="hljs-string">"&lt;/button&gt;"</span>;
    },
    <span class="hljs-attr">getDeleteButtonHTML</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id, onClick</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"&lt;button onclick=\""</span> + onClick + <span class="hljs-string">"\" title='"</span> + <span class="hljs-keyword">this</span>.answer[<span class="hljs-string">'Delete'</span>] + <span class="hljs-string">"' type='button' class='filerTableAction btn btn-default deleteButton'&gt;&lt;span class='icon-cross'&gt;&lt;/span&gt;&lt;span class=\"sr-only\"&gt;'"</span> + <span class="hljs-keyword">this</span>.answer[<span class="hljs-string">'Delete'</span>] + <span class="hljs-string">"'&lt;/span&gt;&lt;/button&gt;"</span>;
    },
    <span class="hljs-attr">makeFirst</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> tdMessage = <span class="hljs-keyword">this</span>.tdAndOrText;
        tdMessage.innerHTML = <span class="hljs-string">''</span>;
        tdMessage.style.color = tdMessage.style.backgroundColor;
        tdMessage.style.visibility = <span class="hljs-string">'hidden'</span>;
        tdMessage.style.width = DEFAULT_WIDTH;
    },
    <span class="hljs-attr">refreshSelectList</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.condition.isPlaceHolder())
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">var</span> tableName = <span class="hljs-keyword">this</span>.getName();
        <span class="hljs-keyword">var</span> sname = tableName.split(<span class="hljs-string">"."</span>)[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.field != <span class="hljs-literal">null</span>)
            sname = sname + <span class="hljs-string">"."</span> + <span class="hljs-keyword">this</span>.field;
        addFirstLevelFields(<span class="hljs-keyword">this</span>.fieldSelect, sname, <span class="hljs-keyword">this</span>.field, <span class="hljs-keyword">this</span>.filter.filterFields.bind(<span class="hljs-keyword">this</span>.filter), <span class="hljs-literal">null</span>, <span class="hljs-keyword">this</span>.filter);
    },
    <span class="hljs-attr">buildRunButton</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{
        <span class="hljs-keyword">var</span> m = <span class="hljs-keyword">new</span> GwtMessage();
        <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;button class="btn btn-default" tabindex="0" onclick="'</span> + f + <span class="hljs-string">'" title="'</span> + m.getMessage(<span class="hljs-string">'Run Filter'</span>) + <span class="hljs-string">'"&gt;'</span> + m.getMessage(<span class="hljs-string">'Run'</span>) + <span class="hljs-string">'&lt;/button&gt;'</span>;
    },
    <span class="hljs-attr">z</span>: <span class="hljs-literal">null</span>
};
<span class="hljs-keyword">var</span> GlideSortSection = Class.create();
GlideSortSection.prototype = {
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">filter</span>) </span>{
        <span class="hljs-keyword">this</span>.filter = filter;
        <span class="hljs-keyword">this</span>.locateSection();
    },
    <span class="hljs-attr">destroy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.filter = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.section = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.rowTable = <span class="hljs-literal">null</span>;
    },
    <span class="hljs-attr">locateSection</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.section = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.rowTable = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">var</span> divRows = <span class="hljs-keyword">this</span>.filter.sortElement.getElementsByTagName(<span class="hljs-string">"tr"</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; divRows.length; i++) {
            <span class="hljs-keyword">var</span> rowTR = divRows[i];
            <span class="hljs-keyword">if</span> (rowTR.sortRow == <span class="hljs-string">'true'</span>) {
                <span class="hljs-keyword">this</span>.section = rowTR.rowObject;
                <span class="hljs-keyword">this</span>.rowTable = <span class="hljs-keyword">this</span>.section.getFilterTable();
                <span class="hljs-keyword">this</span>.queryID = <span class="hljs-keyword">this</span>.section.getQueryID();
                <span class="hljs-keyword">break</span>;
            }
        }
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.section) {
            section = <span class="hljs-keyword">new</span> GlideFilterSection(<span class="hljs-keyword">this</span>.filter);
            section.setSort(<span class="hljs-literal">true</span>);
            <span class="hljs-keyword">this</span>.queryID = section._setup(<span class="hljs-literal">true</span>);
            <span class="hljs-keyword">this</span>.section = section;
            <span class="hljs-keyword">this</span>.rowTable = section.getFilterTable();
            <span class="hljs-keyword">this</span>.section.getRow().sortRow = <span class="hljs-string">'true'</span>;
        }
    },
    <span class="hljs-attr">addField</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">field, oper</span>) </span>{
        <span class="hljs-keyword">this</span>.locateSection();
        <span class="hljs-keyword">if</span> (!oper)
            oper = <span class="hljs-string">"ascending"</span>;
        <span class="hljs-keyword">var</span> condition = <span class="hljs-keyword">this</span>.section.addSortCondition(<span class="hljs-literal">false</span>);
        <span class="hljs-keyword">var</span> row = condition.getRow();
        row.sortSpec = <span class="hljs-literal">true</span>;
        row = condition.getActionRow();
        row.sortSpec = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">var</span> fSelect = addFields(<span class="hljs-keyword">this</span>.getName(), field, <span class="hljs-literal">true</span>, <span class="hljs-keyword">this</span>.filter.getIncludeExtended());
        <span class="hljs-keyword">var</span> tdName = row.tdField;
        tdName.appendChild(fSelect);
        updateFields(<span class="hljs-keyword">this</span>.getName(), fSelect, oper, <span class="hljs-literal">null</span>, <span class="hljs-keyword">this</span>.filter.getIncludeExtended(), <span class="hljs-keyword">this</span>.filter);
        condition.addLeftButtons();
    },
    <span class="hljs-attr">getSection</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.section;
    },
    <span class="hljs-attr">getName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.filter.getName();
    },
    <span class="hljs-attr">getID</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.queryID;
    },
    <span class="hljs-attr">removeRunButton</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.section.removeRunButton();
    },
    <span class="hljs-attr">addRunButton</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.section.addRunButton();
    },
    <span class="hljs-attr">z</span>: <span class="hljs-literal">null</span>
};
<span class="hljs-keyword">var</span> GlideEncodedQuery = Class.create();
GlideEncodedQuery.prototype = {
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, query, callback</span>) </span>{
        <span class="hljs-keyword">this</span>.init();
        <span class="hljs-keyword">this</span>.callback = callback;
        <span class="hljs-keyword">this</span>.name = name;
        <span class="hljs-keyword">this</span>.encodedQuery = query;
    },
    <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.orderBy = [];
        <span class="hljs-keyword">this</span>.groupBy = [];
        <span class="hljs-keyword">this</span>.terms = [];
    },
    <span class="hljs-attr">parse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.reset(<span class="hljs-keyword">this</span>.name, <span class="hljs-keyword">this</span>.encodedQuery);
    },
    <span class="hljs-attr">destroy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.orderBy.length; i++)
            <span class="hljs-keyword">this</span>.orderBy[i].destroy();
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.groupBy.length; i++)
            <span class="hljs-keyword">this</span>.groupBy[i].destroy();
    },
    <span class="hljs-attr">reset</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, query</span>) </span>{
        <span class="hljs-keyword">this</span>.init();
        <span class="hljs-keyword">this</span>.tableName = name;
        <span class="hljs-keyword">this</span>.encodedQuery = query;
        <span class="hljs-keyword">this</span>.decode();
    },
    <span class="hljs-attr">decode</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.getEncodedParts();
    },
    <span class="hljs-attr">getEncodedParts</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> g_filter_description != <span class="hljs-string">'undefined'</span> &amp;&amp; <span class="hljs-keyword">this</span>.tableName == g_filter_description.getName() &amp;&amp;
            <span class="hljs-keyword">this</span>.encodedQuery == g_filter_description.getFilter()) {
            <span class="hljs-keyword">this</span>.partsXML = loadXML(g_filter_description.getParsedQuery());
            <span class="hljs-keyword">this</span>.parseXML();
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">'QueryParseAjax'</span>);
        ajax.addParam(<span class="hljs-string">'sysparm_chars'</span>, <span class="hljs-keyword">this</span>.encodedQuery);
        ajax.addParam(<span class="hljs-string">'sysparm_name'</span>, <span class="hljs-keyword">this</span>.tableName);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.callback)
            ajax.getXML(<span class="hljs-keyword">this</span>.getEncodedPartsResponse.bind(<span class="hljs-keyword">this</span>));
        <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">this</span>.partsXML = ajax.getXMLWait();
            <span class="hljs-keyword">this</span>.parseXML();
        }
    },
    <span class="hljs-attr">getEncodedPartsResponse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) </span>{
        <span class="hljs-keyword">if</span> (!response || !response.responseXML)
            <span class="hljs-keyword">this</span>.callback();
        <span class="hljs-keyword">this</span>.partsXML = response.responseXML;
        <span class="hljs-keyword">this</span>.parseXML();
    },
    <span class="hljs-attr">parseXML</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> items = <span class="hljs-keyword">this</span>.partsXML.getElementsByTagName(<span class="hljs-string">"item"</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
            <span class="hljs-keyword">var</span> item = items[i];
            <span class="hljs-keyword">var</span> qp = <span class="hljs-keyword">new</span> GlideQueryPart(item);
            <span class="hljs-keyword">if</span> (qp.isGroupBy()) {
                <span class="hljs-keyword">this</span>.addGroupBy(qp.getValue())
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (qp.isOrderBy()) {
                <span class="hljs-keyword">this</span>.addOrderBy(qp.getValue(), qp.isAscending());
            } <span class="hljs-keyword">else</span>
                <span class="hljs-keyword">this</span>.terms[<span class="hljs-keyword">this</span>.terms.length] = qp;
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.callback)
            <span class="hljs-keyword">this</span>.callback();
    },
    <span class="hljs-attr">getXML</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.partsXML;
    },
    <span class="hljs-attr">addGroupBy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">groupBy</span>) </span>{
        <span class="hljs-keyword">this</span>.groupBy[<span class="hljs-keyword">this</span>.groupBy.length] = groupBy;
    },
    <span class="hljs-attr">addOrderBy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">orderBy, ascending</span>) </span>{
        <span class="hljs-keyword">this</span>.orderBy[<span class="hljs-keyword">this</span>.orderBy.length] = <span class="hljs-keyword">new</span> GlideSortSpec(orderBy, ascending);
    },
    <span class="hljs-attr">getTerms</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.terms;
    },
    <span class="hljs-attr">getOrderBy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.orderBy;
    },
    <span class="hljs-attr">getGroupBy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.groupBy;
    },
    <span class="hljs-attr">z</span>: <span class="hljs-literal">null</span>
};
<span class="hljs-keyword">var</span> GlideQueryPart = Class.create();
GlideQueryPart.prototype = {
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
        <span class="hljs-keyword">this</span>.item = item;
        <span class="hljs-keyword">this</span>.groupBy = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">this</span>.orderBy = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">this</span>.ascending = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">this</span>.Goto = item.getAttribute(<span class="hljs-string">"goto"</span>);
        <span class="hljs-keyword">this</span>.EndQuery = item.getAttribute(<span class="hljs-string">"endquery"</span>);
        <span class="hljs-keyword">this</span>.NewQuery = item.getAttribute(<span class="hljs-string">"newquery"</span>);
        <span class="hljs-keyword">this</span>.OR = item.getAttribute(<span class="hljs-string">"or"</span>);
        <span class="hljs-keyword">this</span>.displayValue = item.getAttribute(<span class="hljs-string">"display_value"</span>);
        <span class="hljs-keyword">this</span>.valid = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">this</span>.extract();
    },
    <span class="hljs-attr">destroy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.item = <span class="hljs-literal">null</span>;
    },
    <span class="hljs-attr">isOR</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.OR == <span class="hljs-string">'true'</span>;
    },
    <span class="hljs-attr">isNewQuery</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.NewQuery == <span class="hljs-string">'true'</span>;
    },
    <span class="hljs-attr">isGoTo</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.Goto == <span class="hljs-string">'true'</span>;
    },
    <span class="hljs-attr">extract</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.EndQuery == <span class="hljs-string">'true'</span>) {
            <span class="hljs-keyword">this</span>.valid = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">this</span>.operator = <span class="hljs-keyword">this</span>.item.getAttribute(<span class="hljs-string">"operator"</span>);
        <span class="hljs-keyword">this</span>.value = <span class="hljs-keyword">this</span>.item.getAttribute(<span class="hljs-string">"value"</span>);
        <span class="hljs-keyword">this</span>.field = <span class="hljs-keyword">this</span>.item.getAttribute(<span class="hljs-string">"field"</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.operator == <span class="hljs-string">'GROUPBY'</span>) {
            <span class="hljs-keyword">this</span>.groupBy = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.operator == <span class="hljs-string">'ORDERBYDESC'</span>) {
            <span class="hljs-keyword">this</span>.orderBy = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">this</span>.ascending = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.operator == <span class="hljs-string">'ORDERBY'</span>) {
            <span class="hljs-keyword">this</span>.orderBy = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">this</span>.ascending = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; operators.length; i++) {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.operator == operators[i])
                <span class="hljs-keyword">break</span>;
        }
        <span class="hljs-keyword">if</span> (i == operators.length) {
            <span class="hljs-keyword">this</span>.valid = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.field.startsWith(<span class="hljs-string">"variables."</span>)) {
            <span class="hljs-keyword">this</span>.value = <span class="hljs-keyword">this</span>.field.substring(<span class="hljs-number">10</span>) + <span class="hljs-keyword">this</span>.operator + <span class="hljs-keyword">this</span>.value;
            <span class="hljs-keyword">this</span>.field = <span class="hljs-string">"variables"</span>;
            <span class="hljs-keyword">this</span>.operator = <span class="hljs-string">'='</span>;
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.field.startsWith(<span class="hljs-string">"sys_tags."</span>))
            <span class="hljs-keyword">this</span>.field = <span class="hljs-string">"sys_tags"</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.operator == <span class="hljs-string">"HASVARIABLE"</span> || <span class="hljs-keyword">this</span>.operator == <span class="hljs-string">"HASITEMVARIABLE"</span>) {
            <span class="hljs-keyword">this</span>.operator = <span class="hljs-string">'='</span>;
            <span class="hljs-keyword">this</span>.field = <span class="hljs-string">"variables"</span>;
            <span class="hljs-keyword">this</span>.value = <span class="hljs-keyword">this</span>.value.substring(<span class="hljs-number">1</span>);
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.operator == <span class="hljs-string">"HASQUESTION"</span>) {
            <span class="hljs-keyword">this</span>.operator = <span class="hljs-string">'='</span>;
            <span class="hljs-keyword">this</span>.field = <span class="hljs-string">"variables"</span>;
            <span class="hljs-keyword">this</span>.value = <span class="hljs-keyword">this</span>.value.substring(<span class="hljs-number">1</span>);
        }
    },
    <span class="hljs-attr">getOperator</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.operator.title = <span class="hljs-string">"Operator"</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.operator;
    },
    <span class="hljs-attr">getField</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.field.title = <span class="hljs-string">"Field"</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.field;
    },
    <span class="hljs-attr">getValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.value.title = <span class="hljs-string">"Value"</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.value;
    },
    <span class="hljs-attr">isValid</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.valid;
    },
    <span class="hljs-attr">isGroupBy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.groupBy;
    },
    <span class="hljs-attr">isOrderBy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.orderBy;
    },
    <span class="hljs-attr">isAscending</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.ascending;
    },
    <span class="hljs-attr">z</span>: <span class="hljs-literal">null</span>
};
<span class="hljs-keyword">var</span> GlideSortSpec = Class.create();
GlideSortSpec.prototype = {
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, ascending</span>) </span>{
        <span class="hljs-keyword">this</span>.field = name;
        <span class="hljs-keyword">this</span>.ascending = ascending;
    },
    <span class="hljs-attr">getName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.field;
    },
    <span class="hljs-attr">isAscending</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.ascending;
    },
    <span class="hljs-attr">z</span>: <span class="hljs-literal">null</span>
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">newSubRow</span>(<span class="hljs-params">elBut, name</span>) </span>{
    <span class="hljs-keyword">var</span> fDiv = getThing(name, <span class="hljs-string">'gcond_filters'</span>);
    <span class="hljs-keyword">if</span> (fDiv &amp;&amp; !checkFilterSize(fDiv.filterObject))
        <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> butTD = elBut.parentNode;
    <span class="hljs-keyword">var</span> butTR = butTD.parentNode;
    <span class="hljs-keyword">var</span> butTable = butTR.parentNode;
    butTable.conditionObject.addNewSubCondition();
    _frameChanged();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findInArray</span>(<span class="hljs-params">a, searchID</span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; a.length; i++) {
        <span class="hljs-keyword">var</span> condition = a[i];
        <span class="hljs-keyword">if</span> (condition.getID() == searchID)
            <span class="hljs-keyword">return</span> i;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">celQuery</span>(<span class="hljs-params">name, parent, queryID</span>) </span>{
    <span class="hljs-keyword">var</span> e = cel(name);
    <span class="hljs-keyword">if</span> (parent)
        parent.appendChild(e);
    e.queryID = queryID;
    <span class="hljs-keyword">return</span> e;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">runThisFilter</span>(<span class="hljs-params">atag</span>) </span>{
    <span class="hljs-keyword">var</span> filterObj = atag.parentNode.filterObject;
    <span class="hljs-keyword">var</span> tableName = filterObj.getName();
    <span class="hljs-keyword">if</span> (runFilterHandlers[tableName]) {
        <span class="hljs-keyword">var</span> filter = getFilter(tableName);
        runFilterHandlers[tableName](tableName, filter);
        <span class="hljs-keyword">return</span>;
    }
    filterObj.runFilter();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buildURL</span>(<span class="hljs-params">tableName, query</span>) </span>{
    <span class="hljs-keyword">var</span> url = (tableName.split(<span class="hljs-string">"."</span>))[<span class="hljs-number">0</span>] + <span class="hljs-string">"_list.do?sysparm_query="</span> + query;
    <span class="hljs-keyword">var</span> view = gel(<span class="hljs-string">'sysparm_view'</span>);
    <span class="hljs-keyword">if</span> (view) {
        view = view.value;
        url += <span class="hljs-string">'&amp;sysparm_view='</span> + view;
    }
    <span class="hljs-keyword">var</span> refQuery = gel(<span class="hljs-string">'sysparm_ref_list_query'</span>);
    <span class="hljs-keyword">if</span> (refQuery)
        url += <span class="hljs-string">"&amp;sysparm_ref_list_query="</span> + refQuery.value;
    <span class="hljs-keyword">var</span> target = gel(<span class="hljs-string">'sysparm_target'</span>);
    <span class="hljs-keyword">if</span> (target) {
        target = target.value;
        url += <span class="hljs-string">'&amp;sysparm_target='</span> + target;
        url += <span class="hljs-string">'&amp;sysparm_stack=no'</span>;
        <span class="hljs-keyword">var</span> e = gel(<span class="hljs-string">"sysparm_reflist_pinned"</span>);
        <span class="hljs-keyword">if</span> (e)
            url += <span class="hljs-string">'&amp;sysparm_reflist_pinned='</span> + e.value;
    }
    <span class="hljs-keyword">return</span> url;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createCondFilter</span>(<span class="hljs-params">tname, query, fieldName, elem</span>) </span>{
<span class="hljs-meta">    "use strict"</span>
    noOps = <span class="hljs-literal">false</span>;
    noSort = <span class="hljs-literal">false</span>;
    noConditionals = <span class="hljs-literal">false</span>;
    useTextareas = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">new</span> GlideConditionsHandler(tname, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">filter</span>) </span>{
        <span class="hljs-keyword">if</span> (filter) {
            <span class="hljs-keyword">var</span> filterDiv = filter.getDiv() || getThing(filter.tableName, filter.divName);
            <span class="hljs-keyword">if</span> (filterDiv) {
                filterDiv.initialQuery = query;
            }
            filter.setQuery(query);
            g_form.registerHandler(fieldName, filter);
            <span class="hljs-keyword">if</span> (elem &amp;&amp; elem.getAttribute(<span class="hljs-string">"readonly"</span>) === <span class="hljs-string">"readonly"</span>) {
                <span class="hljs-keyword">var</span> formTable = g_form.getTableName();
                <span class="hljs-keyword">var</span> fieldNameWithoutPrefix = fieldName.replace(formTable + <span class="hljs-string">'.'</span>, <span class="hljs-string">''</span>);
                g_form.setReadOnly(fieldNameWithoutPrefix, <span class="hljs-literal">true</span>);
            }
            $(filterDiv).fire(<span class="hljs-string">'glide:filter.create.condition_filter'</span>, filter);
        }
    }, fieldName);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkFilterSize</span>(<span class="hljs-params">filterObject</span>) </span>{
    <span class="hljs-keyword">var</span> validFilterSize = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">var</span> filterString = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isNaN</span>(g_glide_list_filter_max_length) || g_glide_list_filter_max_length &lt;= <span class="hljs-number">0</span>)
        <span class="hljs-keyword">return</span> validFilterSize;
    <span class="hljs-keyword">if</span> (filterObject === <span class="hljs-literal">undefined</span> || filterObject === <span class="hljs-literal">null</span>)
        <span class="hljs-keyword">return</span> validFilterSize;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> filterObject === <span class="hljs-string">"object"</span> &amp;&amp; filterObject[<span class="hljs-string">"type"</span>] === <span class="hljs-string">'GlideFilter'</span>)
        filterString = getFilter(filterObject.getDiv().id.split(<span class="hljs-string">"gcond_filters"</span>, <span class="hljs-number">1</span>));
    <span class="hljs-keyword">if</span> (filterString &amp;&amp; filterString.length &gt; g_glide_list_filter_max_length) {
        <span class="hljs-keyword">var</span> dialog = <span class="hljs-keyword">new</span> GlideDialogWindow(<span class="hljs-string">'filter_limit_window'</span>, <span class="hljs-literal">false</span>);
        dialog.setTitle(getMessage(<span class="hljs-string">"Filter Limit Reached"</span>));
        dialog.setBody(<span class="hljs-string">"&lt;div style='padding: 10px'&gt;"</span> + getMessage(<span class="hljs-string">"The filter you are using is too big. Remove some conditions to make it smaller."</span>) + <span class="hljs-string">"&lt;/div&gt;"</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>);
        $(<span class="hljs-string">"filter_limit_window"</span>).style.visibility = <span class="hljs-string">"visible"</span>;
        validFilterSize = <span class="hljs-literal">false</span>;
    }
    <span class="hljs-keyword">return</span> validFilterSize;
}
<span class="hljs-built_in">document</span>.on(<span class="hljs-string">'click'</span>, <span class="hljs-string">'button.filter_add_sort'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
    <span class="hljs-keyword">var</span> name = element.getAttribute(<span class="hljs-string">'data-name'</span>);
    addSortSpec(name);
    evt.stopPropagation();
});
<span class="hljs-built_in">document</span>.on(<span class="hljs-string">'click'</span>, <span class="hljs-string">'button.filter_add_filter'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
    <span class="hljs-keyword">var</span> name = element.getAttribute(<span class="hljs-string">'data-name'</span>);
    addConditionSpec(name);
    evt.stopPropagation();
});
<span class="hljs-built_in">document</span>.on(<span class="hljs-string">'click'</span>, <span class="hljs-string">'button.filter_and_filter'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt, element</span>) </span>{
    <span class="hljs-keyword">var</span> name = element.getAttribute(<span class="hljs-string">'data-name'</span>);
    addCondition(name);
    evt.stopPropagation();
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/util/NameMapEntry.js */</span>
<span class="hljs-keyword">var</span> NameMapEntry = Class.create({
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">prettyName, realName</span>) </span>{
        <span class="hljs-keyword">this</span>.prettyName = prettyName;
        <span class="hljs-keyword">this</span>.realName = realName;
    }
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/doctype/form_submitted_mask.js */</span>
addLoadEvent(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> isDoctype = <span class="hljs-built_in">document</span>.documentElement.getAttribute(<span class="hljs-string">'data-doctype'</span>) == <span class="hljs-string">'true'</span>;
    <span class="hljs-keyword">if</span> (!isDoctype)
        <span class="hljs-keyword">return</span>;
    CustomEvent.observe(<span class="hljs-string">'glide:form_submitted'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        $(<span class="hljs-built_in">document</span>.body).addClassName(<span class="hljs-string">'submitted'</span>);
        setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            CustomEvent.fireTop(<span class="hljs-string">'glide:nav_form_stay'</span>, <span class="hljs-built_in">window</span>);
        }, <span class="hljs-number">750</span>);
    })
    CustomEvent.observe(<span class="hljs-string">'glide:nav_form_stay'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">originWindow</span>) </span>{
        <span class="hljs-keyword">var</span> ga = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">'AJAXFormLoad'</span>);
        ga.addParam(<span class="hljs-string">'sysparm_name'</span>, <span class="hljs-string">'canFormReload'</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.g_form &amp;&amp; g_form.isNewRecord()) {
            ga.addParam(<span class="hljs-string">'sysparm_table'</span>, g_form.getTableName());
            ga.addParam(<span class="hljs-string">'sysparm_sys_id'</span>, g_form.getUniqueValue());
        }
        ga.getXMLAnswer(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">answer</span>) </span>{
            <span class="hljs-keyword">if</span> (answer == <span class="hljs-string">'submitted'</span>) {
                jslog(<span class="hljs-string">"Record already submitted, not re-enabling form controls"</span>);
                <span class="hljs-keyword">return</span>;
            }
            enableFormControls(originWindow);
        })
    });

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enableFormControls</span>(<span class="hljs-params">originWindow</span>) </span>{
        <span class="hljs-keyword">if</span> (originWindow != self)
            <span class="hljs-keyword">return</span>;
        $(<span class="hljs-built_in">document</span>.body).removeClassName(<span class="hljs-string">'submitted'</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.g_form)
            g_form.submitted = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.g_submitted)
            g_submitted = <span class="hljs-literal">false</span>;
    }
});
<span class="hljs-comment">/*! RESOURCE: /scripts/plugins/InPlaceEdit.js */</span>
Plugin.create(<span class="hljs-string">'inPlaceEdit'</span>, {
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem, options</span>) </span>{
        <span class="hljs-keyword">if</span> (elem.retrieve(<span class="hljs-string">'inPlaceEdit'</span>))
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">this</span>.options = <span class="hljs-built_in">Object</span>.extend({
            <span class="hljs-attr">editOnSingleClick</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">turnClickEditingOff</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">onBeforeEdit</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
            <span class="hljs-attr">onAfterEdit</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{},
            <span class="hljs-attr">selectOnStart</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">convertNbspToSpaces</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">titleText</span>: <span class="hljs-literal">null</span>
        }, options || {});
        <span class="hljs-keyword">this</span>.elem = elem;
        <span class="hljs-keyword">this</span>.elem.setAttribute(<span class="hljs-string">'class'</span>, <span class="hljs-string">'content_editable'</span>);
        <span class="hljs-keyword">var</span> mouseEvent;
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.options.turnClickEditingOff) {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.editOnSingleClick)
                mouseEvent = <span class="hljs-string">'click'</span>;
            <span class="hljs-keyword">else</span>
                mouseEvent = <span class="hljs-string">'dblclick'</span>;
            <span class="hljs-keyword">this</span>.elem.observe(mouseEvent, <span class="hljs-keyword">this</span>.beginEdit.bind(<span class="hljs-keyword">this</span>));
        }
        <span class="hljs-keyword">this</span>.elem.onselectstart = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        };
        <span class="hljs-keyword">this</span>.elem.style.MozUserSelect = <span class="hljs-string">'text'</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.titleText)
            <span class="hljs-keyword">this</span>.elem.writeAttribute(<span class="hljs-string">'title'</span>, <span class="hljs-keyword">this</span>.options.titleText);
        <span class="hljs-keyword">this</span>.keyPressHandler = <span class="hljs-keyword">this</span>.keyPress.bind(<span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">this</span>.keyDownHandler = <span class="hljs-keyword">this</span>.keyDown.bind(<span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">this</span>.endEditHandler = <span class="hljs-keyword">this</span>.endEdit.bind(<span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">this</span>.elem.beginEdit = <span class="hljs-keyword">this</span>.beginEdit.bind(<span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">this</span>.elem.store(<span class="hljs-string">'inPlaceEdit'</span>, <span class="hljs-keyword">this</span>);
    },
    <span class="hljs-attr">beginEdit</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
        <span class="hljs-keyword">this</span>.options.onBeforeEdit.call(<span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">this</span>.elem.writeAttribute(<span class="hljs-string">"contentEditable"</span>, <span class="hljs-string">"true"</span>);
        <span class="hljs-keyword">this</span>.elem.addClassName(<span class="hljs-string">"contentEditing"</span>);
        <span class="hljs-keyword">this</span>.elem.observe(<span class="hljs-string">'keypress'</span>, <span class="hljs-keyword">this</span>.keyPressHandler);
        <span class="hljs-keyword">this</span>.elem.observe(<span class="hljs-string">'keydown'</span>, <span class="hljs-keyword">this</span>.keyDownHandler);
        <span class="hljs-keyword">this</span>.elem.observe(<span class="hljs-string">'blur'</span>, <span class="hljs-keyword">this</span>.endEditHandler);
        <span class="hljs-keyword">this</span>.elem.focus();
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.selectOnStart) {
            <span class="hljs-keyword">this</span>.elem.select();
            <span class="hljs-keyword">var</span> range;
            <span class="hljs-keyword">if</span> ((range = <span class="hljs-built_in">document</span>.createRange)) {
                <span class="hljs-keyword">if</span> (range.selectNodeContents) {
                    range.selectNodeContents(<span class="hljs-keyword">this</span>.elem);
                    <span class="hljs-built_in">window</span>.getSelection().addRange(range);
                }
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.body.createTextRange) {
                range = <span class="hljs-built_in">document</span>.body.createTextRange();
                <span class="hljs-keyword">if</span> (range.moveToElementText) {
                    range.moveToElementText(<span class="hljs-keyword">this</span>.elem);
                    range.collapse(<span class="hljs-literal">true</span>);
                    range.select();
                }
            }
        }
        <span class="hljs-keyword">this</span>.oldValue = <span class="hljs-keyword">this</span>.elem.innerHTML;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> event != <span class="hljs-string">'undefined'</span> &amp;&amp; event)
            Event.stop(event);
    },
    <span class="hljs-attr">keyPress</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._submitEdit(event);
    },
    <span class="hljs-attr">keyDown</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._submitEdit(event);
    },
    <span class="hljs-attr">endEdit</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
        <span class="hljs-keyword">this</span>.elem.writeAttribute(<span class="hljs-string">"contentEditable"</span>, <span class="hljs-string">"false"</span>);
        <span class="hljs-keyword">this</span>.elem.removeClassName(<span class="hljs-string">"contentEditing"</span>);
        <span class="hljs-keyword">this</span>.elem.stopObserving(<span class="hljs-string">'keypress'</span>, <span class="hljs-keyword">this</span>.keyPressHandler);
        <span class="hljs-keyword">this</span>.elem.stopObserving(<span class="hljs-string">'blur'</span>, <span class="hljs-keyword">this</span>.endEditHandler);
        <span class="hljs-keyword">var</span> newValue = <span class="hljs-keyword">this</span>.elem.innerHTML.replace(<span class="hljs-regexp">/&lt;br&gt;$/</span>, <span class="hljs-string">''</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.convertNbspToSpaces)
            newValue = newValue.replace(<span class="hljs-regexp">/&amp;nbsp;/g</span>, <span class="hljs-string">' '</span>);
        <span class="hljs-keyword">if</span> (newValue != <span class="hljs-keyword">this</span>.oldValue) {
            newValue = newValue.replace(<span class="hljs-regexp">/^\s+|\s+$/g</span>, <span class="hljs-string">''</span>);
            <span class="hljs-keyword">this</span>.elem.update(newValue);
            <span class="hljs-keyword">this</span>.options.onAfterEdit.call(<span class="hljs-keyword">this</span>, newValue);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    },
    <span class="hljs-attr">_submitEdit</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
        <span class="hljs-keyword">var</span> key = event.which || event.keyCode;
        <span class="hljs-keyword">var</span> e = Event.element(event);
        <span class="hljs-keyword">if</span> (key == Event.KEY_RETURN) {
            e.blur();
            Event.stop(event);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
        <span class="hljs-keyword">if</span> (key == Event.KEY_ESC) {
            <span class="hljs-keyword">this</span>.elem.innerHTML = <span class="hljs-keyword">this</span>.oldValue;
            e.blur();
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/doctype/PersonalizeForm.js */</span>
<span class="hljs-keyword">var</span> PersonalizeForm = Class.create({
    <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">toggleButtonSelector</span>) </span>{
        <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
        <span class="hljs-keyword">this</span>.$toggleButton = $j(toggleButtonSelector);
        <span class="hljs-keyword">this</span>.$toggleButton.hideFix();
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.$toggleButton.length &lt; <span class="hljs-number">1</span>)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">this</span>.isOpen = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">this</span>.isInitialized = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">this</span>.ref = <span class="hljs-keyword">this</span>.$toggleButton.data(<span class="hljs-string">"ref"</span>);
        <span class="hljs-keyword">this</span>.$container = $j(<span class="hljs-keyword">this</span>.$toggleButton.data(<span class="hljs-string">'target'</span>));
        <span class="hljs-keyword">this</span>.$fieldLabelHideButtons = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.$fields = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.$toggleButton.click(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">if</span> (self.isOpen) {
                self.hideSidebar();
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">if</span> (!self.isInitialized) {
                    self.initializeSidebar();
                } <span class="hljs-keyword">else</span>
                    self.showSidebar();
            }
        });
        $j(<span class="hljs-string">'html'</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
            <span class="hljs-keyword">if</span> (self.isOpen &amp;&amp; !self.$toggleButton.is(e.target) &amp;&amp; self.$container.parents(<span class="hljs-string">'.popover'</span>).has($j(e.target)).length == <span class="hljs-number">0</span>) {
                self.hideSidebar();
            }
        });
        $j(<span class="hljs-built_in">document</span>).keyup(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
            <span class="hljs-keyword">if</span> (e.keyCode == <span class="hljs-number">27</span>) {
                <span class="hljs-keyword">if</span> (self.isOpen &amp;&amp; self.$container.parents(<span class="hljs-string">'.popover'</span>).has($j(e.target)).length == <span class="hljs-number">0</span>) {
                    self.hideSidebar();
                }
            }
        });
        $j(<span class="hljs-built_in">window</span>).on(<span class="hljs-string">'resize'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">if</span> (self.isOpen)
                self.hideSidebar();
        });
        <span class="hljs-keyword">this</span>.initializeForm();
    },
    <span class="hljs-attr">initializeForm</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> fields = g_form._getPersonalizeHiddenFields();
        fields.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>) </span>{
            g_form.setDisplay(f, <span class="hljs-literal">false</span>);
        })
    },
    <span class="hljs-attr">initializeSidebar</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
        <span class="hljs-keyword">this</span>.$toggleButton.popover({
            <span class="hljs-attr">html</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">placement</span>: <span class="hljs-string">'bottom'</span>,
            <span class="hljs-attr">trigger</span>: <span class="hljs-string">'manual'</span>,
            <span class="hljs-attr">content</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                self.$container.show();
                <span class="hljs-keyword">return</span> self.$container;
            }
        });
        <span class="hljs-keyword">this</span>.render();
        <span class="hljs-keyword">this</span>.isInitialized = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">this</span>.showSidebar();
    },
    <span class="hljs-attr">hideSidebar</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.$toggleButton.removeClass(<span class="hljs-string">"icon-cog-selected"</span>).addClass(<span class="hljs-string">"icon-cog"</span>);
        <span class="hljs-keyword">this</span>.$toggleButton.popover(<span class="hljs-string">'hide'</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.$fieldLabelHideButtons != <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">this</span>.$fieldLabelHideButtons.hide();
        <span class="hljs-keyword">this</span>.isOpen = <span class="hljs-literal">false</span>;
    },
    <span class="hljs-attr">showSidebar</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.$toggleButton.removeClass(<span class="hljs-string">"icon-cog"</span>).addClass(<span class="hljs-string">"icon-cog-selected"</span>);
        <span class="hljs-keyword">this</span>.$toggleButton.popover(<span class="hljs-string">'show'</span>);
        <span class="hljs-keyword">this</span>.$container.parent().parent().find(<span class="hljs-string">'h3.popover-title'</span>).hide();
        <span class="hljs-keyword">this</span>.setPopoverHeight();
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.$fieldLabelHideButtons != <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">this</span>.$fieldLabelHideButtons.show();
        <span class="hljs-keyword">if</span> (g_form.personalizeHiddenFields.length) {
            $j(<span class="hljs-string">".personalize_form_preference_reset"</span>).show().click(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
                g_form.resetPersonalizeHiddenFields();
                e.preventDefault();
            });
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.$fields != <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">this</span>.$fields.change(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
                <span class="hljs-keyword">var</span> fieldName = $j(<span class="hljs-keyword">this</span>).attr(<span class="hljs-string">'name'</span>);
                <span class="hljs-keyword">var</span> display = $j(<span class="hljs-keyword">this</span>).prop(<span class="hljs-string">'checked'</span>);
                g_form.setUserDisplay(fieldName, display);
                event.preventDefault();
                event.stopPropagation();
            });
        <span class="hljs-keyword">this</span>.isOpen = <span class="hljs-literal">true</span>;
    },
    <span class="hljs-attr">setPopoverHeight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> bootstrapPopoverContentPadding = <span class="hljs-number">28</span>;
        <span class="hljs-keyword">var</span> popoverMaxHeight = <span class="hljs-built_in">window</span>.innerHeight - <span class="hljs-number">120</span>;
        <span class="hljs-keyword">var</span> popoverContentsHeight = <span class="hljs-keyword">this</span>.$container.height();
        <span class="hljs-keyword">var</span> topOffset = <span class="hljs-keyword">this</span>.$container.position().top;
        <span class="hljs-keyword">var</span> popoverOuterHeight = popoverMaxHeight;
        <span class="hljs-keyword">var</span> popoverInnerHeight = (popoverMaxHeight - topOffset) + bootstrapPopoverContentPadding;
        <span class="hljs-keyword">if</span> (popoverContentsHeight + bootstrapPopoverContentPadding &lt;= popoverMaxHeight) {
            popoverOuterHeight = popoverContentsHeight;
            popoverInnerHeight = popoverContentsHeight;
        }
        <span class="hljs-keyword">this</span>.$container.parent(<span class="hljs-string">".popover-content"</span>).height(popoverOuterHeight);
        <span class="hljs-keyword">this</span>.$container.height(popoverInnerHeight);
    },
    <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> formElements = <span class="hljs-keyword">this</span>.getFormElements();
        <span class="hljs-keyword">var</span> container = <span class="hljs-keyword">this</span>.$container.find(<span class="hljs-string">'.personalize_form_fields'</span>);
        <span class="hljs-keyword">var</span> template = <span class="hljs-keyword">new</span> XMLTemplate(<span class="hljs-string">'personalize_item'</span>);
        <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
        formElements.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
            <span class="hljs-keyword">var</span> html = $j(template.evaluate(e));
            <span class="hljs-keyword">var</span> input = html.find(<span class="hljs-string">'input'</span>).prop(<span class="hljs-string">'checked'</span>, e.display);
            <span class="hljs-keyword">if</span> (e.isDisabled)
                input.attr(<span class="hljs-string">"disabled"</span>, <span class="hljs-string">"disabled"</span>);
            <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">var</span> fieldLabelTd = $j(gel(<span class="hljs-string">"label."</span> + self.ref + <span class="hljs-string">"."</span> + e.name));
                fieldLabelTd.css(<span class="hljs-string">"position"</span>, <span class="hljs-string">"relative"</span>);
                <span class="hljs-keyword">var</span> hideButton = $j(<span class="hljs-string">"&lt;a class='icon icon-delete personalize_form_hide_field' href='#'&gt;&lt;/a&gt;"</span>);
                hideButton.attr(<span class="hljs-string">"title"</span>, <span class="hljs-string">"Hide "</span> + e.label);
                hideButton.data(<span class="hljs-string">"input"</span>, input);
                fieldLabelTd.find(<span class="hljs-string">'label'</span>).prepend(hideButton);
                fieldLabelTd.parent().mouseenter(self, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
                    <span class="hljs-keyword">if</span> (event.data.isOpen)
                        $j(self).addClass(<span class="hljs-string">"personalize_hover"</span>);
                }).mouseleave(self, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
                    <span class="hljs-keyword">if</span> (event.data.isOpen)
                        $j(self).removeClass(<span class="hljs-string">"personalize_hover"</span>);
                });
                input.next().mouseenter(fieldLabelTd, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
                    event.data.parent().addClass(<span class="hljs-string">"personalize_hover"</span>);
                }).mouseleave(fieldLabelTd, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
                    event.data.parent().removeClass(<span class="hljs-string">"personalize_hover"</span>);
                });
                <span class="hljs-keyword">if</span> (self.$fieldLabelHideButtons === <span class="hljs-literal">null</span>)
                    self.$fieldLabelHideButtons = hideButton;
                <span class="hljs-keyword">else</span>
                    self.$fieldLabelHideButtons = self.$fieldLabelHideButtons.add(hideButton);
                <span class="hljs-keyword">if</span> (self.$fields === <span class="hljs-literal">null</span>)
                    self.$fields = input;
                <span class="hljs-keyword">else</span>
                    self.$fields = self.$fields.add(input);
            }
            container.append(html);
        });
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.$fieldLabelHideButtons != <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">this</span>.$fieldLabelHideButtons.click(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
                $j(<span class="hljs-keyword">this</span>).data(<span class="hljs-string">"input"</span>).click();
                event.preventDefault();
                event.stopPropagation();
            });
    },
    <span class="hljs-attr">getFormElements</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> fieldNames = g_form.elements.sort(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{
            <span class="hljs-keyword">return</span> a.fieldName &lt;= b.fieldName ? <span class="hljs-number">-1</span> : <span class="hljs-number">1</span>;
        });
        <span class="hljs-keyword">var</span> answer = [];
        fieldNames.each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) </span>{
            <span class="hljs-keyword">if</span> (item.tableName == <span class="hljs-string">"variable"</span>)
                <span class="hljs-keyword">return</span>;
            answer.push({
                <span class="hljs-attr">name</span>: item.fieldName,
                <span class="hljs-attr">label</span>: g_form.getLabelOf(item.fieldName),
                <span class="hljs-attr">display</span>: !g_form.isUserPersonalizedField(item.fieldName),
                <span class="hljs-attr">isDisabled</span>: (g_form.isMandatory(item.fieldName) || g_form.isDisplayNone(item, g_form.getControl(item.fieldName))) &amp;&amp; !g_form.isUserPersonalizedField(item.fieldName)
            })
        });
        <span class="hljs-keyword">return</span> answer;
    },
    <span class="hljs-attr">toString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">'PersonalizeForm'</span>;
    }
});
$j(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">    "use strict"</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> g_form !== <span class="hljs-string">"undefined"</span>)
        <span class="hljs-keyword">new</span> PersonalizeForm(<span class="hljs-string">"#togglePersonalizeForm"</span>);
});;
<span class="hljs-comment">/*! RESOURCE: /scripts/doctype/deferred_related_lists.js */</span>
$j(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$</span>) </span>{
<span class="hljs-meta">    "use strict"</span>;
    <span class="hljs-keyword">var</span> timeout = <span class="hljs-number">50</span>;
    <span class="hljs-keyword">var</span> loadingTimeout = <span class="hljs-number">3000</span>;
    <span class="hljs-keyword">var</span> loadingTimer = <span class="hljs-literal">null</span>;
    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">window</span>.g_form || <span class="hljs-built_in">window</span>.g_related_list_timing != <span class="hljs-string">'deferred'</span>)
            <span class="hljs-keyword">return</span>;
        getRelatedLists();
    }, timeout);
    $(<span class="hljs-string">'.related-list-trigger'</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        $(<span class="hljs-keyword">this</span>).closest(<span class="hljs-string">'.related-list-trigger-container'</span>).hide();
        loadingTimeout = <span class="hljs-number">0</span>;
        getRelatedLists();
    })

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getRelatedLists</span>(<span class="hljs-params"></span>) </span>{
        setupLoadingMessage();
        <span class="hljs-keyword">var</span> deferred_start_time = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
        <span class="hljs-keyword">var</span> listContainer = $(<span class="hljs-string">'#related_lists_wrapper'</span>);
        <span class="hljs-keyword">if</span> (listContainer.length === <span class="hljs-number">0</span>)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">var</span> url = <span class="hljs-keyword">new</span> GlideURL(<span class="hljs-string">'list2_deferred_related_lists.do'</span>);
        url.addParam(<span class="hljs-string">'sysparm_table'</span>, g_form.getTableName());
        url.addParam(<span class="hljs-string">'sysparm_keep_related_lists_open'</span>, <span class="hljs-string">'true'</span>);
        url.addEncodedString(<span class="hljs-string">'sysparm_sys_id='</span> + g_form.getUniqueValue().trim());
        url.addParam(<span class="hljs-string">'sysparm_view'</span>, $(<span class="hljs-string">'#sysparm_view'</span>).val());
        <span class="hljs-keyword">if</span> ($(<span class="hljs-string">'#sysparm_domain'</span>))
            url.addParam(<span class="hljs-string">'sysparm_domain'</span>, $(<span class="hljs-string">'#sysparm_domain'</span>).val());
        <span class="hljs-keyword">if</span> ($(<span class="hljs-string">'#sysparm_domain_scope'</span>))
            url.addParam(<span class="hljs-string">'sysparm_domain_scope'</span>, $(<span class="hljs-string">'#sysparm_domain_scope'</span>).val());
        url.addParam(<span class="hljs-string">'sysparm_stack'</span>, <span class="hljs-string">'no'</span>);
        url.addParam(<span class="hljs-string">'partial_page'</span>, <span class="hljs-string">'related_lists'</span>);
        url.addEncodedString(<span class="hljs-string">'sysparm_embedded='</span> + $(<span class="hljs-string">'#sysparm_embedded'</span>).val());
        <span class="hljs-keyword">var</span> ga = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-literal">null</span>, url.getURL());
        ga.getXML(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) </span>{
            <span class="hljs-keyword">var</span> deferred_responsetime = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
            CustomEvent.fire(<span class="hljs-string">'page_timing'</span>, {
                <span class="hljs-attr">name</span>: <span class="hljs-string">'RLV2'</span>,
                <span class="hljs-attr">child</span>: <span class="hljs-string">'Delay until load'</span>,
                <span class="hljs-attr">ms</span>: (deferred_responsetime - deferred_start_time)
            });
            <span class="hljs-keyword">var</span> html = response.responseText;
            listContainer[<span class="hljs-number">0</span>].innerHTML = html;
            html.evalScripts(<span class="hljs-literal">true</span>);
            CustomEvent.fire(<span class="hljs-string">'partial.page.reload'</span>);
            clearLoadingMessage();
            <span class="hljs-keyword">var</span> lists_loaded_time = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
            <span class="hljs-keyword">var</span> deferred_loadtime = lists_loaded_time - deferred_start_time;
            CustomEvent.fire(<span class="hljs-string">'page_timing'</span>, {
                <span class="hljs-attr">name</span>: <span class="hljs-string">'RLV2'</span>,
                <span class="hljs-attr">child</span>: <span class="hljs-string">'Network time'</span>,
                <span class="hljs-attr">ms</span>: (lists_loaded_time - deferred_responsetime)
            });
        });
    }
    CustomEvent.observe(<span class="hljs-string">'list.loaded'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">table, list</span>) </span>{
        <span class="hljs-keyword">if</span> (!table) {
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">if</span> (!list) {
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">if</span> (list.getReferringURL().indexOf(<span class="hljs-string">'list2_deferred_related_lists.do'</span>) != <span class="hljs-number">-1</span> ||
            list.getReferringURL() == <span class="hljs-string">'undefined'</span>)
            list.setReferringURL(<span class="hljs-built_in">window</span>.location.pathname + <span class="hljs-built_in">window</span>.location.search);
    });

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setupLoadingMessage</span>(<span class="hljs-params"></span>) </span>{
        loadingTimer = setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            $(<span class="hljs-string">'.related-list-loading'</span>).fadeIn();
        }, loadingTimeout)
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearLoadingMessage</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (loadingTimer)
            clearTimeout(loadingTimer);
        $(<span class="hljs-string">'.related-list-loading'</span>).hide();
    }
});
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/GlideNavigation.js */</span>
;
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> GlideNavigation = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{};
    GlideNavigation.prototype = {
        <span class="hljs-attr">open</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">url, target</span>) </span>{
            <span class="hljs-keyword">if</span> (target) {
                <span class="hljs-built_in">window</span>.open(url, target);
                <span class="hljs-keyword">return</span>;
            }
            <span class="hljs-built_in">window</span>.location.href = url;
        },
        <span class="hljs-attr">openList</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">table, query</span>) </span>{
            <span class="hljs-keyword">var</span> url = table + <span class="hljs-string">'_list.do'</span>;
            <span class="hljs-keyword">if</span> (query)
                url += <span class="hljs-string">"?sysparm_query="</span> + <span class="hljs-built_in">encodeURIComponent</span>(query);
            <span class="hljs-keyword">this</span>.open(url);
        },
        <span class="hljs-attr">openRecord</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">table, sys_id</span>) </span>{
            <span class="hljs-keyword">var</span> url = table + <span class="hljs-string">'.do?sys_id='</span> + sys_id;
            <span class="hljs-keyword">this</span>.open(url);
        },
        <span class="hljs-attr">reloadWindow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.location.reload)
                <span class="hljs-built_in">window</span>.location.reload();
        },
        <span class="hljs-attr">refreshNavigator</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            CustomEvent.fireTop(<span class="hljs-string">'navigator.refresh'</span>);
        },
        <span class="hljs-attr">getURL</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>.location.href;
        },
        <span class="hljs-attr">openPopup</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">url, name, features, noStack</span>) </span>{
            <span class="hljs-keyword">if</span> (noStack === <span class="hljs-literal">true</span> &amp;&amp; url.indexOf(<span class="hljs-string">"sysparm_nameofstack"</span>) == <span class="hljs-number">-1</span>)
                url += <span class="hljs-string">"&amp;sysparm_stack=no"</span>;
            <span class="hljs-keyword">var</span> win = <span class="hljs-built_in">window</span>.open(url, name, features, <span class="hljs-literal">false</span>);
            <span class="hljs-keyword">return</span> win;
        },
        <span class="hljs-attr">setPermalink</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">title, relativePath</span>) </span>{
            CustomEvent.fireTop(<span class="hljs-string">'magellanNavigator.permalink.set'</span>, {
                <span class="hljs-attr">title</span>: title,
                <span class="hljs-attr">relativePath</span>: relativePath
            });
        },
        <span class="hljs-attr">addUserHistoryEntry</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">title, relativePath, description, isTable</span>) </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> description == <span class="hljs-string">"undefined"</span>)
                description = <span class="hljs-string">""</span>;
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> isTable == <span class="hljs-string">"undefined"</span>)
                isTable = <span class="hljs-literal">false</span>;
            CustomEvent.fireTop(<span class="hljs-string">'magellanNavigator.sendHistoryEvent'</span>, {
                <span class="hljs-attr">title</span>: title,
                <span class="hljs-attr">url</span>: relativePath,
                <span class="hljs-attr">description</span>: description,
                <span class="hljs-attr">isTable</span>: isTable
            });
        }
    };
    <span class="hljs-built_in">window</span>.g_navigation = <span class="hljs-keyword">new</span> GlideNavigation();
})();;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/GlideAPI1.js */</span>
<span class="hljs-built_in">window</span>.g_api = <span class="hljs-number">1</span>;;
<span class="hljs-comment">/*! RESOURCE: /scripts/ac.js */</span>
<span class="hljs-keyword">var</span> g_isInternetExplorer = isMSIE;
<span class="hljs-keyword">var</span> KEY_RETURN = <span class="hljs-number">3</span>;
<span class="hljs-keyword">var</span> KEY_BACKSPACE = <span class="hljs-number">8</span>;
<span class="hljs-keyword">var</span> KEY_TAB = <span class="hljs-number">9</span>;
<span class="hljs-keyword">var</span> KEY_ENTER = <span class="hljs-number">13</span>;
<span class="hljs-keyword">var</span> KEY_PAGEUP = <span class="hljs-number">33</span>;
<span class="hljs-keyword">var</span> KEY_PAGEDOWN = <span class="hljs-number">34</span>;
<span class="hljs-keyword">var</span> KEY_END = <span class="hljs-number">35</span>;
<span class="hljs-keyword">var</span> KEY_HOME = <span class="hljs-number">36</span>;
<span class="hljs-keyword">var</span> KEY_ARROWLEFT = <span class="hljs-number">37</span>;
<span class="hljs-keyword">var</span> KEY_ARROWUP = <span class="hljs-number">38</span>;
<span class="hljs-keyword">var</span> KEY_ARROWRIGHT = <span class="hljs-number">39</span>;
<span class="hljs-keyword">var</span> KEY_ARROWDOWN = <span class="hljs-number">40</span>;
<span class="hljs-keyword">var</span> KEY_INSERT = <span class="hljs-number">45</span>;
<span class="hljs-keyword">var</span> KEY_DELETE = <span class="hljs-number">46</span>;
<span class="hljs-keyword">var</span> NO_INVISIBLE = <span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> itemHeight = <span class="hljs-number">16</span>;
<span class="hljs-keyword">var</span> ctimeVal = {};
<span class="hljs-keyword">var</span> TAG_DIV = <span class="hljs-string">"div"</span>;
<span class="hljs-keyword">var</span> TAG_SPAN = <span class="hljs-string">"span"</span>;
<span class="hljs-keyword">var</span> ONE_TO_MANY = <span class="hljs-string">"OTM"</span>;
<span class="hljs-keyword">var</span> g_ac_objects = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">acKeyDown</span>(<span class="hljs-params">evt, elementName, type, dependent</span>) </span>{
    <span class="hljs-keyword">var</span> typedChar = getKeyCode(evt);
    <span class="hljs-keyword">if</span> (typedChar == KEY_ARROWDOWN || typedChar == KEY_ARROWUP)
        fieldChange(evt, elementName, type, dependent);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">acKeyUp</span>(<span class="hljs-params">evt, elementName, type, dependent</span>) </span>{
    <span class="hljs-keyword">var</span> typedChar = getKeyCode(evt);
    <span class="hljs-keyword">if</span> (typedChar != KEY_ARROWDOWN &amp;&amp; typedChar != KEY_ARROWUP)
        fieldChange(evt, elementName, type, dependent);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fieldChange</span>(<span class="hljs-params">event, elementName, type, dependent</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.readyState &amp;&amp; <span class="hljs-built_in">document</span>.readyState != <span class="hljs-string">"complete"</span>) {
        jslog(<span class="hljs-string">"fieldChange delayed due to document not being ready"</span>);
        <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">var</span> table = elementName.split(<span class="hljs-string">'.'</span>)[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">var</span> additional = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">if</span> (dependent != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">var</span> dparts = dependent.split(<span class="hljs-string">","</span>);
        <span class="hljs-keyword">var</span> el = <span class="hljs-built_in">document</span>.getElementsByName(table + <span class="hljs-string">"."</span> + dparts[<span class="hljs-number">0</span>])[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">if</span> (el != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">var</span> selectValue = <span class="hljs-string">""</span>;
            <span class="hljs-keyword">if</span> (el.tagName == <span class="hljs-string">"INPUT"</span>) {
                <span class="hljs-keyword">var</span> selectValue = el.value;
            } <span class="hljs-keyword">else</span> {
                selectValue = el.options[el.selectedIndex].value;
            }
            additional = <span class="hljs-string">"sysparm_value="</span> + selectValue;
        }
    }
    fieldProcess(event, elementName, type, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">null</span>, additional);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fieldProcess</span>(<span class="hljs-params">evt, elementName, type, noMax, useInvisible, uFieldName, additional, refField</span>) </span>{
    <span class="hljs-keyword">var</span> typedChar = getKeyCode(evt);
    <span class="hljs-keyword">if</span> (ctimeVal[elementName] &gt; <span class="hljs-number">0</span> &amp;&amp; typedChar != <span class="hljs-number">0</span>)
        clearTimeout(ctimeVal[elementName]);
    <span class="hljs-keyword">var</span> displayField;
    <span class="hljs-keyword">var</span> invisibleField;
    <span class="hljs-keyword">if</span> (type == <span class="hljs-string">"Reference"</span>) {
        displayField = gel(<span class="hljs-string">"sys_display."</span> + elementName);
        <span class="hljs-keyword">if</span> (useInvisible)
            invisibleField = gel(elementName);
    } <span class="hljs-keyword">else</span> {
        displayField = gel(elementName);
        <span class="hljs-keyword">if</span> (useInvisible)
            invisibleField = gel(<span class="hljs-string">"sys_display."</span> + elementName);
    }
    <span class="hljs-keyword">var</span> updateField;
    <span class="hljs-keyword">if</span> (uFieldName != <span class="hljs-literal">null</span>)
        updateField = gel(uFieldName);
    <span class="hljs-keyword">var</span> ac = displayField.ac;
    <span class="hljs-keyword">if</span> (ac == <span class="hljs-literal">null</span>) {
        ac = getAC(displayField.name);
        <span class="hljs-keyword">if</span> (ac == <span class="hljs-literal">null</span>) {
            ac = newAC(displayField, invisibleField, updateField, elementName, type);
            <span class="hljs-keyword">if</span> (ac.isOTM())
                ac.refField = refField;
        }
    }
    <span class="hljs-keyword">if</span> (typedChar != KEY_TAB) {
        ac.fieldChanged = <span class="hljs-literal">true</span>;
        ac.matched = <span class="hljs-literal">false</span>;
        ac.ignoreAJAX = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">if</span> (ac.type == <span class="hljs-string">'Reference'</span>)
            ac.dirty = <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">var</span> waitTime = <span class="hljs-number">50</span>;
    <span class="hljs-keyword">if</span> (typedChar == KEY_ARROWDOWN || typedChar == KEY_ARROWUP || typedChar == NO_INVISIBLE)
        waitTime = <span class="hljs-number">0</span>;
    ctimeVal[elementName] = setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        fieldProcessNow(typedChar, elementName, type, noMax, useInvisible, uFieldName, additional, refField);
    }, g_acWaitTime || waitTime);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initAutoCompleteField</span>(<span class="hljs-params">ac</span>) </span>{
    <span class="hljs-keyword">if</span> (ac.getUpdateField())
        <span class="hljs-keyword">return</span>;
    Event.observe(ac.getField(), <span class="hljs-string">'blur'</span>, fieldBlurred.bind(ac.getField()), <span class="hljs-literal">false</span>);
    setDropDownSizes();
    setStyle(ac.getMenu(), <span class="hljs-string">"dropDownTableStyle"</span>);
    <span class="hljs-built_in">window</span>.onresize = setDropDownSizes;
    setSavedText(ac, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>((ac.getInvisibleField() ? ac.getInvisibleField().value : <span class="hljs-literal">null</span>), ac.getField().value));
    <span class="hljs-keyword">var</span> request = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
    request.responseXML = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
    request.responseXML.ac = ac;
    storeResults(ac, <span class="hljs-string">""</span>, request);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setDropDownSizes</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; g_ac_objects.length; i++) {
        <span class="hljs-keyword">var</span> ac = g_ac_objects[i];
        <span class="hljs-keyword">if</span> (!ac)
            <span class="hljs-keyword">continue</span>;
        setDropDownSize(ac);
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setDropDownSize</span>(<span class="hljs-params">ac</span>) </span>{
    <span class="hljs-keyword">var</span> field = ac.getField();
    <span class="hljs-keyword">var</span> mLeft = grabOffsetLeft(field) + <span class="hljs-string">"px"</span>;
    <span class="hljs-keyword">var</span> mTop = grabOffsetTop(field) + (field.offsetHeight - <span class="hljs-number">1</span>) + <span class="hljs-string">"px"</span>;
    <span class="hljs-keyword">var</span> mWidth = estimateWidth(ac) + <span class="hljs-string">"px"</span>;
    <span class="hljs-keyword">var</span> menu = ac.getMenu();
    <span class="hljs-keyword">if</span> (menu.offsetWidth &gt; <span class="hljs-built_in">parseInt</span>(mWidth))
        mWidth = menu.offsetWidth + <span class="hljs-string">"px"</span>;
    acSetTopLeftWidth(menu.style, mTop, mLeft, mWidth);
    <span class="hljs-keyword">var</span> iframe = ac.getIFrame();
    <span class="hljs-keyword">if</span> (iframe)
        acSetTopLeftWidth(iframe.style, mTop, mLeft, mWidth);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">acSetTopLeftWidth</span>(<span class="hljs-params">style, top, left, width</span>) </span>{
    style.left = left;
    style.top = top;
    style.width = width;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">estimateWidth</span>(<span class="hljs-params">ac</span>) </span>{
    <span class="hljs-keyword">var</span> field = ac.getField();
    <span class="hljs-keyword">if</span> (g_isInternetExplorer)
        <span class="hljs-keyword">return</span> field.offsetWidth - (ac.menuBorderSize * <span class="hljs-number">2</span>);
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">return</span> field.offsetWidth;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fieldBlurred</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> theField = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">var</span> ac = theField.ac;
    ac.ignoreAJAX = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">var</span> cc = ac.getField().value;
    <span class="hljs-keyword">if</span> (cc.indexOf(<span class="hljs-string">"javascript:"</span>) != <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">if</span> (ac.type == <span class="hljs-string">'Reference'</span> &amp;&amp; ac.matched == <span class="hljs-literal">false</span> &amp;&amp; ac.fieldChanged == <span class="hljs-literal">true</span>) {
            setReferenceField(ac, cc);
        }
    }
    ac.matched = <span class="hljs-literal">false</span>;
    ac.fieldChanged = <span class="hljs-literal">false</span>;
    ac.previousTextValue = <span class="hljs-string">''</span>;
    checkForDirty(ac);
    ac.hideDropDown();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setReferenceField</span>(<span class="hljs-params">ac, cc</span>) </span>{
    <span class="hljs-keyword">var</span> encodedText = encodeText(cc);
    <span class="hljs-keyword">var</span> url = <span class="hljs-string">"xmlhttp.do?sysparm_processor="</span> + ac.type +
        <span class="hljs-string">"&amp;sysparm_name="</span> + ac.elementName +
        <span class="hljs-string">"&amp;sysparm_exact_match=yes"</span> +
        <span class="hljs-string">"&amp;sysparm_chars="</span> + encodedText +
        <span class="hljs-string">"&amp;sysparm_type="</span> + ac.type;
    <span class="hljs-keyword">var</span> response = serverRequestWait(url);
    <span class="hljs-keyword">var</span> items = response.responseXML.getElementsByTagName(<span class="hljs-string">"item"</span>);
    <span class="hljs-keyword">if</span> (items.length == <span class="hljs-number">1</span>) {
        <span class="hljs-keyword">var</span> item = items[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">var</span> name = trim(item.getAttribute(<span class="hljs-string">"name"</span>));
        <span class="hljs-keyword">var</span> label = trim(item.getAttribute(<span class="hljs-string">"label"</span>));
        ac.getField().value = label;
        ac.getInvisibleField().value = name;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">var</span> e = ac.getField();
        <span class="hljs-keyword">var</span> f = e.filter;
        <span class="hljs-keyword">if</span> (!f || f == <span class="hljs-string">''</span>) {
            ac.getInvisibleField().value = <span class="hljs-string">"x"</span>;
            ac.getField().value = <span class="hljs-string">""</span>;
            ac.getInvisibleField().value = <span class="hljs-string">""</span>;
        }
    }
    fieldSet(ac);
    refFlipImage(ac.getField(), ac.elementName);
    ac.dirty = <span class="hljs-literal">true</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stripNewlines</span>(<span class="hljs-params">data</span>) </span>{
    <span class="hljs-keyword">var</span> retData = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">var</span> Ib = <span class="hljs-string">"\n\r"</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c = <span class="hljs-number">0</span>; c &lt; data.length; c++) {
        <span class="hljs-keyword">if</span> (Ib.indexOf(data.charAt(c)) == <span class="hljs-number">-1</span>)
            retData += data.charAt(c);
        <span class="hljs-keyword">else</span>
            retData += <span class="hljs-string">" "</span>;
    }
    <span class="hljs-keyword">return</span> retData;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">grabMenuInfo</span>(<span class="hljs-params">j</span>) </span>{
    <span class="hljs-keyword">var</span> spanTag = j.getElementsByTagName(TAG_SPAN);
    <span class="hljs-keyword">var</span> spanInfo = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
    <span class="hljs-keyword">if</span> (!spanTag)
        <span class="hljs-keyword">return</span> spanInfo;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; spanTag.length; i++) {
        <span class="hljs-keyword">var</span> e = spanTag[i];
        <span class="hljs-keyword">if</span> (e.className != <span class="hljs-string">"selected_item"</span>)
            <span class="hljs-keyword">continue</span>;
        <span class="hljs-keyword">var</span> spanData = e.innerHTML;
        <span class="hljs-keyword">if</span> (spanData != <span class="hljs-string">"&amp;nbsp;"</span>) {
            spanInfo = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(e.gname, stripNewlines(e.glabel));
        }
        <span class="hljs-keyword">break</span>;
    }
    <span class="hljs-keyword">return</span> spanInfo;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">storeResults</span>(<span class="hljs-params">ac, searchString, req</span>) </span>{
    ac.resultsStorage[searchString] = req;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">retrieveStorage</span>(<span class="hljs-params">ac, textStr</span>) </span>{
    <span class="hljs-keyword">return</span> ac.resultsStorage[textStr];
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">storeZeroString</span>(<span class="hljs-params">ac, searchString, req</span>) </span>{
    ac.emptyResults[searchString] = req;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findRelatedZeroString</span>(<span class="hljs-params">ac, searchString</span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> str <span class="hljs-keyword">in</span> ac.emptyResults) {
        <span class="hljs-keyword">if</span> (searchString.substring(<span class="hljs-number">0</span>, str.length) == str) {
            <span class="hljs-keyword">return</span> ac.emptyResults[str];
        }
    }
}
<span class="hljs-keyword">var</span> handleClickedDropDown = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    setAllText(<span class="hljs-keyword">this</span>.ac, grabMenuInfo(<span class="hljs-keyword">this</span>));
    <span class="hljs-keyword">this</span>.ac.dirty = <span class="hljs-literal">false</span>;
}
<span class="hljs-keyword">var</span> handleMouseOverDropDown = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    setStyle(<span class="hljs-keyword">this</span>, <span class="hljs-string">"selectedItemStyle"</span>);
}
<span class="hljs-keyword">var</span> handleMouseOutDropDown = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    setStyle(<span class="hljs-keyword">this</span>, <span class="hljs-string">"nonSelectedItemStyle"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dropDownHilight</span>(<span class="hljs-params">ac, direction</span>) </span>{
    setTextField(ac, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>((ac.getInvisibleField() ? ac.savedInvisibleTextValue : <span class="hljs-literal">null</span>), ac.savedTextValue));
    ac.matched = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (!ac.currentMenuItems || ac.currentMenuCount &lt;= <span class="hljs-number">0</span>)
        <span class="hljs-keyword">return</span>;
    ac.showDropDown();
    <span class="hljs-keyword">var</span> toSelect = ac.selectedItemNum + direction;
    <span class="hljs-keyword">if</span> (toSelect &gt;= ac.currentMenuCount)
        toSelect = ac.currentMenuCount - <span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span> (ac.selectedItemNum != <span class="hljs-number">-1</span> &amp;&amp; toSelect != ac.selectedItemNum) {
        setStyle(ac.selectedItemObj, <span class="hljs-string">"nonSelectedItemStyle"</span>);
        ac.selectedItemNum = <span class="hljs-number">-1</span>;
    }
    <span class="hljs-keyword">if</span> (toSelect &lt; <span class="hljs-number">0</span>) {
        ac.selectedItemNum = <span class="hljs-number">-1</span>;
        ac.getField().focus();
        <span class="hljs-keyword">return</span>;
    }
    ac.selectItem(toSelect);
    setStyle(ac.selectedItemObj, <span class="hljs-string">"selectedItemStyle"</span>);
    setTextField(ac, grabMenuInfo(ac.selectedItemObj));
    ac.dirty = <span class="hljs-literal">true</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setPreviousText</span>(<span class="hljs-params">ac, textArray</span>) </span>{
    <span class="hljs-keyword">if</span> (textArray[<span class="hljs-number">1</span>] != <span class="hljs-literal">null</span>)
        ac.previousTextValue = textArray[<span class="hljs-number">1</span>];
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setSavedText</span>(<span class="hljs-params">ac, textArray</span>) </span>{
    ac.setSavedText(textArray);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setTextValue</span>(<span class="hljs-params">ac, textArray</span>) </span>{
    ac.textValue = textArray[<span class="hljs-number">1</span>].replace(<span class="hljs-regexp">/\r\n/g</span>, <span class="hljs-string">"\n"</span>);
    <span class="hljs-keyword">if</span> (textArray[<span class="hljs-number">0</span>] != <span class="hljs-literal">null</span> &amp;&amp; ac.getInvisibleField()) {
        ac.invisibleTextValue = textArray[<span class="hljs-number">0</span>];
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setTextField</span>(<span class="hljs-params">ac, textArray</span>) </span>{
    <span class="hljs-keyword">var</span> f;
    <span class="hljs-keyword">if</span> (textArray[<span class="hljs-number">0</span>] != <span class="hljs-literal">null</span> &amp;&amp; ac.getInvisibleField()) {
        f = ac.getInvisibleField();
        f.value = textArray[<span class="hljs-number">0</span>];
    }
    f = ac.getField();
    f.value = textArray[<span class="hljs-number">1</span>];
    fireOnFormat(ac);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setAllText</span>(<span class="hljs-params">ac, textArray</span>) </span>{
    setSavedText(ac, textArray);
    setTextValue(ac, textArray);
    setTextField(ac, textArray);
    setPreviousText(ac, textArray);
    fieldSet(ac);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fieldSet</span>(<span class="hljs-params">ac</span>) </span>{
    ac.dirty = <span class="hljs-literal">false</span>;
    ac.matched = <span class="hljs-literal">true</span>;
    updateRelated(ac);
    fireChange(ac);
    fireOnFormat(ac);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fireChange</span>(<span class="hljs-params">ac</span>) </span>{
    callOnChange(ac.getInvisibleField());
    callOnChange(ac.getField());
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">callOnChange</span>(<span class="hljs-params">f</span>) </span>{
    <span class="hljs-keyword">if</span> (!f)
        <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (f[<span class="hljs-string">"onchange"</span>])
        f.onchange();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fireOnFormat</span>(<span class="hljs-params">ac</span>) </span>{
    <span class="hljs-keyword">var</span> f = ac.getField();
    <span class="hljs-keyword">if</span> (f.getAttribute(<span class="hljs-string">"onformat"</span>))
        <span class="hljs-built_in">eval</span>(f.getAttribute(<span class="hljs-string">"onformat"</span>));
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateRelated</span>(<span class="hljs-params">ac</span>) </span>{
    <span class="hljs-keyword">var</span> elementName = ac.elementName;
    <span class="hljs-keyword">var</span> elementValue = ac.invisibleTextValue;
    <span class="hljs-keyword">if</span> (elementValue != <span class="hljs-string">''</span>)
        updateRelatedGivenNameAndValue(elementName, elementValue);
    <span class="hljs-keyword">if</span> (ac[<span class="hljs-string">"fCall"</span>]) {
        <span class="hljs-keyword">var</span> onset = ac[<span class="hljs-string">"fCall"</span>];
        <span class="hljs-built_in">eval</span>(onset);
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearRelated</span>(<span class="hljs-params">ac</span>) </span>{
    <span class="hljs-keyword">var</span> elementName = ac.elementName;
    <span class="hljs-keyword">var</span> nodes = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'input'</span>);
    <span class="hljs-keyword">var</span> sName = elementName + <span class="hljs-string">"."</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; nodes.length; i++) {
        <span class="hljs-keyword">var</span> current = nodes[i];
        <span class="hljs-keyword">var</span> id = current.id;
        <span class="hljs-keyword">var</span> index = id.indexOf(sName);
        <span class="hljs-keyword">if</span> (index == <span class="hljs-number">-1</span>)
            <span class="hljs-keyword">continue</span>;
        index = id.lastIndexOf(<span class="hljs-string">"."</span>);
        <span class="hljs-keyword">var</span> fName = id.substring(index + <span class="hljs-number">1</span>, id.length);
        <span class="hljs-keyword">var</span> select = gel(elementName + <span class="hljs-string">"."</span> + fName);
        <span class="hljs-keyword">if</span> (select != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">var</span> x = select.tagName;
            <span class="hljs-keyword">if</span> (x == <span class="hljs-string">'select'</span> || x == <span class="hljs-string">'SELECT'</span>) {
                <span class="hljs-keyword">var</span> selindex = select.selectedIndex;
                <span class="hljs-keyword">if</span> (selindex != <span class="hljs-number">-1</span>) {
                    <span class="hljs-keyword">var</span> option = select.options[selindex];
                    option.selected = <span class="hljs-literal">false</span>;
                }
                <span class="hljs-keyword">var</span> options = select.options;
                <span class="hljs-keyword">for</span> (oi = <span class="hljs-number">0</span>; oi &lt; options.length; oi++) {
                    <span class="hljs-keyword">var</span> option = options[oi];
                    <span class="hljs-keyword">var</span> optval = option.value;
                    <span class="hljs-keyword">if</span> (optval == <span class="hljs-string">''</span>) {
                        option.selected = <span class="hljs-literal">true</span>;
                        <span class="hljs-keyword">break</span>;
                    }
                }
            }
        }
        current.value = <span class="hljs-string">''</span>;
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setStyle</span>(<span class="hljs-params">child, styleName</span>) </span>{
    child.className = styleName;
    <span class="hljs-keyword">var</span> style = child.style;
    <span class="hljs-keyword">var</span> ac = child.ac;
    <span class="hljs-keyword">if</span> (styleName == <span class="hljs-string">"dropDownTableStyle"</span>) {
        style.fontSize = <span class="hljs-string">"13px"</span>;
        style.fontFamily = <span class="hljs-string">"arial,sans-serif"</span>;
        style.wordWrap = <span class="hljs-string">"break-word"</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (styleName == <span class="hljs-string">"nonSelectedItemStyle"</span>) {
        ac.setNonSelectedStyle(child);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (styleName == <span class="hljs-string">"selectedItemStyle"</span>) {
        ac.setSelectedStyle(child);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (styleName == <span class="hljs-string">"dropDownRowStyle"</span>) {
        style.display = <span class="hljs-string">"block"</span>;
        style.paddingLeft = <span class="hljs-number">3</span>;
        style.paddingRight = <span class="hljs-number">3</span>;
        style.height = itemHeight + <span class="hljs-string">"px"</span>;
        style.overflow = <span class="hljs-string">"hidden"</span>;
        style.whiteSpace = <span class="hljs-string">"nowrap"</span>;
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createDropDown</span>(<span class="hljs-params">ac, foundStrings</span>) </span>{
    ac.clearDropDown();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c = <span class="hljs-number">0</span>; c &lt; foundStrings.length; c++) {
        <span class="hljs-keyword">var</span> child = createChild(ac, foundStrings[c]);
        ac.appendItem(child);
    }
    setSavedText(ac, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>((ac.getInvisibleField() ? ac.invisibleTextValue : <span class="hljs-literal">null</span>), ac.textValue));
    <span class="hljs-keyword">if</span> (ac.currentMenuCount != <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">var</span> height = (itemHeight * ac.currentMenuCount) + <span class="hljs-number">4</span>;
        ac.setHeight(height);
    }
    ac.selectedItemObj = <span class="hljs-literal">null</span>;
    ac.selectedItemNum = <span class="hljs-number">-1</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createChild</span>(<span class="hljs-params">ac, sa</span>) </span>{
    <span class="hljs-keyword">var</span> theDiv = cel(TAG_DIV);
    theDiv.ac = ac;
    setStyle(theDiv, <span class="hljs-string">"nonSelectedItemStyle"</span>);
    theDiv.onmousedown = handleClickedDropDown;
    theDiv.onmouseover = handleMouseOverDropDown;
    theDiv.onmouseout = handleMouseOutDropDown;
    <span class="hljs-keyword">var</span> menuRow = cel(TAG_SPAN);
    setStyle(menuRow, <span class="hljs-string">"dropDownRowStyle"</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-literal">false</span> &amp;&amp; sa.length == <span class="hljs-number">4</span>) {
        <span class="hljs-keyword">var</span> r = cel(TAG_SPAN);
        r.innerHTML = sa[<span class="hljs-number">3</span>];
        menuRow.appendChild(r);
        r = cel(TAG_SPAN);
        r.innerHTML = <span class="hljs-string">"&amp;nbsp;"</span>;
        menuRow.appendChild(r);
    }
    <span class="hljs-keyword">var</span> itemInRow = cel(TAG_SPAN);
    itemInRow.innerHTML = sa[<span class="hljs-number">1</span>].escapeHTML();
    itemInRow.gname = sa[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">if</span> (ac.type == <span class="hljs-string">"PickList"</span>)
        itemInRow.glabel = sa[<span class="hljs-number">2</span>];
    <span class="hljs-keyword">else</span>
        itemInRow.glabel = sa[<span class="hljs-number">1</span>];
    itemInRow.className = <span class="hljs-string">"selected_item"</span>;
    menuRow.appendChild(itemInRow);
    theDiv.appendChild(menuRow);
    <span class="hljs-keyword">return</span> theDiv;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encodeText</span>(<span class="hljs-params">txt</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">encodeURIComponent</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">encodeURIComponent</span>(txt);
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">escape</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">escape</span>(txt);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">newAC</span>(<span class="hljs-params">fld, invfld, ufld, elementName, type</span>) </span>{
    <span class="hljs-keyword">var</span> name = fld.name + <span class="hljs-string">"_form"</span>;
    <span class="hljs-keyword">var</span> ac = <span class="hljs-keyword">new</span> AJAXOtherCompleter(name, elementName);
    ac.setType(type);
    ac.setField(fld);
    ac.setInvisibleField(invfld);
    ac.setUpdateField(ufld);
    <span class="hljs-keyword">var</span> oCount = g_ac_objects.length;
    g_ac_objects[oCount] = ac;
    initAutoCompleteField(ac);
    ac.firstUse = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> ac;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeAC</span>(<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; g_ac_objects.length; i++) {
        <span class="hljs-keyword">if</span> (g_ac_objects[i] == <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">continue</span>;
        <span class="hljs-keyword">if</span> (g_ac_objects[i].elementName == name)
            g_ac_objects[i] = <span class="hljs-literal">null</span>;
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getAC</span>(<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; g_ac_objects.length; i++) {
        <span class="hljs-keyword">if</span> (g_ac_objects[i] == <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">continue</span>;
        <span class="hljs-keyword">if</span> (g_ac_objects[i].name == name)
            <span class="hljs-keyword">return</span> g_ac_objects[i];
    }
    <span class="hljs-keyword">return</span> getacPerInput(name);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getacPerInput</span>(<span class="hljs-params">elementName</span>) </span>{
    <span class="hljs-keyword">var</span> f = gel(<span class="hljs-string">"sys_display."</span> + elementName);
    <span class="hljs-keyword">if</span> (f != <span class="hljs-literal">null</span> &amp;&amp; f.ac != <span class="hljs-literal">null</span>)
        <span class="hljs-keyword">return</span> f.ac;
    f = gel(elementName);
    <span class="hljs-keyword">if</span> (f != <span class="hljs-literal">null</span> &amp;&amp; f.ac != <span class="hljs-literal">null</span>)
        <span class="hljs-keyword">return</span> f.ac;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkEnter</span>(<span class="hljs-params">e, elementName</span>) </span>{
    <span class="hljs-keyword">var</span> ac = getAC(elementName);
    <span class="hljs-keyword">if</span> (ac == <span class="hljs-literal">null</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">var</span> keyCode = getKeyCode(e);
    <span class="hljs-keyword">if</span> (keyCode == KEY_ENTER) {
        <span class="hljs-keyword">if</span> (ac.type != <span class="hljs-string">'PickList'</span>) {
            Event.stop(e);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkForDirty</span>(<span class="hljs-params">ac</span>) </span>{
    <span class="hljs-keyword">if</span> (!ac.dirty)
        <span class="hljs-keyword">return</span>;
    setTextValue(ac, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>((ac.getInvisibleField() ? ac.getInvisibleField().value : <span class="hljs-literal">null</span>), ac.getField().value));
    fieldSet(ac);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fieldChangeSlush</span>(<span class="hljs-params">event, elementName, type, noMax, uFieldName, additional</span>) </span>{
    fieldProcess(event, elementName, type, noMax, <span class="hljs-literal">false</span>, uFieldName, additional);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fieldChangeSlush1</span>(<span class="hljs-params">event, elementName, fieldName, type, noMax, uFieldName</span>) </span>{
    <span class="hljs-keyword">var</span> filter = getFilter();
    displayField = <span class="hljs-built_in">document</span>.getElementsByName(elementName)[<span class="hljs-number">0</span>];
    displayField.value = filter;
    fieldProcess(event, elementName, ONE_TO_MANY, noMax, <span class="hljs-literal">false</span>, uFieldName, <span class="hljs-number">1</span>, fieldName);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fieldChangeSlush2</span>(<span class="hljs-params">event, elementName, fieldName, type, noMax, uFieldName, queryAddOn, additional, fDiv</span>) </span>{
    <span class="hljs-keyword">var</span> filter = getFilter(elementName, <span class="hljs-string">''</span>, fDiv);
    filter += <span class="hljs-string">"^"</span> + queryAddOn;
    displayField = gel(elementName);
    displayField.value = filter;
    fieldProcess(event, elementName, ONE_TO_MANY, noMax, <span class="hljs-literal">false</span>, uFieldName, additional, fieldName);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateSlushField</span>(<span class="hljs-params">ac, values</span>) </span>{
    <span class="hljs-keyword">var</span> updateField = ac.getUpdateField();
    destroyUpdateField(ac);
    <span class="hljs-keyword">if</span> (values != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> zi = <span class="hljs-number">0</span>; zi &lt; values.length; zi++) {
            updateField.options[zi] = <span class="hljs-keyword">new</span> Option(values[zi][<span class="hljs-number">1</span>], values[zi][<span class="hljs-number">0</span>]);
        }
    }
    <span class="hljs-keyword">if</span> (updateField[<span class="hljs-string">"onchange"</span>])
        updateField.onchange();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">destroyUpdateField</span>(<span class="hljs-params">ac</span>) </span>{
    ac.getUpdateField().options.length = <span class="hljs-number">0</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getKeyCode</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">if</span> (e == <span class="hljs-literal">null</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">return</span> g_isInternetExplorer &amp;&amp; <span class="hljs-built_in">window</span>.event ? event.keyCode : e.keyCode;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fieldProcessNow</span>(<span class="hljs-params">typedChar, elementName, type, noMax, useInvisible, uFieldName, additional, refField</span>) </span>{
    <span class="hljs-keyword">var</span> displayField;
    <span class="hljs-keyword">var</span> invisibleField;
    <span class="hljs-keyword">var</span> updateField;
    <span class="hljs-keyword">if</span> (type == <span class="hljs-string">"Reference"</span>) {
        displayField = gel(<span class="hljs-string">"sys_display."</span> + elementName);
        <span class="hljs-keyword">if</span> (useInvisible)
            invisibleField = gel(elementName);
    } <span class="hljs-keyword">else</span> {
        displayField = gel(elementName);
        <span class="hljs-keyword">if</span> (useInvisible)
            invisibleField = gel(<span class="hljs-string">"sys_display."</span> + elementName);
    }
    <span class="hljs-keyword">if</span> (uFieldName != <span class="hljs-literal">null</span>)
        updateField = gel(uFieldName);
    <span class="hljs-keyword">var</span> ac = displayField.ac;
    <span class="hljs-keyword">if</span> (ac == <span class="hljs-literal">null</span>) {
        ac = getAC(displayField.name);
        <span class="hljs-keyword">if</span> (ac == <span class="hljs-literal">null</span>) {
            ac = newAC(displayField, invisibleField, updateField, elementName, type);
            <span class="hljs-keyword">if</span> (ac.isOTM())
                ac.refField = refField;
        }
    }
    <span class="hljs-keyword">var</span> eDep = displayField;
    <span class="hljs-keyword">var</span> itemName = eDep.getAttribute(<span class="hljs-string">"function"</span>);
    <span class="hljs-keyword">if</span> (itemName != <span class="hljs-literal">null</span>)
        ac.fCall = itemName;
    setTextValue(ac, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>((invisibleField ? invisibleField.value : <span class="hljs-literal">null</span>), displayField.value));
    <span class="hljs-keyword">if</span> (typedChar == KEY_TAB)
        <span class="hljs-keyword">return</span>;
    ac.fieldChanged = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (typedChar != <span class="hljs-number">0</span> || updateField || ac.isOTM()) {
        <span class="hljs-keyword">if</span> (ac.isOTM() || ((typedChar == KEY_ARROWDOWN || typedChar == KEY_ARROWUP) &amp;&amp; !updateField)) {
            <span class="hljs-keyword">if</span> (ac.isOTM() || !ac.isVisible()) {
                <span class="hljs-keyword">if</span> (ac.isOTM())
                    searchForData(ac, elementName, <span class="hljs-string">'M2MList'</span>, noMax, additional);
                <span class="hljs-keyword">else</span>
                    searchForData(ac, elementName, type, noMax, additional);
            } <span class="hljs-keyword">else</span> {
                ac.showDropDown();
                dropDownHilight(ac, typedChar == KEY_ARROWUP ? <span class="hljs-number">-1</span> : <span class="hljs-number">1</span>);
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> (!updateField)
                setSavedText(ac, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>((invisibleField ? ac.invisibleTextValue : <span class="hljs-literal">null</span>), ac.textValue));
            <span class="hljs-keyword">if</span> (typedChar != KEY_ENTER &amp;&amp; typedChar != KEY_RETURN) {
                <span class="hljs-keyword">if</span> (ac.firstUse || ac.previousTextValue != ac.textValue) {
                    searchForData(ac, elementName, type, noMax, additional);
                    ac.firstUse = <span class="hljs-literal">false</span>;
                } <span class="hljs-keyword">else</span>
                    clearRelated(ac);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">var</span> selectedItemNum = ac.selectedItemNum;
                ac.hideDropDown();
                <span class="hljs-keyword">if</span> (ac.matched == <span class="hljs-literal">false</span> &amp;&amp; selectedItemNum == <span class="hljs-number">-1</span>) {
                    jslog(<span class="hljs-string">"Enter hit without matches, ignoring it"</span>);
                    <span class="hljs-keyword">return</span>;
                }
                fieldSet(ac);
                ac.previousTextValue = <span class="hljs-string">''</span>;
            }
        }
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateRelatedGivenNameAndValue</span>(<span class="hljs-params">elementName, elementValue</span>) </span>{
    <span class="hljs-keyword">var</span> viewField = gel(<span class="hljs-string">"view."</span> + elementName);
    <span class="hljs-keyword">if</span> (viewField == <span class="hljs-literal">null</span>)
        <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (isDoctype())
        viewField.style.display = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">else</span>
        viewField.style.display = <span class="hljs-string">"inline"</span>;
    <span class="hljs-keyword">var</span> viewRField = gel(<span class="hljs-string">"viewr."</span> + elementName);
    <span class="hljs-keyword">var</span> viewHideField = gel(<span class="hljs-string">"view."</span> + elementName + <span class="hljs-string">".no"</span>);
    <span class="hljs-keyword">if</span> (viewRField != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">if</span> (isDoctype())
            viewRField.style.display = <span class="hljs-string">''</span>;
        <span class="hljs-keyword">else</span>
            viewRField.style.display = <span class="hljs-string">"inline"</span>;
    }
    <span class="hljs-keyword">if</span> (viewHideField != <span class="hljs-literal">null</span>)
        viewHideField.style.display = <span class="hljs-string">"none"</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(g_form) == <span class="hljs-string">'undefined'</span>)
        <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> list = g_form.getDerivedFields(elementName);
    <span class="hljs-keyword">if</span> (list == <span class="hljs-literal">null</span>)
        <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> url = <span class="hljs-string">"xmlhttp.do?sysparm_processor=GetReferenceRecord"</span> +
        <span class="hljs-string">"&amp;sysparm_name="</span> + elementName +
        <span class="hljs-string">"&amp;sysparm_value="</span> + elementValue;
    <span class="hljs-keyword">var</span> args = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(elementName, list.join(<span class="hljs-string">','</span>));
    serverRequest(url, refFieldChangeResponse, args);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">emptySubstr</span>(<span class="hljs-params">ac</span>) </span>{
    <span class="hljs-keyword">return</span> findRelatedZeroString(ac, ac.textValue);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">searchForData</span>(<span class="hljs-params">ac, elementName, type, noMax, additional</span>) </span>{
    <span class="hljs-keyword">var</span> cachedData;
    <span class="hljs-keyword">if</span> (!additional &amp;&amp; !ac.isOTM())
        cachedData = retrieveStorage(ac, ac.textValue);
    <span class="hljs-built_in">window</span>.status = <span class="hljs-string">"Searching for: "</span> + ac.textValue;
    <span class="hljs-keyword">if</span> (emptySubstr(ac))
        cachedData = emptySubstr(ac);
    <span class="hljs-keyword">if</span> (cachedData) {
        fieldChangeResponse(cachedData, <span class="hljs-literal">true</span>);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">var</span> encodedText = encodeText(ac.textValue);
        <span class="hljs-keyword">var</span> url = <span class="hljs-string">"sysparm_processor="</span> + type +
            <span class="hljs-string">"&amp;sysparm_name="</span> + elementName +
            <span class="hljs-string">"&amp;sysparm_chars="</span> + encodedText +
            <span class="hljs-string">"&amp;sysparm_nomax="</span> + noMax +
            <span class="hljs-string">"&amp;sysparm_type="</span> + type;
        <span class="hljs-keyword">if</span> (ac.isOTM())
            url += <span class="hljs-string">"&amp;sysparm_field="</span> + ac.refField;
        <span class="hljs-keyword">if</span> (additional)
            url += <span class="hljs-string">"&amp;"</span> + additional;
        <span class="hljs-keyword">if</span> (type != <span class="hljs-string">"Reference"</span> &amp;&amp; <span class="hljs-keyword">typeof</span>(g_form) != <span class="hljs-string">"undefined"</span>)
            url += <span class="hljs-string">"&amp;"</span> + g_form.serialize();
        serverRequestPost(<span class="hljs-string">"xmlhttp.do"</span>, url, fieldChangeResponse);
        <span class="hljs-keyword">var</span> target = ac.getField();
        <span class="hljs-keyword">if</span> (target.type != <span class="hljs-string">'hidden'</span> &amp;&amp; ac.ignoreAJAX != <span class="hljs-literal">true</span>)
            ac.getField().focus();
    }
    setPreviousText(ac, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(ac.invisibleTextValue, ac.textValue));
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fieldChangeResponse</span>(<span class="hljs-params">request, nozero</span>) </span>{
    <span class="hljs-keyword">if</span> (request == <span class="hljs-literal">null</span>)
        <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> ac = request.responseXML.ac;
    <span class="hljs-keyword">if</span> (request.responseXML.documentElement) {
        <span class="hljs-keyword">var</span> xml = request.responseXML;
        <span class="hljs-keyword">var</span> items = xml.getElementsByTagName(<span class="hljs-string">"item"</span>);
        <span class="hljs-keyword">var</span> e = xml.documentElement;
        <span class="hljs-keyword">var</span> elementName = e.getAttribute(<span class="hljs-string">"sysparm_name"</span>);
        <span class="hljs-keyword">var</span> searchText = e.getAttribute(<span class="hljs-string">"sysparm_chars"</span>);
        <span class="hljs-keyword">var</span> type = e.getAttribute(<span class="hljs-string">"sysparm_type"</span>);
        <span class="hljs-keyword">var</span> displayField;
        <span class="hljs-keyword">var</span> invisibleField;
        <span class="hljs-keyword">if</span> (type == <span class="hljs-string">"Reference"</span>) {
            displayField = gel(<span class="hljs-string">"sys_display."</span> + elementName);
            invisibleField = gel(elementName);
        } <span class="hljs-keyword">else</span> {
            displayField = gel(elementName);
            invisibleField = gel(<span class="hljs-string">"sys_display."</span> + elementName);
        }
        <span class="hljs-keyword">var</span> ac = displayField.ac;
        <span class="hljs-keyword">if</span> (ac.ignoreAJAX == <span class="hljs-literal">true</span>)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">var</span> values = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
        <span class="hljs-built_in">window</span>.status = <span class="hljs-string">"Matches"</span> + (searchText ? <span class="hljs-string">" for "</span> + searchText : <span class="hljs-string">""</span>) + <span class="hljs-string">": "</span> + items.length;
        <span class="hljs-keyword">if</span> (items.length == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">if</span> (ac.getInvisibleField())
                ac.getInvisibleField().value = <span class="hljs-string">""</span>;
            <span class="hljs-keyword">if</span> (nozero != <span class="hljs-literal">true</span>)
                storeZeroString(ac, searchText, request);
        }
        <span class="hljs-keyword">if</span> (searchText &amp;&amp; ac.textValue &amp;&amp; searchText != ac.textValue)
            <span class="hljs-keyword">return</span>;
        storeResults(ac, (searchText ? searchText : <span class="hljs-string">""</span>), request);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> iCnt = <span class="hljs-number">0</span>; iCnt &lt; items.length; iCnt++) {
            <span class="hljs-keyword">var</span> item = items[iCnt];
            <span class="hljs-keyword">var</span> name = item.getAttribute(<span class="hljs-string">"name"</span>);
            <span class="hljs-keyword">var</span> label = item.getAttribute(<span class="hljs-string">"label"</span>);
            <span class="hljs-keyword">var</span> value = item.getAttribute(<span class="hljs-string">"value"</span>);
            <span class="hljs-keyword">var</span> className = item.getAttribute(<span class="hljs-string">"sys_class_name"</span>);
            value = replaceRegEx(value, <span class="hljs-built_in">document</span>, elementName.split(<span class="hljs-string">"."</span>)[<span class="hljs-number">0</span>]);
            values[values.length] = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(name, label, value, className);
        }
        <span class="hljs-keyword">if</span> (type == <span class="hljs-string">"Reference"</span>) {
            <span class="hljs-keyword">if</span> (items.length == <span class="hljs-number">1</span> &amp;&amp; searchText != <span class="hljs-literal">null</span> &amp;&amp; fieldMatches(searchText, items[<span class="hljs-number">0</span>].getAttribute(<span class="hljs-string">"label"</span>))) {
                displayField.value = items[<span class="hljs-number">0</span>].getAttribute(<span class="hljs-string">"label"</span>);
                invisibleField.value = items[<span class="hljs-number">0</span>].getAttribute(<span class="hljs-string">"name"</span>);
                fieldSet(ac);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">var</span> viewField = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"view."</span> + elementName);
                <span class="hljs-keyword">var</span> viewHideField = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"view."</span> + elementName + <span class="hljs-string">".no"</span>);
                <span class="hljs-keyword">if</span> (viewField != <span class="hljs-literal">null</span>)
                    viewField.style.display = <span class="hljs-string">"none"</span>;
                <span class="hljs-keyword">if</span> (viewHideField != <span class="hljs-literal">null</span>)
                    viewHideField.style.display = <span class="hljs-string">"inline"</span>;
                invisibleField.value = <span class="hljs-string">""</span>;
                ac.dirty = <span class="hljs-literal">true</span>;
            }
        }
        <span class="hljs-keyword">if</span> (ac.getUpdateField()) {
            updateSlushField(ac, values);
        } <span class="hljs-keyword">else</span> {
            createDropDown(ac, values);
            ac.showDropDown();
        }
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">window</span>.status = <span class="hljs-string">""</span>;
        <span class="hljs-keyword">if</span> (ac.getUpdateField())
            updateSlushField(ac, <span class="hljs-literal">null</span>);
        <span class="hljs-keyword">else</span> {
            clearRelated(ac);
            ac.clearDropDown();
        }
    }
    <span class="hljs-keyword">if</span> (!ac.getUpdateField() &amp;&amp; ac.currentMenuCount &lt; <span class="hljs-number">1</span>)
        ac.hideDropDown();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fieldMatches</span>(<span class="hljs-params">search, retitem</span>) </span>{
    <span class="hljs-keyword">if</span> (search.length &gt;= retitem.length) {
        <span class="hljs-keyword">var</span> cc = retitem.substring(<span class="hljs-number">0</span>, search.length);
        <span class="hljs-keyword">if</span> (search.toLowerCase() == cc.toLowerCase()) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lightWeightReferenceLink</span>(<span class="hljs-params">inputName, tableName, addOnRefClick</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(addOnRefClick) != <span class="hljs-string">"undefined"</span> &amp;&amp; addOnRefClick) {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(g_cart) == <span class="hljs-string">"undefined"</span>)
            g_cart = <span class="hljs-keyword">new</span> SCCartV2();
        g_cart.showReferenceForm(inputName, tableName);
        <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">var</span> input = gel(inputName);
    <span class="hljs-keyword">var</span> sys_id = input.value;
    <span class="hljs-keyword">var</span> url = tableName + <span class="hljs-string">".do?sys_id="</span> + sys_id;
    <span class="hljs-keyword">var</span> frame = top.gsft_main;
    <span class="hljs-keyword">if</span> (!frame)
        frame = top;
    frame.location = url;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearDependents</span>(<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">var</span> nodes = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'input'</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; nodes.length; i++) {
        <span class="hljs-keyword">var</span> current = nodes[i];
        <span class="hljs-keyword">var</span> dependentField = current.dependent_field;
        <span class="hljs-keyword">if</span> (!dependentField)
            <span class="hljs-keyword">continue</span>;
        <span class="hljs-keyword">if</span> (name == dependentField) {
            current.value = <span class="hljs-string">""</span>;
            <span class="hljs-keyword">var</span> ac = getAC(current.name);
            <span class="hljs-keyword">if</span> (ac) {
                ac.resultsStorage = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
                ac.emptyResults = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
            }
            clearDependents(current.id);
        }
    }
};
<span class="hljs-comment">/*! RESOURCE: /scripts/ac_derived_field_support.js */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">refFieldChangeResponse</span>(<span class="hljs-params">request, args</span>) </span>{
    <span class="hljs-keyword">if</span> (request == <span class="hljs-literal">null</span>)
        <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> elementName = args[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">var</span> parts = elementName.split(<span class="hljs-string">"."</span>);
    parts.shift();
    <span class="hljs-keyword">var</span> sName = parts.join(<span class="hljs-string">"."</span>) + <span class="hljs-string">"."</span>;
    <span class="hljs-keyword">if</span> (args[<span class="hljs-number">1</span>]) {
        <span class="hljs-keyword">var</span> fields = args[<span class="hljs-number">1</span>].split(<span class="hljs-string">','</span>);
        setNodes(sName, fields, request);
        <span class="hljs-keyword">return</span>;
    }
    jslog(<span class="hljs-string">"************** WHAT ARE WE DOING HERE *********************"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setNodes</span>(<span class="hljs-params">sName, array, request</span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; array.length; i++) {
        <span class="hljs-keyword">var</span> fn = array[i];
        <span class="hljs-keyword">var</span> eln = sName + fn;
        <span class="hljs-keyword">var</span> elo = g_form.getGlideUIElement(eln);
        <span class="hljs-keyword">if</span> (!elo)
            <span class="hljs-keyword">continue</span>;
        <span class="hljs-keyword">var</span> field = request.responseXML.getElementsByTagName(fn);
        <span class="hljs-keyword">if</span> (field.length != <span class="hljs-number">1</span>) {
            g_form.clearValue(eln);
            <span class="hljs-keyword">if</span> (g_form._isDerivedWaiting(eln)) {
                g_form.setReadOnly(eln, <span class="hljs-literal">false</span>);
                g_form._removeDerivedWaiting(eln);
            }
            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">var</span> dv = field[<span class="hljs-number">0</span>].getAttribute(<span class="hljs-string">'value'</span>);
        <span class="hljs-keyword">var</span> v = field[<span class="hljs-number">0</span>].getAttribute(<span class="hljs-string">'db_value'</span>);
        <span class="hljs-keyword">if</span> (elo.getType() == <span class="hljs-string">'glide_list'</span> || elo.getType() == <span class="hljs-string">'reference'</span>) {
            <span class="hljs-keyword">var</span> v = field[<span class="hljs-number">0</span>].getAttribute(<span class="hljs-string">'db_value'</span>)
            g_form._setValue(eln, v, dv.split(<span class="hljs-string">","</span>), <span class="hljs-literal">false</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (v)
            g_form.setValue(eln, v, dv);
        <span class="hljs-keyword">else</span>
            g_form.setValue(eln, dv);
        <span class="hljs-keyword">if</span> (g_form._isDerivedWaiting(eln)) {
            g_form.setReadOnly(eln, <span class="hljs-literal">false</span>);
            g_form._removeDerivedWaiting(eln);
        }
    }
};
<span class="hljs-comment">/*! RESOURCE: /scripts/lib/glide_updates/prototype.effects.js */</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> elemdisplay = {};
    <span class="hljs-keyword">var</span> rfxtypes = <span class="hljs-regexp">/^(?:toggle|show|hide)$/</span>;
    <span class="hljs-keyword">var</span> ralpha = <span class="hljs-regexp">/alpha\([^)]*\)/i</span>;
    <span class="hljs-keyword">var</span> rdigit = <span class="hljs-regexp">/\d/</span>;
    <span class="hljs-keyword">var</span> ropacity = <span class="hljs-regexp">/opacity=([^)]*)/</span>;
    <span class="hljs-keyword">var</span> rfxnum = <span class="hljs-regexp">/^([+\-]=)?([\d+.\-]+)(.*)$/</span>;
    <span class="hljs-keyword">var</span> rnumpx = <span class="hljs-regexp">/^-?\d+(?:px)?$/i</span>;
    <span class="hljs-keyword">var</span> rnum = <span class="hljs-regexp">/^-?\d/</span>;
    <span class="hljs-keyword">var</span> timerId;
    <span class="hljs-keyword">var</span> fxAttrs = [
        [<span class="hljs-string">"height"</span>, <span class="hljs-string">"marginTop"</span>, <span class="hljs-string">"marginBottom"</span>, <span class="hljs-string">"paddingTop"</span>, <span class="hljs-string">"paddingBottom"</span>],
        [<span class="hljs-string">"width"</span>, <span class="hljs-string">"marginLeft"</span>, <span class="hljs-string">"marginRight"</span>, <span class="hljs-string">"paddingLeft"</span>, <span class="hljs-string">"paddingRight"</span>],
        [<span class="hljs-string">"opacity"</span>]
    ];
    <span class="hljs-keyword">var</span> shrinkWrapBlocks = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> inlineBlockNeedsLayout = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> cssFloat = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> curCSS;
    <span class="hljs-keyword">var</span> opacitySupport;
    <span class="hljs-built_in">document</span>.observe(<span class="hljs-string">"dom:loaded"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> div = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
        div.style.width = div.style.paddingLeft = <span class="hljs-string">"1px"</span>;
        <span class="hljs-built_in">document</span>.body.appendChild(div);
        <span class="hljs-keyword">if</span> (<span class="hljs-string">"zoom"</span> <span class="hljs-keyword">in</span> div.style) {
            div.style.display = <span class="hljs-string">"inline"</span>;
            div.style.zoom = <span class="hljs-number">1</span>;
            inlineBlockNeedsLayout = div.offsetWidth === <span class="hljs-number">2</span>;
            div.style.display = <span class="hljs-string">""</span>;
            div.innerHTML = <span class="hljs-string">"&lt;div style='width:4px;'&gt;&lt;/div&gt;"</span>;
            shrinkWrapBlocks = div.offsetWidth !== <span class="hljs-number">2</span>;
            <span class="hljs-built_in">document</span>.body.removeChild(div);
        }
        div = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
        div.style.display = <span class="hljs-string">"none"</span>;
        div.innerHTML = <span class="hljs-string">"&lt;link/&gt;&lt;table&gt;&lt;/table&gt;&lt;a href='/a' style='color:red;float:left;opacity:.55;'&gt;a&lt;/a&gt;&lt;input type='checkbox'/&gt;"</span>;
        <span class="hljs-built_in">document</span>.body.appendChild(div);
        <span class="hljs-keyword">var</span> a = div.getElementsByTagName(<span class="hljs-string">"a"</span>)[<span class="hljs-number">0</span>];
        opacitySupport = <span class="hljs-regexp">/^0.55$/</span>.test(a.style.opacity);
        cssFloat = !!a.style.cssFloat;
        <span class="hljs-built_in">document</span>.body.removeChild(div);
        <span class="hljs-keyword">if</span> (!opacitySupport) {
            Prototype.cssHooks.opacity = {
                <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem, computed</span>) </span>{
                    <span class="hljs-keyword">return</span> ropacity.test((computed &amp;&amp; elem.currentStyle ? elem.currentStyle.filter : elem.style.filter) || <span class="hljs-string">""</span>) ?
                        (<span class="hljs-built_in">parseFloat</span>(<span class="hljs-built_in">RegExp</span>.$<span class="hljs-number">1</span>) / <span class="hljs-number">100</span>) + <span class="hljs-string">""</span> :
                        computed ? <span class="hljs-string">"1"</span> : <span class="hljs-string">""</span>;
                },
                <span class="hljs-attr">set</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem, value</span>) </span>{
                    <span class="hljs-keyword">var</span> style = elem.style;
                    style.zoom = <span class="hljs-number">1</span>;
                    <span class="hljs-keyword">var</span> opacity = Prototype.isNaN(value) ?
                        <span class="hljs-string">""</span> :
                        <span class="hljs-string">"alpha(opacity="</span> + value * <span class="hljs-number">100</span> + <span class="hljs-string">")"</span>,
                        filter = style.filter || <span class="hljs-string">""</span>;
                    style.filter = ralpha.test(filter) ?
                        filter.replace(ralpha, opacity) :
                        style.filter + <span class="hljs-string">' '</span> + opacity;
                }
            };
        }
    });
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.defaultView &amp;&amp; <span class="hljs-built_in">document</span>.defaultView.getComputedStyle) {
        curCSS = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem, newName, name</span>) </span>{
            <span class="hljs-keyword">var</span> ret;
            <span class="hljs-keyword">var</span> defaultView;
            <span class="hljs-keyword">var</span> computedStyle;
            name = name.replace(rupper, <span class="hljs-string">"-$1"</span>).toLowerCase();
            <span class="hljs-keyword">if</span> (!(defaultView = elem.ownerDocument.defaultView))
                <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;
            <span class="hljs-keyword">if</span> ((computedStyle = defaultView.getComputedStyle(elem, <span class="hljs-literal">null</span>))) {
                ret = computedStyle.getPropertyValue(name);
                <span class="hljs-keyword">if</span> (ret === <span class="hljs-string">""</span> &amp;&amp; !contains(elem.ownerDocument.documentElement, elem))
                    ret = style(elem, name);
            }
            <span class="hljs-keyword">return</span> ret;
        };
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.documentElement.currentStyle) {
        curCSS = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem, name</span>) </span>{
            <span class="hljs-keyword">var</span> left;
            <span class="hljs-keyword">var</span> rsLeft;
            <span class="hljs-keyword">var</span> ret = elem.currentStyle &amp;&amp; elem.currentStyle[name];
            <span class="hljs-keyword">var</span> style = elem.style;
            <span class="hljs-keyword">if</span> (!rnumpx.test(ret) &amp;&amp; rnum.test(ret)) {
                left = style.left;
                rsLeft = elem.runtimeStyle.left;
                elem.runtimeStyle.left = elem.currentStyle.left;
                style.left = name === <span class="hljs-string">"fontSize"</span> ? <span class="hljs-string">"1em"</span> : (ret || <span class="hljs-number">0</span>);
                ret = style.pixelLeft + <span class="hljs-string">"px"</span>;
                style.left = left;
                elem.runtimeStyle.left = rsLeft;
            }
            <span class="hljs-keyword">return</span> ret === <span class="hljs-string">""</span> ? <span class="hljs-string">"auto"</span> : ret;
        };
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">contains</span>(<span class="hljs-params">a, b</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.compareDocumentPosition ? a.compareDocumentPosition(b) &amp; <span class="hljs-number">16</span> :
            (a !== b &amp;&amp; (a.contains ? a.contains(b) : <span class="hljs-literal">true</span>));
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">style</span>(<span class="hljs-params">elem, name, value, extra</span>) </span>{
        <span class="hljs-keyword">if</span> (!elem || elem.nodeType === <span class="hljs-number">3</span> || elem.nodeType === <span class="hljs-number">8</span> || !elem.style)
            <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">var</span> ret;
        <span class="hljs-keyword">var</span> origName = name.camelize();
        <span class="hljs-keyword">var</span> s = elem.style;
        <span class="hljs-keyword">var</span> hooks = Prototype.cssHooks[origName];
        name = Prototype.cssProps[origName] || origName;
        <span class="hljs-keyword">if</span> (value !== <span class="hljs-literal">undefined</span>) {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">"number"</span> &amp;&amp; <span class="hljs-built_in">isNaN</span>(value) || value == <span class="hljs-literal">null</span>)
                <span class="hljs-keyword">return</span>;
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">"number"</span> &amp;&amp; !Prototype.cssNumber[origName])
                value += <span class="hljs-string">"px"</span>;
            <span class="hljs-keyword">if</span> (!hooks || !(<span class="hljs-string">"set"</span> <span class="hljs-keyword">in</span> hooks) || (value = hooks.set(elem, value)) !== <span class="hljs-literal">undefined</span>) {
                <span class="hljs-keyword">try</span> {
                    s[name] = value;
                } <span class="hljs-keyword">catch</span> (e) {}
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> (hooks &amp;&amp; <span class="hljs-string">"get"</span> <span class="hljs-keyword">in</span> hooks &amp;&amp; (ret = hooks.get(elem, <span class="hljs-literal">false</span>, extra)) !== <span class="hljs-literal">undefined</span>)
                <span class="hljs-keyword">return</span> ret;
            <span class="hljs-keyword">return</span> s[name];
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isEmptyObject</span>(<span class="hljs-params">obj</span>) </span>{
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> name <span class="hljs-keyword">in</span> obj)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isWindow</span>(<span class="hljs-params">obj</span>) </span>{
        <span class="hljs-keyword">return</span> obj &amp;&amp; <span class="hljs-keyword">typeof</span> obj === <span class="hljs-string">"object"</span> &amp;&amp; <span class="hljs-string">"setInterval"</span> <span class="hljs-keyword">in</span> obj;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">arrayMerge</span>(<span class="hljs-params">first, second</span>) </span>{
        <span class="hljs-keyword">var</span> i = first.length;
        <span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> second.length === <span class="hljs-string">"number"</span>) {
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> l = second.length; j &lt; l; j++)
                first[i++] = second[j];
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">while</span> (second[j] !== <span class="hljs-literal">undefined</span>)
                first[i++] = second[j++];
        }
        first.length = i;
        <span class="hljs-keyword">return</span> first;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makeArray</span>(<span class="hljs-params">array</span>) </span>{
        <span class="hljs-keyword">var</span> ret = [];
        <span class="hljs-keyword">if</span> (array != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">var</span> type = <span class="hljs-keyword">typeof</span> array;
            <span class="hljs-keyword">if</span> (array.length == <span class="hljs-literal">null</span> || type === <span class="hljs-string">"string"</span> || type === <span class="hljs-string">"function"</span> || type === <span class="hljs-string">"regexp"</span> || isWindow(array))
                <span class="hljs-built_in">Array</span>.prototype.push.call(ret, array);
            <span class="hljs-keyword">else</span>
                arrayMerge(ret, array);
        }
        <span class="hljs-keyword">return</span> ret;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">genFx</span>(<span class="hljs-params">type, num</span>) </span>{
        <span class="hljs-keyword">var</span> obj = {};
        fxAttrs.concat.apply([], fxAttrs.slice(<span class="hljs-number">0</span>, num)).each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">context</span>) </span>{
            obj[context] = type;
        });
        <span class="hljs-keyword">return</span> obj;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">defaultDisplay</span>(<span class="hljs-params">nodeName</span>) </span>{
        <span class="hljs-keyword">if</span> (elemdisplay[nodeName])
            <span class="hljs-keyword">return</span> elemdisplay[nodeName];
        <span class="hljs-keyword">var</span> e = $(<span class="hljs-built_in">document</span>.createElement(nodeName));
        <span class="hljs-built_in">document</span>.body.appendChild(e);
        <span class="hljs-keyword">var</span> display = e.getStyle(<span class="hljs-string">"display"</span>);
        e.remove();
        <span class="hljs-keyword">if</span> (display === <span class="hljs-string">"none"</span> || display === <span class="hljs-string">""</span>)
            display = <span class="hljs-string">"block"</span>;
        elemdisplay[nodeName] = display;
        <span class="hljs-keyword">return</span> display;
    }
    Prototype.effects = {
        <span class="hljs-attr">speed</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">speed, easing, fn</span>) </span>{
            <span class="hljs-keyword">var</span> opt = speed &amp;&amp; <span class="hljs-keyword">typeof</span> speed === <span class="hljs-string">"object"</span> ? <span class="hljs-built_in">Object</span>.extend({}, speed) : {
                <span class="hljs-attr">complete</span>: fn || !fn &amp;&amp; easing || <span class="hljs-keyword">typeof</span> speed == <span class="hljs-string">'function'</span> &amp;&amp; speed,
                <span class="hljs-attr">duration</span>: speed,
                <span class="hljs-attr">easing</span>: fn &amp;&amp; easing || easing &amp;&amp; !(<span class="hljs-keyword">typeof</span> easing == <span class="hljs-string">'function'</span>) &amp;&amp; easing
            };
            opt.duration = Prototype.effects.fx.off ? <span class="hljs-number">0</span> : <span class="hljs-keyword">typeof</span> opt.duration === <span class="hljs-string">"number"</span> ? opt.duration :
                opt.duration <span class="hljs-keyword">in</span> Prototype.effects.fx.speeds ? Prototype.effects.fx.speeds[opt.duration] : Prototype.effects.fx.speeds._default;
            opt.old = opt.complete;
            opt.complete = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">if</span> (opt.queue !== <span class="hljs-literal">false</span>)
                    $(<span class="hljs-keyword">this</span>).dequeue();
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> opt.old == <span class="hljs-string">'function'</span>)
                    opt.old.call(<span class="hljs-keyword">this</span>);
            };
            <span class="hljs-keyword">return</span> opt;
        },
        <span class="hljs-attr">easing</span>: {
            <span class="hljs-attr">linear</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">p, n, firstNum, diff</span>) </span>{
                <span class="hljs-keyword">return</span> firstNum + diff * p;
            },
            <span class="hljs-attr">swing</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">p, n, firstNum, diff</span>) </span>{
                <span class="hljs-keyword">return</span> ((-<span class="hljs-built_in">Math</span>.cos(p * <span class="hljs-built_in">Math</span>.PI) / <span class="hljs-number">2</span>) + <span class="hljs-number">0.5</span>) * diff + firstNum;
            }
        },
        <span class="hljs-attr">timers</span>: [],
        <span class="hljs-attr">fx</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem, options, prop</span>) </span>{
            <span class="hljs-keyword">this</span>.elem = elem;
            <span class="hljs-keyword">this</span>.options = options;
            <span class="hljs-keyword">this</span>.prop = prop;
            <span class="hljs-keyword">if</span> (!options.orig)
                options.orig = {};
        }
    };
    Prototype.effects.fx.prototype = {
        <span class="hljs-attr">update</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.step)
                <span class="hljs-keyword">this</span>.options.step.call(<span class="hljs-keyword">this</span>.elem, <span class="hljs-keyword">this</span>.now, <span class="hljs-keyword">this</span>);
            (Prototype.effects.fx.step[<span class="hljs-keyword">this</span>.prop] || Prototype.effects.fx.step._default)(<span class="hljs-keyword">this</span>);
        },
        <span class="hljs-attr">cur</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.elem[<span class="hljs-keyword">this</span>.prop] != <span class="hljs-literal">null</span> &amp;&amp; (!<span class="hljs-keyword">this</span>.elem.style || <span class="hljs-keyword">this</span>.elem.style[<span class="hljs-keyword">this</span>.prop] == <span class="hljs-literal">null</span>))
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.elem[<span class="hljs-keyword">this</span>.prop];
            <span class="hljs-keyword">var</span> r = <span class="hljs-built_in">parseFloat</span>(<span class="hljs-keyword">this</span>.elem.getStyle(<span class="hljs-keyword">this</span>.prop));
            <span class="hljs-keyword">return</span> r || <span class="hljs-number">0</span>;
        },
        <span class="hljs-attr">custom</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">from, to, unit</span>) </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
            <span class="hljs-keyword">var</span> fx = Prototype.effects.fx;
            <span class="hljs-keyword">this</span>.startTime = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime()
            <span class="hljs-keyword">this</span>.start = <span class="hljs-keyword">from</span>;
            <span class="hljs-keyword">this</span>.end = to;
            <span class="hljs-keyword">this</span>.unit = unit || <span class="hljs-keyword">this</span>.unit || <span class="hljs-string">"px"</span>;
            <span class="hljs-keyword">this</span>.now = <span class="hljs-keyword">this</span>.start;
            <span class="hljs-keyword">this</span>.pos = <span class="hljs-keyword">this</span>.state = <span class="hljs-number">0</span>;

            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">t</span>(<span class="hljs-params">gotoEnd</span>) </span>{
                <span class="hljs-keyword">return</span> self.step(gotoEnd);
            }
            t.elem = <span class="hljs-keyword">this</span>.elem;
            <span class="hljs-keyword">if</span> (t() &amp;&amp; Prototype.effects.timers.push(t) &amp;&amp; !timerId)
                timerId = setInterval(fx.tick, fx.interval);
        },
        <span class="hljs-attr">show</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">this</span>.options.orig[<span class="hljs-keyword">this</span>.prop] = style(<span class="hljs-keyword">this</span>.elem, <span class="hljs-keyword">this</span>.prop);
            <span class="hljs-keyword">this</span>.options.show = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">this</span>.custom(<span class="hljs-keyword">this</span>.prop === <span class="hljs-string">"width"</span> || <span class="hljs-keyword">this</span>.prop === <span class="hljs-string">"height"</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.cur());
            $(<span class="hljs-keyword">this</span>.elem).show();
        },
        <span class="hljs-attr">hide</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">this</span>.options.orig[<span class="hljs-keyword">this</span>.prop] = style(<span class="hljs-keyword">this</span>.elem, <span class="hljs-keyword">this</span>.prop);
            <span class="hljs-keyword">this</span>.options.hide = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">this</span>.custom(<span class="hljs-keyword">this</span>.cur(), <span class="hljs-number">0</span>);
        },
        <span class="hljs-attr">step</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">gotoEnd</span>) </span>{
            <span class="hljs-keyword">var</span> t = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime();
            <span class="hljs-keyword">var</span> done = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">if</span> (gotoEnd || t &gt;= <span class="hljs-keyword">this</span>.options.duration + <span class="hljs-keyword">this</span>.startTime) {
                <span class="hljs-keyword">this</span>.now = <span class="hljs-keyword">this</span>.end;
                <span class="hljs-keyword">this</span>.pos = <span class="hljs-keyword">this</span>.state = <span class="hljs-number">1</span>;
                <span class="hljs-keyword">this</span>.update();
                <span class="hljs-keyword">this</span>.options.curAnim[<span class="hljs-keyword">this</span>.prop] = <span class="hljs-literal">true</span>;
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>.options.curAnim) {
                    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.curAnim[i] !== <span class="hljs-literal">true</span>)
                        done = <span class="hljs-literal">false</span>;
                }
                <span class="hljs-keyword">if</span> (done) {
                    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.overflow != <span class="hljs-literal">null</span> &amp;&amp; !shrinkWrapBlocks) {
                        <span class="hljs-keyword">var</span> elem = <span class="hljs-keyword">this</span>.elem;
                        <span class="hljs-keyword">var</span> options = <span class="hljs-keyword">this</span>.options;
                        <span class="hljs-keyword">var</span> overflowArray = [<span class="hljs-string">""</span>, <span class="hljs-string">"X"</span>, <span class="hljs-string">"Y"</span>];
                        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> ii = <span class="hljs-number">0</span>, ll = overflowArray.length; ii &lt; ll; ii++)
                            elem.style[<span class="hljs-string">"overflow"</span> + overflowArray[ii]] = options.overflow[ii];
                    }
                    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.hide) {
                        $(<span class="hljs-keyword">this</span>.elem).hide();
                        <span class="hljs-keyword">if</span> (Prototype.Browser.IE)
                            $(<span class="hljs-keyword">this</span>.elem).setStyle({
                                <span class="hljs-attr">filter</span>: <span class="hljs-string">''</span>
                            });
                    }
                    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.hide || <span class="hljs-keyword">this</span>.options.show) {
                        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> p <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>.options.curAnim)
                            style(<span class="hljs-keyword">this</span>.elem, p, <span class="hljs-keyword">this</span>.options.orig[p]);
                    }
                    <span class="hljs-keyword">this</span>.options.complete.call(<span class="hljs-keyword">this</span>.elem);
                }
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">var</span> n = t - <span class="hljs-keyword">this</span>.startTime;
                <span class="hljs-keyword">this</span>.state = n / <span class="hljs-keyword">this</span>.options.duration;
                <span class="hljs-keyword">var</span> specialEasing = <span class="hljs-keyword">this</span>.options.specialEasing &amp;&amp; <span class="hljs-keyword">this</span>.options.specialEasing[<span class="hljs-keyword">this</span>.prop];
                <span class="hljs-keyword">var</span> defaultEasing = <span class="hljs-keyword">this</span>.options.easing || (Prototype.effects.easing.swing ? <span class="hljs-string">"swing"</span> : <span class="hljs-string">"linear"</span>);
                <span class="hljs-keyword">this</span>.pos = Prototype.effects.easing[specialEasing || defaultEasing](<span class="hljs-keyword">this</span>.state, n, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-keyword">this</span>.options.duration);
                <span class="hljs-keyword">this</span>.now = <span class="hljs-keyword">this</span>.start + ((<span class="hljs-keyword">this</span>.end - <span class="hljs-keyword">this</span>.start) * <span class="hljs-keyword">this</span>.pos);
                <span class="hljs-keyword">this</span>.update();
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
    };
    <span class="hljs-built_in">Object</span>.extend(Prototype.effects.fx, {
        <span class="hljs-attr">tick</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> timers = Prototype.effects.timers;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; timers.length; i++) {
                <span class="hljs-keyword">if</span> (!timers[i]())
                    timers.splice(i--, <span class="hljs-number">1</span>);
            }
            <span class="hljs-keyword">if</span> (!timers.length)
                Prototype.effects.fx.stop();
        },
        <span class="hljs-attr">interval</span>: <span class="hljs-number">13</span>,
        <span class="hljs-attr">stop</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            clearInterval(timerId);
            timerId = <span class="hljs-literal">null</span>;
        },
        <span class="hljs-attr">speeds</span>: {
            <span class="hljs-attr">slow</span>: <span class="hljs-number">600</span>,
            <span class="hljs-attr">fast</span>: <span class="hljs-number">200</span>,
            <span class="hljs-attr">_default</span>: <span class="hljs-number">400</span>
        },
        <span class="hljs-attr">step</span>: {
            <span class="hljs-attr">opacity</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fx</span>) </span>{
                fx.elem.setStyle({
                    <span class="hljs-attr">opacity</span>: fx.now
                });
            },
            <span class="hljs-attr">_default</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fx</span>) </span>{
                <span class="hljs-keyword">if</span> (fx.elem.style &amp;&amp; fx.elem.style[fx.prop] != <span class="hljs-literal">null</span>)
                    fx.elem.style[fx.prop] = (fx.prop === <span class="hljs-string">"width"</span> || fx.prop === <span class="hljs-string">"height"</span> ? <span class="hljs-built_in">Math</span>.max(<span class="hljs-number">0</span>, fx.now) : fx.now) + fx.unit;
                <span class="hljs-keyword">else</span>
                    fx.elem[fx.prop] = fx.now;
            }
        }
    });
    <span class="hljs-built_in">Object</span>.extend(Prototype, {
        <span class="hljs-attr">isNaN</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">obj</span>) </span>{
            <span class="hljs-keyword">return</span> obj == <span class="hljs-literal">null</span> || !rdigit.test(obj) || <span class="hljs-built_in">isNaN</span>(obj);
        },
        <span class="hljs-attr">queue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem, type, data</span>) </span>{
            <span class="hljs-keyword">if</span> (!elem)
                <span class="hljs-keyword">return</span>;
            type = (type || <span class="hljs-string">"fx"</span>) + <span class="hljs-string">"queue"</span>;
            <span class="hljs-keyword">var</span> q = elem.retrieve(type);
            <span class="hljs-keyword">if</span> (!data)
                <span class="hljs-keyword">return</span> q || [];
            <span class="hljs-keyword">if</span> (!q || <span class="hljs-built_in">Object</span>.isArray(data))
                q = elem.store(type, makeArray(data));
            <span class="hljs-keyword">else</span>
                q.push(data);
            <span class="hljs-keyword">return</span> q;
        },
        <span class="hljs-attr">dequeue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem, type</span>) </span>{
            type = type || <span class="hljs-string">"fx"</span>;
            <span class="hljs-keyword">var</span> queue = Prototype.queue(elem, type);
            <span class="hljs-keyword">var</span> fn = queue.shift();
            <span class="hljs-keyword">if</span> (fn === <span class="hljs-string">"inprogress"</span>)
                fn = queue.shift();
            <span class="hljs-keyword">if</span> (fn) {
                <span class="hljs-keyword">if</span> (type === <span class="hljs-string">"fx"</span>)
                    queue.unshift(<span class="hljs-string">"inprogress"</span>);
                fn.call(elem, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                    Prototype.dequeue(elem, type);
                });
            }
        },
        <span class="hljs-attr">cssHooks</span>: {
            <span class="hljs-attr">opacity</span>: {
                <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem, computed</span>) </span>{
                    <span class="hljs-keyword">if</span> (computed) {
                        <span class="hljs-keyword">var</span> ret = curCSS(elem, <span class="hljs-string">"opacity"</span>, <span class="hljs-string">"opacity"</span>);
                        <span class="hljs-keyword">return</span> ret === <span class="hljs-string">""</span> ? <span class="hljs-string">"1"</span> : ret;
                    }
                    <span class="hljs-keyword">return</span> elem.style.opacity;
                }
            }
        },
        <span class="hljs-attr">cssProps</span>: {
            <span class="hljs-string">"float"</span>: cssFloat ? <span class="hljs-string">"cssFloat"</span> : <span class="hljs-string">"styleFloat"</span>
        },
        <span class="hljs-attr">cssNumber</span>: {
            <span class="hljs-string">"zIndex"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-string">"fontWeight"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-string">"opacity"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-string">"zoom"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-string">"lineHeight"</span>: <span class="hljs-literal">true</span>
        }
    });

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">show</span>(<span class="hljs-params">elem, speed, easing, callback</span>) </span>{
        <span class="hljs-keyword">if</span> (speed || speed === <span class="hljs-number">0</span>)
            <span class="hljs-keyword">return</span> animate(elem, genFx(<span class="hljs-string">"show"</span>, <span class="hljs-number">3</span>), speed, easing, callback);
        <span class="hljs-keyword">var</span> display = elem.style.display;
        <span class="hljs-keyword">if</span> (!elem.retrieve(<span class="hljs-string">"olddisplay"</span>) &amp;&amp; display === <span class="hljs-string">"none"</span>)
            display = elem.style.display = <span class="hljs-string">""</span>;
        <span class="hljs-keyword">if</span> (display === <span class="hljs-string">""</span> &amp;&amp; elem.getStyle(<span class="hljs-string">"display"</span>) === <span class="hljs-string">"none"</span>)
            elem.store(<span class="hljs-string">"olddisplay"</span>, defaultDisplay(elem.nodeName));
        display = elem.style.display;
        <span class="hljs-keyword">if</span> (display === <span class="hljs-string">""</span> || display === <span class="hljs-string">"none"</span>)
            elem.style.display = elem.retrieve(<span class="hljs-string">"olddisplay"</span>) || <span class="hljs-string">""</span>;
        <span class="hljs-keyword">return</span> elem;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hide</span>(<span class="hljs-params">elem, speed, easing, callback</span>) </span>{
        <span class="hljs-keyword">if</span> (speed || speed === <span class="hljs-number">0</span>)
            <span class="hljs-keyword">return</span> animate(elem, genFx(<span class="hljs-string">"hide"</span>, <span class="hljs-number">3</span>), speed, easing, callback);
        <span class="hljs-keyword">var</span> display = elem.getStyle(<span class="hljs-string">'display'</span>);
        <span class="hljs-keyword">if</span> (display !== <span class="hljs-string">"none"</span>)
            elem.store(<span class="hljs-string">"olddisplay"</span>, elem.getStyle(<span class="hljs-string">'display'</span>));
        elem.style.display = <span class="hljs-string">"none"</span>;
        <span class="hljs-keyword">return</span> elem;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toggle</span>(<span class="hljs-params">elem, fn, fn2, callback</span>) </span>{
        <span class="hljs-keyword">var</span> bool = <span class="hljs-keyword">typeof</span> fn === <span class="hljs-string">"boolean"</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> fn == <span class="hljs-string">'function'</span> &amp;&amp; <span class="hljs-keyword">typeof</span> fn2 == <span class="hljs-string">'function'</span>)
            toggle.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (fn == <span class="hljs-literal">null</span> || bool) {
            <span class="hljs-keyword">var</span> state = bool ? fn : !elem.visible();
            elem[state ? <span class="hljs-string">"show"</span> : <span class="hljs-string">"hide"</span>]();
        } <span class="hljs-keyword">else</span>
            animate(elem, genFx(<span class="hljs-string">"toggle"</span>, <span class="hljs-number">3</span>), fn, fn2, callback);
        <span class="hljs-keyword">return</span> elem;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fadeTo</span>(<span class="hljs-params">elem, speed, to, easing, callback</span>) </span>{
        elem.setStyle({
            <span class="hljs-attr">opacity</span>: <span class="hljs-number">0</span>
        });
        <span class="hljs-keyword">if</span> (!elem.visible())
            elem.show();
        <span class="hljs-keyword">return</span> animate(elem, {
            <span class="hljs-attr">opacity</span>: to
        }, speed, easing, callback);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">animate</span>(<span class="hljs-params">elem, prop, speed, easing, callback</span>) </span>{
        <span class="hljs-keyword">var</span> optall = Prototype.effects.speed(speed, easing, callback);
        <span class="hljs-keyword">if</span> (isEmptyObject(prop))
            <span class="hljs-keyword">return</span> optall.complete;
        <span class="hljs-keyword">return</span> elem[optall.queue === <span class="hljs-literal">false</span> ? <span class="hljs-string">"_execute"</span> : <span class="hljs-string">"queue"</span>](<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> opt = <span class="hljs-built_in">Object</span>.extend({}, optall);
            <span class="hljs-keyword">var</span> p;
            <span class="hljs-keyword">var</span> isElement = elem.nodeType === <span class="hljs-number">1</span>;
            <span class="hljs-keyword">var</span> hidden = isElement &amp;&amp; !elem.visible();
            <span class="hljs-keyword">for</span> (p <span class="hljs-keyword">in</span> prop) {
                <span class="hljs-keyword">var</span> name = p.camelize();
                <span class="hljs-keyword">if</span> (p !== name) {
                    prop[name] = prop[p];
                    <span class="hljs-keyword">delete</span> prop[p];
                    p = name;
                }
                <span class="hljs-keyword">if</span> (prop[p] === <span class="hljs-string">"hide"</span> &amp;&amp; hidden || prop[p] === <span class="hljs-string">"show"</span> &amp;&amp; !hidden)
                    <span class="hljs-keyword">return</span> opt.complete.call(<span class="hljs-keyword">this</span>);
                <span class="hljs-keyword">if</span> (isElement &amp;&amp; (p === <span class="hljs-string">"height"</span> || p === <span class="hljs-string">"width"</span>)) {
                    opt.overflow = [elem.style.overflow, elem.style.overflowX, elem.style.overflowY];
                    <span class="hljs-keyword">if</span> (elem.getStyle(<span class="hljs-string">"display"</span>) === <span class="hljs-string">"inline"</span> &amp;&amp; elem.getStyle(<span class="hljs-string">"float"</span>) === <span class="hljs-string">"none"</span>) {
                        <span class="hljs-keyword">if</span> (!inlineBlockNeedsLayout)
                            elem.style.display = <span class="hljs-string">"inline-block"</span>;
                        <span class="hljs-keyword">else</span> {
                            <span class="hljs-keyword">var</span> display = defaultDisplay(<span class="hljs-keyword">this</span>.nodeName);
                            <span class="hljs-keyword">if</span> (display === <span class="hljs-string">"inline"</span>)
                                elem.style.display = <span class="hljs-string">"inline-block"</span>;
                            <span class="hljs-keyword">else</span> {
                                elem.style.display = <span class="hljs-string">"inline"</span>;
                                elem.style.zoom = <span class="hljs-number">1</span>;
                            }
                        }
                    }
                }
                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.isArray(prop[p])) {
                    (opt.specialEasing = opt.specialEasing || {})[p] = prop[p][<span class="hljs-number">1</span>];
                    prop[p] = prop[p][<span class="hljs-number">0</span>];
                }
            }
            <span class="hljs-keyword">if</span> (opt.overflow != <span class="hljs-literal">null</span>)
                elem.style.overflow = <span class="hljs-string">"hidden"</span>;
            opt.curAnim = <span class="hljs-built_in">Object</span>.extend({}, prop);
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i <span class="hljs-keyword">in</span> prop) {
                <span class="hljs-keyword">var</span> name = i;
                <span class="hljs-keyword">var</span> val = prop[i];
                <span class="hljs-keyword">var</span> e = <span class="hljs-keyword">new</span> Prototype.effects.fx(elem, opt, name);
                <span class="hljs-keyword">if</span> (rfxtypes.test(val)) {
                    e[val === <span class="hljs-string">"toggle"</span> ? hidden ? <span class="hljs-string">"show"</span> : <span class="hljs-string">"hide"</span> : val](prop);
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-keyword">var</span> parts = rfxnum.exec(val);
                    <span class="hljs-keyword">var</span> start = e.cur() || <span class="hljs-number">0</span>;
                    <span class="hljs-keyword">if</span> (parts) {
                        <span class="hljs-keyword">var</span> end = <span class="hljs-built_in">parseFloat</span>(parts[<span class="hljs-number">2</span>]);
                        <span class="hljs-keyword">var</span> unit = parts[<span class="hljs-number">3</span>] || <span class="hljs-string">"px"</span>;
                        <span class="hljs-keyword">if</span> (unit !== <span class="hljs-string">"px"</span>) {
                            style(elem, name, (end || <span class="hljs-number">1</span>) + unit);
                            start = ((end || <span class="hljs-number">1</span>) / e.cur()) * start;
                            style(name, start + unit);
                        }
                        <span class="hljs-keyword">if</span> (parts[<span class="hljs-number">1</span>])
                            end = ((parts[<span class="hljs-number">1</span>] === <span class="hljs-string">"-="</span> ? <span class="hljs-number">-1</span> : <span class="hljs-number">1</span>) * end) + start;
                        e.custom(start, end, unit);
                    } <span class="hljs-keyword">else</span> {
                        e.custom(start, val, <span class="hljs-string">""</span>);
                    }
                }
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        });
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stop</span>(<span class="hljs-params">elem, clearQueue, gotoEnd</span>) </span>{
        <span class="hljs-keyword">var</span> timers = Prototype.effects.timers;
        <span class="hljs-keyword">if</span> (clearQueue)
            elem.queue([]);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = timers.length - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
            <span class="hljs-keyword">if</span> (timers[i].elem === elem) {
                <span class="hljs-keyword">if</span> (gotoEnd) {
                    timers[i](<span class="hljs-literal">true</span>);
                }
                timers.splice(i, <span class="hljs-number">1</span>);
            }
        }
        <span class="hljs-keyword">if</span> (!gotoEnd)
            elem.dequeue();
        <span class="hljs-keyword">return</span> elem;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">queue</span>(<span class="hljs-params">elem, type, data</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> type !== <span class="hljs-string">"string"</span>) {
            data = type;
            type = <span class="hljs-string">"fx"</span>;
        }
        <span class="hljs-keyword">if</span> (data === <span class="hljs-literal">undefined</span>)
            <span class="hljs-keyword">return</span> Prototype.queue(elem, type);
        <span class="hljs-keyword">var</span> queue = Prototype.queue(elem, type, data);
        <span class="hljs-keyword">if</span> (type === <span class="hljs-string">"fx"</span> &amp;&amp; queue[<span class="hljs-number">0</span>] !== <span class="hljs-string">"inprogress"</span>)
            Prototype.dequeue(elem, type);
        <span class="hljs-keyword">return</span> elem;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dequeue</span>(<span class="hljs-params">elem, type</span>) </span>{
        Prototype.dequeue(elem, type);
        <span class="hljs-keyword">return</span> elem;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">delay</span>(<span class="hljs-params">elem, time, type</span>) </span>{
        time = Prototype.effects.fx ? Prototype.effects.fx.speeds[time] || time : time;
        type = type || <span class="hljs-string">"fx"</span>;
        <span class="hljs-keyword">return</span> elem.queue(type, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                Prototype.dequeue(elem, type);
            }, time);
        });
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearQueue</span>(<span class="hljs-params">elem, type</span>) </span>{
        <span class="hljs-keyword">return</span> elem.queue(type || <span class="hljs-string">"fx"</span>, []);
    }
    <span class="hljs-keyword">return</span> Element.addMethods({
        <span class="hljs-attr">show</span>: show,
        <span class="hljs-attr">hide</span>: hide,
        <span class="hljs-attr">toggle</span>: toggle,
        <span class="hljs-attr">fadeTo</span>: fadeTo,
        <span class="hljs-attr">animate</span>: animate,
        <span class="hljs-attr">slideDown</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem, speed, easing, callback</span>) </span>{
            <span class="hljs-keyword">return</span> animate(elem, genFx(<span class="hljs-string">'show'</span>, <span class="hljs-number">1</span>), speed, easing, callback);
        },
        <span class="hljs-attr">slideUp</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem, speed, easing, callback</span>) </span>{
            <span class="hljs-keyword">return</span> animate(elem, genFx(<span class="hljs-string">'hide'</span>, <span class="hljs-number">1</span>), speed, easing, callback);
        },
        <span class="hljs-attr">slideToggle</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem, speed, easing, callback</span>) </span>{
            <span class="hljs-keyword">return</span> animate(elem, genFx(<span class="hljs-string">'toggle'</span>, <span class="hljs-number">1</span>), speed, easing, callback);
        },
        <span class="hljs-attr">fadeIn</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem, speed, easing, callback</span>) </span>{
            <span class="hljs-keyword">return</span> animate(elem, {
                <span class="hljs-attr">opacity</span>: <span class="hljs-string">'show'</span>
            }, speed, easing, callback);
        },
        <span class="hljs-attr">fadeOut</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem, speed, easing, callback</span>) </span>{
            <span class="hljs-keyword">return</span> animate(elem, {
                <span class="hljs-attr">opacity</span>: <span class="hljs-string">'hide'</span>
            }, speed, easing, callback);
        },
        <span class="hljs-attr">fadeToggle</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem, speed, easing, callback</span>) </span>{
            <span class="hljs-keyword">return</span> animate(elem, {
                <span class="hljs-attr">opacity</span>: <span class="hljs-string">'toggle'</span>
            }, speed, easing, callback);
        },
        <span class="hljs-attr">stop</span>: stop,
        <span class="hljs-attr">queue</span>: queue,
        <span class="hljs-attr">dequeue</span>: dequeue,
        <span class="hljs-attr">delay</span>: delay,
        <span class="hljs-attr">clearQueue</span>: clearQueue,
        <span class="hljs-attr">_execute</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem, f</span>) </span>{
            f();
            <span class="hljs-keyword">return</span> elem;
        }
    });
}());;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/doctype/GlideModal.js */</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">global, $</span>) </span>{
<span class="hljs-meta">    "use strict"</span>;
    <span class="hljs-keyword">var</span> GlideModal = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        GlideModal.prototype.initialize.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    };
    GlideModal.prototype = {
        <span class="hljs-attr">initialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id, readOnly, width, height</span>) </span>{
            <span class="hljs-keyword">this</span>.preferences = {};
            <span class="hljs-keyword">this</span>.id = id;
            <span class="hljs-keyword">this</span>.readOnly = readOnly;
            <span class="hljs-keyword">this</span>.backdropStatic = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">this</span>.nologValue = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">this</span>.setDialog(id);
            <span class="hljs-keyword">this</span>.setSize(width, height);
            <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'renderer'</span>, <span class="hljs-string">'RenderForm'</span>);
            <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'type'</span>, <span class="hljs-string">'direct'</span>);
        },
        <span class="hljs-attr">setDialog</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">dialogName</span>) </span>{
            <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'table'</span>, dialogName);
        },
        <span class="hljs-attr">setPreference</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, value</span>) </span>{
            <span class="hljs-keyword">this</span>.preferences[name] = value;
        },
        <span class="hljs-attr">getPreference</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.preferences[name];
        },
        <span class="hljs-attr">setAutoFullHeight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">isAutoFullHeight</span>) </span>{
            <span class="hljs-keyword">this</span>.isAutoFullHeight = isAutoFullHeight;
        },
        <span class="hljs-attr">setSize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">width</span>) </span>{
            <span class="hljs-keyword">this</span>.size = <span class="hljs-string">'modal-md'</span>;
            <span class="hljs-keyword">if</span> (!width)
                <span class="hljs-keyword">this</span>.size = <span class="hljs-string">'modal-md'</span>;
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> width == <span class="hljs-string">'string'</span> &amp;&amp; width.indexOf(<span class="hljs-string">'modal-'</span>) == <span class="hljs-number">0</span>)
                <span class="hljs-keyword">this</span>.size = width;
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (width &lt; <span class="hljs-number">350</span>)
                <span class="hljs-keyword">this</span>.size = <span class="hljs-string">'modal-alert'</span>;
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (width &lt; <span class="hljs-number">450</span>)
                <span class="hljs-keyword">this</span>.size = <span class="hljs-string">'modal-sm'</span>;
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (width &lt; <span class="hljs-number">650</span>)
                <span class="hljs-keyword">this</span>.size = <span class="hljs-string">'modal-md'</span>;
            <span class="hljs-keyword">else</span>
                <span class="hljs-keyword">this</span>.size = <span class="hljs-string">'modal-lg'</span>;
        },
        <span class="hljs-attr">setWidth</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">width</span>) </span>{
            <span class="hljs-keyword">this</span>.setSize(width);
        },
        <span class="hljs-attr">setTitle</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">title</span>) </span>{
            <span class="hljs-keyword">this</span>.title = title;
        },
        <span class="hljs-attr">setBackdropStatic</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">makeStatic</span>) </span>{
            <span class="hljs-keyword">this</span>.backdropStatic = makeStatic;
        },
        <span class="hljs-attr">setNologValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">nolog</span>) </span>{
            <span class="hljs-keyword">this</span>.nologValue = !!nolog;
        },
        <span class="hljs-attr">updateTitle</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            $(<span class="hljs-string">'.modal-title'</span>, <span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span>).html(<span class="hljs-keyword">this</span>.title);
        },
        <span class="hljs-attr">updateSize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            $(<span class="hljs-string">'.modal-dialog'</span>, <span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span>).attr(<span class="hljs-string">'class'</span>, <span class="hljs-string">'modal-dialog'</span>).addClass(<span class="hljs-keyword">this</span>.size);
        },
        <span class="hljs-attr">setFocus</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">el</span>) </span>{},
        <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> description = <span class="hljs-keyword">this</span>.getDescribingText();
            <span class="hljs-keyword">var</span> ajax = <span class="hljs-keyword">new</span> GlideAjax(<span class="hljs-string">"RenderInfo"</span>);
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.nologValue)
                ajax.addParam(<span class="hljs-string">"ni.nolog.sysparm_value"</span>, <span class="hljs-literal">true</span>);
            ajax.addParam(<span class="hljs-string">"sysparm_value"</span>, description);
            ajax.addParam(<span class="hljs-string">"sysparm_name"</span>, <span class="hljs-keyword">this</span>.id);
            ajax.getXML(<span class="hljs-keyword">this</span>._renderFromAjax.bind(<span class="hljs-keyword">this</span>));
        },
        <span class="hljs-attr">switchView</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">newView</span>) </span>{
            <span class="hljs-keyword">this</span>.setPreferenceAndReload({
                <span class="hljs-string">'sysparm_view'</span>: newView
            });
        },
        <span class="hljs-attr">setPreferenceAndReload</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">params</span>) </span>{
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> params)
                <span class="hljs-keyword">this</span>.preferences[key] = params[key];
            <span class="hljs-keyword">this</span>.render();
        },
        <span class="hljs-attr">_renderFromAjax</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) </span>{
            <span class="hljs-keyword">var</span> xml = response.responseXML;
            <span class="hljs-keyword">var</span> newBody = xml.getElementsByTagName(<span class="hljs-string">"html"</span>)[<span class="hljs-number">0</span>];
            xml = newBody.xml ? newBody.xml :
                <span class="hljs-keyword">new</span> XMLSerializer().serializeToString(newBody);
            <span class="hljs-keyword">if</span> (!xml)
                <span class="hljs-keyword">return</span>;
            <span class="hljs-keyword">this</span>.setPreferencesFromBody(response.responseXML);
            <span class="hljs-keyword">this</span>.setEscapedBody(xml);
            <span class="hljs-keyword">this</span>._evalScripts(xml);
        },
        <span class="hljs-attr">maximizeHeight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">callback</span>) </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.resizeTimeout)
                clearTimeout(<span class="hljs-keyword">this</span>.resizeTimeout);
            <span class="hljs-keyword">var</span> context = <span class="hljs-keyword">this</span>;
            <span class="hljs-keyword">this</span>.resizeTimeout = setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">var</span> padding = <span class="hljs-number">100</span>;
                <span class="hljs-keyword">var</span> $modalBody = context.$modalContent.find(<span class="hljs-string">'.modal-body'</span>);
                <span class="hljs-keyword">var</span> modalHeight = context.$modalContent.height();
                <span class="hljs-keyword">var</span> modalToolsHeight = modalHeight - $modalBody.height();
                <span class="hljs-keyword">var</span> newHeight = $(<span class="hljs-built_in">window</span>).height() - padding - modalToolsHeight;
                $modalBody.height(newHeight);
                <span class="hljs-keyword">if</span> (callback)
                    callback.apply(context);
            }, <span class="hljs-number">150</span>);
        },
        <span class="hljs-attr">renderWithContent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">content</span>) </span>{
            <span class="hljs-keyword">this</span>._createModal();
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> content == <span class="hljs-string">'string'</span>)
                $(<span class="hljs-string">'.modal-body'</span>, <span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span>)[<span class="hljs-number">0</span>].innerHTML = content;
            <span class="hljs-keyword">else</span>
                $(<span class="hljs-string">'.modal-body'</span>, <span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span>).html(content);
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
            <span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span>.on(<span class="hljs-string">'show.bs.modal'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                self.isOpen = <span class="hljs-literal">true</span>;
                self.$modalContent = self.$<span class="hljs-built_in">window</span>.find(<span class="hljs-string">'.modal-content'</span>);
                <span class="hljs-keyword">if</span> (self.isAutoFullHeight)
                    self.maximizeHeight();
            }).on(<span class="hljs-string">'hidden.bs.modal'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                self.isOpen = <span class="hljs-literal">false</span>;
            });
            <span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span>.modal({
                <span class="hljs-attr">backdrop</span>: <span class="hljs-keyword">this</span>.readOnly || <span class="hljs-keyword">this</span>.backdropStatic ? <span class="hljs-string">'static'</span> : <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">keyboard</span>: !<span class="hljs-keyword">this</span>.readOnly
            });
            <span class="hljs-keyword">this</span>.fireEvent(<span class="hljs-string">"bodyrendered"</span>, <span class="hljs-keyword">this</span>);
            _frameChanged();
        },
        <span class="hljs-attr">renderIframe</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">url, onloadCallback</span>) </span>{
            <span class="hljs-keyword">var</span> loadingMessage = <span class="hljs-string">'Loading...'</span>;
            <span class="hljs-keyword">var</span> div = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'div'</span>);
            div.setAttribute(<span class="hljs-string">'style'</span>, <span class="hljs-string">'position: absolute; top: 2px; right: 2px; bottom: 2px; left: 2px;'</span>);
            <span class="hljs-keyword">var</span> loading = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'div'</span>);
            loading.setAttribute(<span class="hljs-string">'style'</span>, <span class="hljs-string">'position: absolute; top: 10px; left: 10px;'</span>);
            loading.setAttribute(<span class="hljs-string">'class'</span>, <span class="hljs-string">'loading'</span>);
            <span class="hljs-keyword">if</span> (loading.textContent)
                loading.textContent = loadingMessage;
            <span class="hljs-keyword">else</span>
                loading.innerText = loadingMessage;
            <span class="hljs-keyword">var</span> iframe = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'iframe'</span>);
            iframe.setAttribute(<span class="hljs-string">'style'</span>, <span class="hljs-string">'width: 100%; height: 100%; border: 0; background-color: white; visibility: hidden;'</span>);
            iframe.src = url;
            div.appendChild(loading);
            div.appendChild(iframe);
            <span class="hljs-keyword">var</span> context = <span class="hljs-keyword">this</span>;
            <span class="hljs-keyword">this</span>.on(<span class="hljs-string">'bodyrendered'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                context.$modalContent.find(<span class="hljs-string">'iframe'</span>).load(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
                    context.$modalContent.find(<span class="hljs-string">'.loading'</span>).hide();
                    iframe.setAttribute(<span class="hljs-string">'style'</span>, <span class="hljs-string">'width: 100%; height: 100%; border: 0; background-color: white;'</span>);
                    <span class="hljs-keyword">if</span> (onloadCallback &amp;&amp; evt.target &amp;&amp; evt.target.contentWindow)
                        onloadCallback.apply(evt.target.contentWindow);
                });
            });
            <span class="hljs-keyword">this</span>.renderWithContent(div);
        },
        <span class="hljs-attr">_createModal</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> template;
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span>) {
                <span class="hljs-keyword">this</span>.updateTitle();
                <span class="hljs-keyword">this</span>.updateSize();
                <span class="hljs-keyword">return</span>;
            }
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.template) {
                template = <span class="hljs-keyword">this</span>.template
            } <span class="hljs-keyword">else</span> {
                template = getTemplate();
            }
            <span class="hljs-keyword">this</span>._closeIdenticalModals();
            <span class="hljs-keyword">var</span> html = <span class="hljs-keyword">new</span> Template(template).evaluate({
                <span class="hljs-attr">title</span>: <span class="hljs-keyword">this</span>.title,
                <span class="hljs-attr">id</span>: <span class="hljs-keyword">this</span>.id,
                <span class="hljs-attr">size</span>: <span class="hljs-keyword">this</span>.size,
                <span class="hljs-attr">readOnly</span>: <span class="hljs-keyword">this</span>.readOnly ? <span class="hljs-string">'true'</span> : <span class="hljs-string">'false'</span>,
                <span class="hljs-attr">showHelp</span>: <span class="hljs-keyword">this</span>.showHelp ? <span class="hljs-string">'true'</span> : <span class="hljs-string">'false'</span>
            });
            <span class="hljs-keyword">var</span> $modal = $(html);
            $modal.data(<span class="hljs-string">'gWindow'</span>, <span class="hljs-keyword">this</span>);
            <span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span> = $modal;
            $(<span class="hljs-built_in">document</span>.body).append(<span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span>);
            <span class="hljs-keyword">this</span>._watchForClose();
            <span class="hljs-keyword">this</span>._watchHelp();
        },
        <span class="hljs-attr">_onWindowResize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">context</span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">if</span> (context.isOpen &amp;&amp; context.isAutoFullHeight) {
                    context.maximizeHeight();
                }
            }
        },
        <span class="hljs-attr">setEscapedBody</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">body</span>) </span>{
            <span class="hljs-keyword">if</span> (!body)
                <span class="hljs-keyword">return</span>;
            body = body.replace(<span class="hljs-regexp">/\t/g</span>, <span class="hljs-string">""</span>);
            body = body.replace(<span class="hljs-regexp">/\r/g</span>, <span class="hljs-string">""</span>);
            body = body.replace(<span class="hljs-regexp">/\n+/g</span>, <span class="hljs-string">"\n"</span>);
            body = body.replace(<span class="hljs-regexp">/%27/g</span>, <span class="hljs-string">"'"</span>);
            body = body.replace(<span class="hljs-regexp">/%3c/g</span>, <span class="hljs-string">"&lt;"</span>);
            body = body.replace(<span class="hljs-regexp">/%3e/g</span>, <span class="hljs-string">"&gt;"</span>);
            body = body.replace(<span class="hljs-regexp">/&amp;amp;/g</span>, <span class="hljs-string">"&amp;"</span>);
            <span class="hljs-keyword">this</span>.setBody(body, <span class="hljs-literal">true</span>);
        },
        <span class="hljs-attr">setBody</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">html, noEvaluate</span>) </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> html == <span class="hljs-string">'string'</span>) {
                html = <span class="hljs-keyword">this</span>._substituteGet(html);
                html = <span class="hljs-keyword">this</span>._fixBrowserTags(html);
                <span class="hljs-keyword">this</span>.renderWithContent(html);
                <span class="hljs-keyword">if</span> (!noEvaluate)
                    <span class="hljs-keyword">this</span>._evalScripts(html);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">this</span>.renderWithContent(html);
            }
        },
        <span class="hljs-attr">setPreferencesFromBody</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">xml</span>) </span>{
            <span class="hljs-keyword">var</span> prefs = xml.getElementsByTagName(<span class="hljs-string">"renderpreference"</span>);
            <span class="hljs-keyword">if</span> (prefs.length &gt; <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; prefs.length; i++) {
                    <span class="hljs-keyword">var</span> pref = prefs[i];
                    <span class="hljs-keyword">var</span> name = pref.getAttribute(<span class="hljs-string">"name"</span>);
                    <span class="hljs-keyword">var</span> valu = pref.getAttribute(<span class="hljs-string">"value"</span>);
                    <span class="hljs-keyword">this</span>.setPreference(name, valu);
                    <span class="hljs-keyword">if</span> (name == <span class="hljs-string">"title"</span>)
                        <span class="hljs-keyword">this</span>.setTitle(valu);
                    <span class="hljs-keyword">if</span> (name == <span class="hljs-string">"render_title"</span> &amp;&amp; valu == <span class="hljs-string">"false"</span>)
                        <span class="hljs-keyword">this</span>.setTitle(<span class="hljs-string">""</span>);
                }
            }
        },
        <span class="hljs-attr">_substituteGet</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">html</span>) </span>{
            <span class="hljs-keyword">if</span> (!html)
                <span class="hljs-keyword">return</span> html;
            <span class="hljs-keyword">var</span> substitutions = [<span class="hljs-keyword">this</span>.type(), <span class="hljs-string">'GlideDialogWindow'</span>, <span class="hljs-string">'GlideDialogForm'</span>];
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; substitutions.length; i++) {
                <span class="hljs-keyword">var</span> reg = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(substitutions[i] + <span class="hljs-string">".get\\("</span>, <span class="hljs-string">"g"</span>);
                html = html.replace(reg, <span class="hljs-keyword">this</span>.type() + <span class="hljs-string">".prototype.get('"</span> + <span class="hljs-keyword">this</span>.getID() + <span class="hljs-string">"'"</span>);
            }
            <span class="hljs-keyword">return</span> html;
        },
        <span class="hljs-attr">_fixBrowserTags</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">html</span>) </span>{
            <span class="hljs-keyword">if</span> (!html)
                <span class="hljs-keyword">return</span> html;
            <span class="hljs-keyword">var</span> tags = [<span class="hljs-string">"script"</span>, <span class="hljs-string">"a "</span>, <span class="hljs-string">"div"</span>, <span class="hljs-string">"span"</span>, <span class="hljs-string">"select"</span>];
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; tags.length; i++) {
                <span class="hljs-keyword">var</span> tag = tags[i];
                html = html.replace(<span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">'&lt;'</span> + tag + <span class="hljs-string">'([^&gt;]*?)/&gt;'</span>, <span class="hljs-string">'img'</span>), <span class="hljs-string">'&lt;'</span> + tag + <span class="hljs-string">'$1&gt;&lt;/'</span> + tag + <span class="hljs-string">'&gt;'</span>);
            }
            <span class="hljs-keyword">return</span> html;
        },
        <span class="hljs-attr">_evalScripts</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">html</span>) </span>{
            html = <span class="hljs-keyword">this</span>._substituteGet(html, <span class="hljs-keyword">this</span>.type());
            <span class="hljs-keyword">var</span> x = loadXML(<span class="hljs-string">"&lt;xml&gt;"</span> + html + <span class="hljs-string">"&lt;/xml&gt;"</span>);
            <span class="hljs-keyword">if</span> (x) {
                <span class="hljs-keyword">var</span> scripts = x.getElementsByTagName(<span class="hljs-string">"script"</span>);
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; scripts.length; i++) {
                    <span class="hljs-keyword">var</span> script = scripts[i];
                    <span class="hljs-keyword">var</span> s = <span class="hljs-string">""</span>;
                    <span class="hljs-keyword">if</span> (script.getAttribute(<span class="hljs-string">"type"</span>) == <span class="hljs-string">"application/xml"</span>)
                        <span class="hljs-keyword">continue</span>;
                    <span class="hljs-keyword">if</span> (script.getAttribute(<span class="hljs-string">"src"</span>)) {
                        <span class="hljs-keyword">var</span> url = script.getAttribute(<span class="hljs-string">"src"</span>);
                        <span class="hljs-keyword">var</span> req = serverRequestWait(url);
                        s = req.responseText;
                    } <span class="hljs-keyword">else</span> {
                        s = getTextValue(script);
                        <span class="hljs-keyword">if</span> (!s)
                            s = script.innerHTML;
                    }
                    <span class="hljs-keyword">if</span> (s)
                        evalScript(s, <span class="hljs-literal">true</span>);
                }
            }
            <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">window</span>.G_vmlCanvasManager)
                <span class="hljs-keyword">return</span>;
            <span class="hljs-built_in">window</span>.G_vmlCanvasManager.init_(<span class="hljs-built_in">document</span>)
        },
        <span class="hljs-attr">getID</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.id;
        },
        <span class="hljs-attr">getPreferences</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.preferences;
        },
        <span class="hljs-attr">getDescribingXML</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> section = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"section"</span>);
            section.setAttribute(<span class="hljs-string">"name"</span>, <span class="hljs-keyword">this</span>.getID());
            <span class="hljs-keyword">var</span> preferences = <span class="hljs-keyword">this</span>.getPreferences();
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> name <span class="hljs-keyword">in</span> preferences) {
                <span class="hljs-keyword">if</span> (!preferences.hasOwnProperty(name))
                    <span class="hljs-keyword">continue</span>;
                <span class="hljs-keyword">var</span> p = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"preference"</span>);
                <span class="hljs-keyword">var</span> v = preferences[name];
                p.setAttribute(<span class="hljs-string">"name"</span>, name);
                <span class="hljs-keyword">if</span> (v !== <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-keyword">typeof</span> v == <span class="hljs-string">'object'</span>) {
                    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> v.join == <span class="hljs-string">"function"</span>) {
                        v = v.join(<span class="hljs-string">","</span>);
                    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> v.toString == <span class="hljs-string">"function"</span>) {
                        v = v.toString();
                    }
                }
                <span class="hljs-keyword">if</span> (v &amp;&amp; <span class="hljs-keyword">typeof</span> v.escapeHTML === <span class="hljs-string">"function"</span>)
                    v = v.escapeHTML();
                <span class="hljs-keyword">if</span> (v)
                    p.setAttribute(<span class="hljs-string">"value"</span>, v);
                section.appendChild(p);
            }
            <span class="hljs-keyword">return</span> section;
        },
        <span class="hljs-attr">getDescribingText</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> gxml = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"gxml"</span>);
            <span class="hljs-keyword">var</span> x = <span class="hljs-keyword">this</span>.getDescribingXML();
            gxml.appendChild(x);
            <span class="hljs-keyword">return</span> gxml.innerHTML;
        },
        <span class="hljs-attr">destroy</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.fireEvent(<span class="hljs-string">'closeconfirm'</span>, <span class="hljs-keyword">this</span>))
                <span class="hljs-keyword">return</span>;
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span>)
                <span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span>.modal(<span class="hljs-string">'hide'</span>);
        },
        <span class="hljs-attr">_removeWindow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">this</span>.fireEvent(<span class="hljs-string">'beforeclose'</span>, <span class="hljs-keyword">this</span>);
            <span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span>.remove();
        },
        <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
            <span class="hljs-keyword">if</span> (!id)
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
            <span class="hljs-keyword">var</span> win = <span class="hljs-built_in">document</span>.getElementById(id);
            <span class="hljs-keyword">if</span> (!win)
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
            <span class="hljs-keyword">return</span> $(win).data(<span class="hljs-string">'gWindow'</span>);
        },
        <span class="hljs-attr">_watchForClose</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span>.on(<span class="hljs-string">'click'</span>, <span class="hljs-string">'[data-dismiss=GlideModal]'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">this</span>.destroy();
            }.bind(<span class="hljs-keyword">this</span>));
            <span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span>.on(<span class="hljs-string">'hidden.bs.modal'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">this</span>._removeWindow(<span class="hljs-literal">true</span>);
            }.bind(<span class="hljs-keyword">this</span>));
        },
        <span class="hljs-attr">_watchHelp</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span>.on(<span class="hljs-string">'click'</span>, <span class="hljs-string">'.help'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._helpCallback)
                    <span class="hljs-keyword">this</span>._helpCallback.call();
            }.bind(<span class="hljs-keyword">this</span>));
        },
        <span class="hljs-attr">on</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evtName, callbackFn</span>) </span>{
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._events)
                <span class="hljs-keyword">this</span>._events = {};
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._events[evtName])
                <span class="hljs-keyword">this</span>._events[evtName] = [];
            <span class="hljs-keyword">this</span>._events[evtName].push(callbackFn);
        },
        <span class="hljs-attr">fireEvent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">0</span>);
            <span class="hljs-keyword">var</span> evtName = args.shift();
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._events || !<span class="hljs-keyword">this</span>._events[evtName])
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>._events[evtName].length; i++) {
                <span class="hljs-keyword">var</span> ev = <span class="hljs-keyword">this</span>._events[evtName][i];
                <span class="hljs-keyword">if</span> (!ev)
                    <span class="hljs-keyword">continue</span>;
                <span class="hljs-keyword">if</span> (ev.apply(<span class="hljs-keyword">this</span>, args) === <span class="hljs-literal">false</span>)
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        },
        <span class="hljs-attr">_closeIdenticalModals</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> $existingModal = $(<span class="hljs-string">'#'</span> + <span class="hljs-keyword">this</span>.id).data(<span class="hljs-string">'gWindow'</span>);
            <span class="hljs-keyword">if</span> (!$existingModal)
                <span class="hljs-keyword">return</span>;
            $existingModal.destroy();
        },
        <span class="hljs-attr">addDecoration</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">decorationElement, leftSide</span>) </span>{},
        <span class="hljs-attr">addFunctionDecoration</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">imgSrc, imgAlt, func, side</span>) </span>{
            <span class="hljs-keyword">if</span> (imgSrc == <span class="hljs-string">'images/help.gif'</span>)
                <span class="hljs-keyword">this</span>.addHelpDecoration(func);
        },
        <span class="hljs-attr">addHelpDecoration</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">func</span>) </span>{
            <span class="hljs-keyword">this</span>.showHelp = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">this</span>._helpCallback = func;
        },
        <span class="hljs-attr">type</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-string">"GlideModal"</span>;
        }
    };

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTemplate</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;div id="#{HTML:id}" tabindex="-1" '</span> +
            <span class="hljs-string">'aria-hidden="true" class="modal" role="dialog" '</span> +
            <span class="hljs-string">'aria-labelledby="#{HTML:id}_title" data-readonly="#{HTML:readOnly}" data-has-help="#{HTML:showHelp}"&gt;'</span> +
            <span class="hljs-string">'	&lt;div class="modal-dialog #{size}"&gt;'</span> +
            <span class="hljs-string">'		&lt;div class="modal-content"&gt;'</span> +
            <span class="hljs-string">'			&lt;header class="modal-header"&gt;'</span> +
            <span class="hljs-string">'				&lt;button data-dismiss="GlideModal" class="btn btn-icon close icon-cross"&gt;'</span> +
            <span class="hljs-string">'					&lt;span class="sr-only"&gt;Close&lt;/span&gt;'</span> +
            <span class="hljs-string">'				&lt;/button&gt;'</span> +
            <span class="hljs-string">'			&lt;h4 id="#{HTML:id}_title" class="modal-title"&gt;'</span> +
            <span class="hljs-string">'				#{HTML:title}'</span> +
            <span class="hljs-string">'			&lt;button class="btn btn-icon icon-help help"&gt;'</span> +
            <span class="hljs-string">'				&lt;span class="sr-only"&gt;Help&lt;/span&gt;'</span> +
            <span class="hljs-string">'			&lt;/button&gt;'</span> +
            <span class="hljs-string">'			&lt;/h4&gt;'</span> +
            <span class="hljs-string">'			&lt;/header&gt;'</span> +
            <span class="hljs-string">'			&lt;div class="modal-body container-fluid"&gt;&lt;/div&gt;'</span> +
            <span class="hljs-string">'		&lt;/div&gt;'</span> +
            <span class="hljs-string">'	&lt;/div&gt;'</span> +
            <span class="hljs-string">'&lt;/div&gt;'</span>;
    }
    global.GlideModal = GlideModal;
})(<span class="hljs-built_in">window</span>, jQuery);;
<span class="hljs-comment">/*! RESOURCE: /scripts/classes/doctype/GlideModalForm.js */</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">global, $</span>) </span>{
<span class="hljs-meta">    "use strict"</span>;
    <span class="hljs-keyword">var</span> GlideModalForm = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        GlideModalForm.prototype.init.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    };
    GlideModalForm.prototype = $.extend({}, GlideModal.prototype, {
        <span class="hljs-attr">IGNORED_PREFERENCES</span>: {
            <span class="hljs-string">'renderer'</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-string">'type'</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-string">'table'</span>: <span class="hljs-literal">true</span>
        },
        <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">title, tableName, onCompletionCallback, readOnly</span>) </span>{
            <span class="hljs-keyword">this</span>.initialize.call(<span class="hljs-keyword">this</span>, tableName, readOnly, <span class="hljs-number">800</span>);
            <span class="hljs-keyword">this</span>.tableName = tableName;
            <span class="hljs-keyword">if</span> (title) {
                <span class="hljs-keyword">this</span>.setTitle(title);
            }
            <span class="hljs-keyword">if</span> (onCompletionCallback) {
                <span class="hljs-keyword">this</span>.setCompletionCallback(onCompletionCallback);
            }
        },
        <span class="hljs-attr">setSize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">width</span>) </span>{
            <span class="hljs-keyword">this</span>.size = <span class="hljs-string">'modal-95'</span>;
        },
        <span class="hljs-attr">setFooter</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bool</span>) </span>{
            <span class="hljs-keyword">this</span>.hasFooter = !!bool;
        },
        <span class="hljs-attr">setSysID</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
            <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'sys_id'</span>, id);
        },
        <span class="hljs-attr">setType</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">type</span>) </span>{
            <span class="hljs-keyword">this</span>.setPreference(<span class="hljs-string">'type'</span>, type);
        },
        <span class="hljs-attr">setTemplate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">template</span>) </span>{
            <span class="hljs-keyword">this</span>.template = template;
        },
        <span class="hljs-attr">setCompletionCallback</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">func</span>) </span>{
            <span class="hljs-keyword">this</span>.onCompletionFunc = func;
        },
        <span class="hljs-attr">setOnloadCallback</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">func</span>) </span>{
            <span class="hljs-keyword">this</span>.onFormLoad = func;
        },
        <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">this</span>._createModal();
            <span class="hljs-keyword">var</span> body = $(<span class="hljs-string">'.modal-body'</span>, <span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span>)[<span class="hljs-number">0</span>];
            body.innerHTML = getFormTemplate();
            <span class="hljs-keyword">var</span> frame = $(<span class="hljs-string">'.modal-frame'</span>, <span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span>);
            frame.on(<span class="hljs-string">'load'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">this</span>._formLoaded();
            }.bind(<span class="hljs-keyword">this</span>));
            <span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span>.modal({
                <span class="hljs-attr">backdrop</span>: <span class="hljs-string">'static'</span>
            });
            <span class="hljs-keyword">this</span>._bodyHeight = $(<span class="hljs-string">'#'</span> + <span class="hljs-keyword">this</span>.id)[<span class="hljs-number">0</span>].getHeight();
            <span class="hljs-keyword">var</span> margin = $(<span class="hljs-string">'.modal-dialog'</span>, <span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span>)[<span class="hljs-number">0</span>].offsetTop * <span class="hljs-number">2</span>;
            margin += frame.offset().top;
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._bodyHeight &gt; margin)
                <span class="hljs-keyword">this</span>._bodyHeight -= margin;
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.hasFooter) {
                <span class="hljs-keyword">this</span>._bodyHeight = <span class="hljs-keyword">this</span>._bodyHeight - <span class="hljs-number">40</span>;
            }
            frame.css(<span class="hljs-string">'height'</span>, <span class="hljs-keyword">this</span>._bodyHeight);
            <span class="hljs-keyword">var</span> $doc = frame[<span class="hljs-number">0</span>].contentWindow ? frame[<span class="hljs-number">0</span>].contentWindow.document : frame[<span class="hljs-number">0</span>].contentDocument;
            <span class="hljs-keyword">var</span> $body = $($doc.body);
            $body.html(<span class="hljs-string">''</span>);
            $body.append($(<span class="hljs-string">'link'</span>).clone());
            $body.append(<span class="hljs-string">'&lt;center&gt;'</span> + getMessage(<span class="hljs-string">'Loading'</span>) + <span class="hljs-string">'... &lt;br/&gt;&lt;img src="images/ajax-loader.gifx"/&gt;&lt;/center&gt;&lt;/span&gt;'</span>);
            <span class="hljs-keyword">var</span> f = $(<span class="hljs-string">'.modal_dialog_form_poster'</span>, <span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span>)[<span class="hljs-number">0</span>];
            f.action = <span class="hljs-keyword">this</span>.getPreference(<span class="hljs-string">'table'</span>) + <span class="hljs-string">'.do'</span>;
            addHidden(f, <span class="hljs-string">'sysparm_clear_stack'</span>, <span class="hljs-string">'true'</span>);
            addHidden(f, <span class="hljs-string">'sysparm_nameofstack'</span>, <span class="hljs-string">'formDialog'</span>);
            addHidden(f, <span class="hljs-string">'sysparm_titleless'</span>, <span class="hljs-string">'true'</span>);
            addHidden(f, <span class="hljs-string">'sysparm_is_dialog_form'</span>, <span class="hljs-string">'true'</span>);
            <span class="hljs-keyword">var</span> sysId = <span class="hljs-keyword">this</span>.getPreference(<span class="hljs-string">'sys_id'</span>);
            <span class="hljs-keyword">if</span> (!sysId)
                sysId = <span class="hljs-string">''</span>;
            addHidden(f, <span class="hljs-string">'sys_id'</span>, sysId);
            <span class="hljs-keyword">var</span> targetField = <span class="hljs-string">''</span>;
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.fieldIDSet)
                targetField = <span class="hljs-keyword">this</span>.getPreference(<span class="hljs-string">'sysparm_target_field'</span>);
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> id <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>.preferences) {
                <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.IGNORED_PREFERENCES[id])
                    addHidden(f, id, <span class="hljs-keyword">this</span>.preferences[id]);
            }
            <span class="hljs-keyword">var</span> parms = [];
            parms.push(<span class="hljs-string">'sysparm_skipmsgs=true'</span>);
            parms.push(<span class="hljs-string">'sysparm_nostack=true'</span>);
            parms.push(<span class="hljs-string">'sysparm_target_field='</span> + targetField);
            parms.push(<span class="hljs-string">'sysparm_returned_action=$action'</span>);
            parms.push(<span class="hljs-string">'sysparm_returned_sysid=$sys_id'</span>);
            parms.push(<span class="hljs-string">'sysparm_returned_value=$display_value'</span>);
            addHidden(f, <span class="hljs-string">'sysparm_goto_url'</span>, <span class="hljs-string">'modal_dialog_form_response.do?'</span> + parms.join(<span class="hljs-string">'&amp;'</span>));
            f.submit();
        },
        <span class="hljs-attr">switchView</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">newView</span>) </span>{
            <span class="hljs-keyword">this</span>.setPreferenceAndReload({
                <span class="hljs-string">'sysparm_view'</span>: newView
            });
        },
        <span class="hljs-attr">setPreferenceAndReload</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">params</span>) </span>{
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> params)
                <span class="hljs-keyword">this</span>.preferences[key] = params[key];
            <span class="hljs-keyword">this</span>.render();
        },
        <span class="hljs-attr">_formLoaded</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> frame = $(<span class="hljs-string">'.modal-frame'</span>, <span class="hljs-keyword">this</span>.$<span class="hljs-built_in">window</span>);
            <span class="hljs-keyword">if</span> (frame.contents().get(<span class="hljs-number">0</span>).location.href.indexOf(<span class="hljs-string">'modal_dialog_form_response'</span>) != <span class="hljs-number">-1</span>) {
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.onCompletionFunc) {
                    <span class="hljs-keyword">var</span> f = $(<span class="hljs-string">'.modal_dialog_form_response form'</span>, frame.contents())[<span class="hljs-number">0</span>];
                    <span class="hljs-keyword">this</span>.onCompletionFunc(f.action.value, f.sysid.value, <span class="hljs-keyword">this</span>.tableName, f.value.value);
                }
                <span class="hljs-keyword">this</span>.destroy();
                <span class="hljs-keyword">return</span>;
            }
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.onFormLoad)
                <span class="hljs-keyword">this</span>.onFormLoad(<span class="hljs-keyword">this</span>);
        },
        <span class="hljs-attr">addParm</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">k, v</span>) </span>{
            <span class="hljs-keyword">this</span>.setPreference(k, v);
        }
    });

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFormTemplate</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;form class="modal_dialog_form_poster" target="dialog_frame" method="POST" style="display: inline;"/&gt;'</span> +
            <span class="hljs-string">'&lt;iframe id="dialog_frame" name="dialog_frame" class="modal-frame" style="width:100%;height:100%;" frameborder="no" /&gt;'</span>;
    }
    global.GlideModalForm = GlideModalForm;
})(<span class="hljs-built_in">window</span>, jQuery);;;</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
